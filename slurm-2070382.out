amp-8.las.iastate.edu
Sun Nov 17 23:30:20 2024       
+-----------------------------------------------------------------------------------------+
| NVIDIA-SMI 550.90.07              Driver Version: 550.90.07      CUDA Version: 12.4     |
|-----------------------------------------+------------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id          Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |           Memory-Usage | GPU-Util  Compute M. |
|                                         |                        |               MIG M. |
|=========================================+========================+======================|
|   0  NVIDIA A100-SXM4-80GB          Off |   00000000:B0:00.0 Off |                    0 |
| N/A   28C    P0             61W /  500W |       1MiB /  81920MiB |      0%      Default |
|                                         |                        |             Disabled |
+-----------------------------------------+------------------------+----------------------+
                                                                                         
+-----------------------------------------------------------------------------------------+
| Processes:                                                                              |
|  GPU   GI   CI        PID   Type   Process name                              GPU Memory |
|        ID   ID                                                               Usage      |
|=========================================================================================|
|  No running processes found                                                             |
+-----------------------------------------------------------------------------------------+
Running: ./utils_qcri/clustering.sh 1000 8 visualize
Output for iteration 8:
Preparing for visualize
USAGE: create_kmeans_clustering.py -p <POINT_FILE> -v <VOCAB_FILE> -k <CLUSTERS> -o <OUTPUT_FOLDER>
Initialization complete
Iteration 0, inertia 70074368.07662761
Iteration 1, inertia 45691018.11582911
Iteration 2, inertia 44288684.64088417
Iteration 3, inertia 43854618.491552204
Iteration 4, inertia 43640605.12848975
Iteration 5, inertia 43521767.497884616
Iteration 6, inertia 43442365.29549001
Iteration 7, inertia 43396865.35230285
Iteration 8, inertia 43359150.531782
Iteration 9, inertia 43330752.636143446
Iteration 10, inertia 43313527.079128906
Iteration 11, inertia 43302771.131754205
Iteration 12, inertia 43295679.545774095
Iteration 13, inertia 43287795.093235575
Iteration 14, inertia 43281659.08451658
Iteration 15, inertia 43277892.46903464
Iteration 16, inertia 43274492.967342295
Iteration 17, inertia 43268851.73167355
Iteration 18, inertia 43266104.896312706
Iteration 19, inertia 43264283.82699852
Iteration 20, inertia 43261788.646122545
Iteration 21, inertia 43260884.02527412
Iteration 22, inertia 43260353.5925734
Iteration 23, inertia 43259890.51974484
Iteration 24, inertia 43259473.92895862
Iteration 25, inertia 43258696.88100254
Iteration 26, inertia 43258020.34664015
Iteration 27, inertia 43257133.75215481
Iteration 28, inertia 43256666.90999018
Iteration 29, inertia 43256384.963359036
Iteration 30, inertia 43256192.01692151
Iteration 31, inertia 43256109.058699876
Iteration 32, inertia 43256096.383219324
Iteration 33, inertia 43256066.729625754
Converged at iteration 33: strict convergence.
Initialization complete
Iteration 0, inertia 70087893.14733683
Iteration 1, inertia 45531910.85606331
Iteration 2, inertia 44272316.31072979
Iteration 3, inertia 43861678.69313847
Iteration 4, inertia 43642716.954356685
Iteration 5, inertia 43530432.74931297
Iteration 6, inertia 43457909.46611263
Iteration 7, inertia 43410314.72571103
Iteration 8, inertia 43372810.81980859
Iteration 9, inertia 43348973.67914906
Iteration 10, inertia 43335307.18140571
Iteration 11, inertia 43326183.225421734
Iteration 12, inertia 43320759.54505292
Iteration 13, inertia 43310114.03065324
Iteration 14, inertia 43302612.53577896
Iteration 15, inertia 43299132.28093851
Iteration 16, inertia 43296205.57221021
Iteration 17, inertia 43293032.12285039
Iteration 18, inertia 43289487.65141757
Iteration 19, inertia 43285411.47051548
Iteration 20, inertia 43282009.80736086
Iteration 21, inertia 43279886.98716222
Iteration 22, inertia 43278669.78085274
Iteration 23, inertia 43277440.3789967
Iteration 24, inertia 43276567.692569874
Iteration 25, inertia 43271036.25472937
Iteration 26, inertia 43264262.447903246
Iteration 27, inertia 43262695.33413561
Iteration 28, inertia 43262592.10328922
Converged at iteration 28: strict convergence.
Initialization complete
Iteration 0, inertia 69826213.36460714
Iteration 1, inertia 45558172.10758942
Iteration 2, inertia 44283776.375674576
Iteration 3, inertia 43904407.45923602
Iteration 4, inertia 43719990.613765255
Iteration 5, inertia 43599293.86420887
Iteration 6, inertia 43513443.69336425
Iteration 7, inertia 43453199.77764132
Iteration 8, inertia 43414184.55840048
Iteration 9, inertia 43381537.98595489
Iteration 10, inertia 43356909.47816998
Iteration 11, inertia 43341026.9545111
Iteration 12, inertia 43328340.872927986
Iteration 13, inertia 43320829.54954737
Iteration 14, inertia 43313835.979617044
Iteration 15, inertia 43307056.201772444
Iteration 16, inertia 43302201.36439163
Iteration 17, inertia 43299864.47642411
Iteration 18, inertia 43297724.69480843
Iteration 19, inertia 43293375.72935344
Iteration 20, inertia 43289047.26507111
Iteration 21, inertia 43286945.290610105
Iteration 22, inertia 43284667.503029145
Iteration 23, inertia 43281225.12504613
Iteration 24, inertia 43277726.5771382
Iteration 25, inertia 43276285.29220602
Iteration 26, inertia 43275262.565007694
Iteration 27, inertia 43274576.90946143
Iteration 28, inertia 43273143.24171269
Iteration 29, inertia 43272030.43604239
Iteration 30, inertia 43271526.53068613
Iteration 31, inertia 43270943.662251726
Iteration 32, inertia 43270511.48283313
Iteration 33, inertia 43270303.22226006
Iteration 34, inertia 43270064.06632806
Iteration 35, inertia 43269939.58114373
Iteration 36, inertia 43269756.6129276
Iteration 37, inertia 43269606.34626237
Iteration 38, inertia 43269508.4539179
Iteration 39, inertia 43269415.481802285
Iteration 40, inertia 43269253.04230985
Iteration 41, inertia 43269172.71594055
Iteration 42, inertia 43269131.70439267
Iteration 43, inertia 43269038.66068778
Iteration 44, inertia 43268965.41006655
Iteration 45, inertia 43268944.790757425
Iteration 46, inertia 43268910.34448744
Iteration 47, inertia 43268862.032123625
Iteration 48, inertia 43268831.70987817
Iteration 49, inertia 43268812.42573363
Iteration 50, inertia 43268796.03957118
Iteration 51, inertia 43268758.79045447
Iteration 52, inertia 43268719.31252363
Iteration 53, inertia 43268693.8512463
Iteration 54, inertia 43268674.14599091
Iteration 55, inertia 43268659.471205235
Iteration 56, inertia 43268647.35051705
Iteration 57, inertia 43268634.75701887
Iteration 58, inertia 43268626.98950855
Iteration 59, inertia 43268624.387750275
Iteration 60, inertia 43268621.45138129
Iteration 61, inertia 43268619.08273388
Iteration 62, inertia 43268617.16569895
Iteration 63, inertia 43268613.5503472
Iteration 64, inertia 43268611.85075605
Iteration 65, inertia 43268611.07170884
Iteration 66, inertia 43268610.8931622
Iteration 67, inertia 43268610.69463943
Converged at iteration 67: strict convergence.
Initialization complete
Iteration 0, inertia 70285387.48025529
Iteration 1, inertia 45656774.16916624
Iteration 2, inertia 44267288.753540836
Iteration 3, inertia 43799385.649538934
Iteration 4, inertia 43596364.54616124
Iteration 5, inertia 43480730.82992844
Iteration 6, inertia 43401062.9703156
Iteration 7, inertia 43345881.56263266
Iteration 8, inertia 43304176.088000804
Iteration 9, inertia 43258934.38959444
Iteration 10, inertia 43228349.4330169
Iteration 11, inertia 43195926.88661527
Iteration 12, inertia 43182500.57177169
Iteration 13, inertia 43174133.68909349
Iteration 14, inertia 43168030.23650414
Iteration 15, inertia 43164844.54120405
Iteration 16, inertia 43163610.48400567
Iteration 17, inertia 43162239.6664877
Iteration 18, inertia 43160284.08282232
Iteration 19, inertia 43159458.158081494
Iteration 20, inertia 43159014.69521068
Iteration 21, inertia 43158611.448481016
Iteration 22, inertia 43158383.840039186
Iteration 23, inertia 43158287.03266414
Iteration 24, inertia 43158188.24494078
Iteration 25, inertia 43158055.615634814
Iteration 26, inertia 43158036.70950993
Iteration 27, inertia 43158011.16342914
Converged at iteration 27: strict convergence.
Initialization complete
Iteration 0, inertia 70134411.70211433
Iteration 1, inertia 45731596.470593944
Iteration 2, inertia 44296201.111616045
Iteration 3, inertia 43849586.15995782
Iteration 4, inertia 43633483.02074685
Iteration 5, inertia 43506009.20850521
Iteration 6, inertia 43431227.510140814
Iteration 7, inertia 43383521.59832056
Iteration 8, inertia 43348115.570678145
Iteration 9, inertia 43327724.10970304
Iteration 10, inertia 43315729.89264868
Iteration 11, inertia 43305830.61895108
Iteration 12, inertia 43296383.10613193
Iteration 13, inertia 43289456.31539464
Iteration 14, inertia 43283643.88450424
Iteration 15, inertia 43280105.8467362
Iteration 16, inertia 43276252.70412287
Iteration 17, inertia 43269143.34188068
Iteration 18, inertia 43263562.32341058
Iteration 19, inertia 43260157.99727293
Iteration 20, inertia 43255845.55618194
Iteration 21, inertia 43250734.590873696
Iteration 22, inertia 43248185.398078844
Iteration 23, inertia 43246849.23643183
Iteration 24, inertia 43245616.856570885
Iteration 25, inertia 43244667.99604777
Iteration 26, inertia 43243598.78333801
Iteration 27, inertia 43242961.39258576
Iteration 28, inertia 43242072.972394146
Iteration 29, inertia 43241624.8601849
Iteration 30, inertia 43241305.7037174
Iteration 31, inertia 43241090.31015392
Iteration 32, inertia 43240985.18509458
Iteration 33, inertia 43240805.69034765
Iteration 34, inertia 43240636.136118844
Iteration 35, inertia 43240549.35292749
Iteration 36, inertia 43240426.39698401
Iteration 37, inertia 43240187.67717628
Iteration 38, inertia 43240050.90922121
Iteration 39, inertia 43240033.712401725
Iteration 40, inertia 43240019.359783754
Converged at iteration 40: strict convergence.
Initialization complete
Iteration 0, inertia 70356816.96218808
Iteration 1, inertia 45718780.89818139
Iteration 2, inertia 44363969.99324072
Iteration 3, inertia 43956083.45217017
Iteration 4, inertia 43718927.876596965
Iteration 5, inertia 43571832.635623835
Iteration 6, inertia 43476984.32343512
Iteration 7, inertia 43406738.038620256
Iteration 8, inertia 43367354.224905476
Iteration 9, inertia 43332721.77107341
Iteration 10, inertia 43311909.41976663
Iteration 11, inertia 43294769.64751352
Iteration 12, inertia 43278869.07731692
Iteration 13, inertia 43269753.4086342
Iteration 14, inertia 43263329.81768882
Iteration 15, inertia 43258044.60022848
Iteration 16, inertia 43252044.891091764
Iteration 17, inertia 43246736.699003935
Iteration 18, inertia 43243896.674337946
Iteration 19, inertia 43242359.955868974
Iteration 20, inertia 43241332.71075344
Iteration 21, inertia 43240264.1500431
Iteration 22, inertia 43238798.7147588
Iteration 23, inertia 43237980.43250531
Iteration 24, inertia 43237452.71856675
Iteration 25, inertia 43236974.579356536
Iteration 26, inertia 43236072.7973987
Iteration 27, inertia 43235763.32878018
Iteration 28, inertia 43235628.87255472
Iteration 29, inertia 43235534.667148836
Iteration 30, inertia 43235470.38534772
Iteration 31, inertia 43235448.97099619
Iteration 32, inertia 43235437.63716384
Iteration 33, inertia 43235427.32080627
Iteration 34, inertia 43235419.09355599
Iteration 35, inertia 43235418.310339525
Converged at iteration 35: center shift 0.00018082518354451497 within tolerance 0.00021925401972330773.
Initialization complete
Iteration 0, inertia 70450261.52106898
Iteration 1, inertia 45840049.5801036
Iteration 2, inertia 44388159.7767184
Iteration 3, inertia 43971979.600226246
Iteration 4, inertia 43768218.08319071
Iteration 5, inertia 43641063.59891479
Iteration 6, inertia 43574214.726343855
Iteration 7, inertia 43532360.656447254
Iteration 8, inertia 43499400.346834294
Iteration 9, inertia 43473850.42379427
Iteration 10, inertia 43454763.33431955
Iteration 11, inertia 43434507.44282209
Iteration 12, inertia 43426233.73066403
Iteration 13, inertia 43420427.13860034
Iteration 14, inertia 43416201.99211875
Iteration 15, inertia 43414499.38773598
Iteration 16, inertia 43413326.63427193
Iteration 17, inertia 43412168.34116656
Iteration 18, inertia 43410919.29488521
Iteration 19, inertia 43409094.72043991
Iteration 20, inertia 43405092.622225836
Iteration 21, inertia 43403572.48023718
Iteration 22, inertia 43402601.17972194
Iteration 23, inertia 43401275.65925502
Iteration 24, inertia 43400161.068105645
Iteration 25, inertia 43398175.80412193
Iteration 26, inertia 43396716.200112924
Iteration 27, inertia 43396324.28140961
Iteration 28, inertia 43395889.81366538
Iteration 29, inertia 43395540.41967107
Iteration 30, inertia 43395150.02446545
Iteration 31, inertia 43394932.747598834
Iteration 32, inertia 43394794.9631115
Iteration 33, inertia 43394546.07938818
Iteration 34, inertia 43394396.570835754
Iteration 35, inertia 43394114.87149842
Iteration 36, inertia 43393949.29691311
Iteration 37, inertia 43393624.31115183
Iteration 38, inertia 43393442.44816184
Iteration 39, inertia 43393264.04345737
Iteration 40, inertia 43392974.56049019
Iteration 41, inertia 43392803.37597941
Iteration 42, inertia 43392627.816703
Iteration 43, inertia 43392020.5276724
Iteration 44, inertia 43391247.27644574
Iteration 45, inertia 43390698.6883609
Iteration 46, inertia 43390378.749713786
Iteration 47, inertia 43390056.1114329
Iteration 48, inertia 43389437.321729384
Iteration 49, inertia 43388967.95775827
Iteration 50, inertia 43388119.89479769
Iteration 51, inertia 43387585.51266591
Iteration 52, inertia 43387046.16658989
Iteration 53, inertia 43386658.87532351
Iteration 54, inertia 43386363.242416464
Iteration 55, inertia 43386198.1463738
Iteration 56, inertia 43386028.42788685
Iteration 57, inertia 43385947.44242525
Iteration 58, inertia 43385719.71684144
Iteration 59, inertia 43385348.34138497
Iteration 60, inertia 43385316.03034626
Converged at iteration 60: strict convergence.
Initialization complete
Iteration 0, inertia 70109125.97807091
Iteration 1, inertia 45636272.321279176
Iteration 2, inertia 44202556.53746535
Iteration 3, inertia 43767421.96300227
Iteration 4, inertia 43548697.39696309
Iteration 5, inertia 43418301.06184677
Iteration 6, inertia 43331066.667399235
Iteration 7, inertia 43279761.01292714
Iteration 8, inertia 43249355.507325664
Iteration 9, inertia 43230048.08169495
Iteration 10, inertia 43211999.10237251
Iteration 11, inertia 43201930.02178081
Iteration 12, inertia 43192601.81030278
Iteration 13, inertia 43186893.53070321
Iteration 14, inertia 43183409.69600615
Iteration 15, inertia 43177384.54244941
Iteration 16, inertia 43175059.61604986
Iteration 17, inertia 43173797.10534925
Iteration 18, inertia 43173540.09546278
Iteration 19, inertia 43173342.62866623
Iteration 20, inertia 43173261.290084556
Iteration 21, inertia 43173193.61268644
Iteration 22, inertia 43173154.26274721
Iteration 23, inertia 43173106.5858639
Iteration 24, inertia 43173047.61400817
Iteration 25, inertia 43173009.24195282
Iteration 26, inertia 43172991.42528962
Iteration 27, inertia 43172974.71367018
Iteration 28, inertia 43172955.829689726
Iteration 29, inertia 43172935.463932164
Iteration 30, inertia 43172930.395297416
Iteration 31, inertia 43172929.853249215
Iteration 32, inertia 43172929.63085632
Converged at iteration 32: strict convergence.
Initialization complete
Iteration 0, inertia 70146069.48207304
Iteration 1, inertia 45479756.97464183
Iteration 2, inertia 44150100.1486615
Iteration 3, inertia 43745752.035159126
Iteration 4, inertia 43550777.816910036
Iteration 5, inertia 43430816.60049212
Iteration 6, inertia 43332061.74496527
Iteration 7, inertia 43281095.78777397
Iteration 8, inertia 43244028.0994102
Iteration 9, inertia 43220308.63459423
Iteration 10, inertia 43189316.683484286
Iteration 11, inertia 43165804.585345045
Iteration 12, inertia 43150141.50506112
Iteration 13, inertia 43137742.162123024
Iteration 14, inertia 43126093.96816649
Iteration 15, inertia 43119046.3249943
Iteration 16, inertia 43117034.42920951
Iteration 17, inertia 43115082.104258955
Iteration 18, inertia 43113417.57457704
Iteration 19, inertia 43112737.3031459
Iteration 20, inertia 43112351.00267356
Iteration 21, inertia 43112223.70469203
Iteration 22, inertia 43112176.50531446
Iteration 23, inertia 43111986.571225345
Iteration 24, inertia 43111426.20520563
Iteration 25, inertia 43108621.7938558
Iteration 26, inertia 43106660.153889224
Iteration 27, inertia 43106430.67173652
Iteration 28, inertia 43106356.95907717
Converged at iteration 28: strict convergence.
Initialization complete
Iteration 0, inertia 69879404.8754407
Iteration 1, inertia 45589548.349916846
Iteration 2, inertia 44320960.809549674
Iteration 3, inertia 43857032.025261976
Iteration 4, inertia 43615545.69965452
Iteration 5, inertia 43494924.52614212
Iteration 6, inertia 43422359.83389555
Iteration 7, inertia 43371074.816345096
Iteration 8, inertia 43326370.30348571
Iteration 9, inertia 43287983.57071412
Iteration 10, inertia 43259117.459661484
Iteration 11, inertia 43234640.762583144
Iteration 12, inertia 43218231.255612016
Iteration 13, inertia 43211352.87421958
Iteration 14, inertia 43204644.46872658
Iteration 15, inertia 43197847.46285142
Iteration 16, inertia 43192067.459384285
Iteration 17, inertia 43185291.04133795
Iteration 18, inertia 43181670.60897935
Iteration 19, inertia 43180219.5006102
Iteration 20, inertia 43179366.263562664
Iteration 21, inertia 43178606.58242184
Iteration 22, inertia 43177564.8270995
Iteration 23, inertia 43177080.88327451
Iteration 24, inertia 43176778.838344656
Iteration 25, inertia 43176205.97735153
Iteration 26, inertia 43175236.45356443
Iteration 27, inertia 43173121.26119478
Iteration 28, inertia 43170414.905176185
Iteration 29, inertia 43169491.12994835
Iteration 30, inertia 43168887.553429924
Iteration 31, inertia 43168593.075927906
Iteration 32, inertia 43167927.71139078
Iteration 33, inertia 43167858.65666029
Iteration 34, inertia 43167847.835288994
Iteration 35, inertia 43167839.9574555
Iteration 36, inertia 43167835.75261657
Iteration 37, inertia 43167834.92492311
Iteration 38, inertia 43167833.91182124
Iteration 39, inertia 43167833.241908446
Converged at iteration 39: strict convergence.
Filename: code/create_kmeans_clustering.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    10    553.7 MiB    553.7 MiB           1   @profile
    11                                         def kmeans_cluster(P, V, K, output_path, prefix, ref=''):
    12                                             """
    13                                             Uses the point.npy P, vocab.npy V files of a layer (generated using https://github.com/hsajjad/ConceptX/ library) to produce a clustering of <K> clusters at <output_path> named clusters-kmeans-{K}.txt
    14                                             """
    15    553.7 MiB      0.0 MiB           1       kmeans = KMeans(n_clusters=K, verbose=3, random_state=212)
    16    703.3 MiB    149.6 MiB           1       output = kmeans.fit(P)
    17                                             
    18    703.3 MiB      0.0 MiB           1       out_file =  f"{output_path}/{prefix}-clusters-kmeans-{K}{ref}.txt"
    19                                         
    20    703.3 MiB      0.0 MiB        1003       clusters = {i:[] for i in range(K)}
    21                                             
    22    709.3 MiB      0.0 MiB       72899       for v, l in zip(V, output.labels_):
    23    709.3 MiB      6.0 MiB       72898          clusters[l].append(f'{v}|||{l}')
    24                                         
    25                                         
    26    709.3 MiB      0.0 MiB           1       out = ""
    27    709.3 MiB      0.0 MiB        1001       for k,v in clusters.items():
    28    709.3 MiB      0.0 MiB        1000           out += '\n'.join(v) + '\n'
    29                                         
    30                                             
    31    709.3 MiB      0.0 MiB           1       with open(out_file, 'w') as f2:
    32    709.3 MiB      0.0 MiB           1           f2.write(out)
    33                                         
    34    709.3 MiB      0.0 MiB           1       return out


Runtime: 999.5112171173096
USAGE: create_kmeans_clustering.py -p <POINT_FILE> -v <VOCAB_FILE> -k <CLUSTERS> -o <OUTPUT_FOLDER>
Initialization complete
Iteration 0, inertia 81132730.4827396
Iteration 1, inertia 55060006.65045451
Iteration 2, inertia 53674749.6784236
Iteration 3, inertia 53187031.29799519
Iteration 4, inertia 52923188.67802853
Iteration 5, inertia 52761772.76146684
Iteration 6, inertia 52645828.25199869
Iteration 7, inertia 52557492.06455462
Iteration 8, inertia 52494747.11971636
Iteration 9, inertia 52448111.024057925
Iteration 10, inertia 52410906.74846961
Iteration 11, inertia 52381311.87188311
Iteration 12, inertia 52353433.302549675
Iteration 13, inertia 52329007.48058227
Iteration 14, inertia 52309583.263813436
Iteration 15, inertia 52290006.470938906
Iteration 16, inertia 52276102.456033245
Iteration 17, inertia 52268141.42966647
Iteration 18, inertia 52262023.14309156
Iteration 19, inertia 52257424.83342235
Iteration 20, inertia 52254002.14188489
Iteration 21, inertia 52251124.93468406
Iteration 22, inertia 52248548.299625084
Iteration 23, inertia 52246344.31494772
Iteration 24, inertia 52243936.593835555
Iteration 25, inertia 52242364.76675809
Iteration 26, inertia 52241318.44887629
Iteration 27, inertia 52240315.727391705
Iteration 28, inertia 52239677.28983114
Iteration 29, inertia 52239327.29531162
Iteration 30, inertia 52239038.64564003
Iteration 31, inertia 52238687.86789022
Iteration 32, inertia 52238016.51733351
Iteration 33, inertia 52237677.264838
Iteration 34, inertia 52237411.02413043
Iteration 35, inertia 52236973.86987558
Iteration 36, inertia 52236677.66594958
Iteration 37, inertia 52236424.507566385
Iteration 38, inertia 52236024.05598289
Iteration 39, inertia 52235704.2011329
Iteration 40, inertia 52235616.02197234
Iteration 41, inertia 52235502.03805598
Iteration 42, inertia 52235360.66686089
Iteration 43, inertia 52235278.00180695
Iteration 44, inertia 52235176.88831404
Iteration 45, inertia 52234941.937689826
Iteration 46, inertia 52234907.225882374
Iteration 47, inertia 52234821.71312192
Iteration 48, inertia 52234784.62196191
Iteration 49, inertia 52234722.12593296
Iteration 50, inertia 52234595.045037836
Iteration 51, inertia 52234541.189147085
Converged at iteration 51: strict convergence.
Initialization complete
Iteration 0, inertia 80669054.09685212
Iteration 1, inertia 54971182.49206769
Iteration 2, inertia 53613285.48289778
Iteration 3, inertia 53121825.779985644
Iteration 4, inertia 52857134.79166149
Iteration 5, inertia 52684423.49392806
Iteration 6, inertia 52562233.00119227
Iteration 7, inertia 52476555.29605302
Iteration 8, inertia 52416897.44754221
Iteration 9, inertia 52369480.9704999
Iteration 10, inertia 52330632.7523867
Iteration 11, inertia 52300517.03115998
Iteration 12, inertia 52275998.78675382
Iteration 13, inertia 52256790.240614556
Iteration 14, inertia 52239207.17388406
Iteration 15, inertia 52225723.8534235
Iteration 16, inertia 52212450.19748951
Iteration 17, inertia 52200488.35943959
Iteration 18, inertia 52191385.1696171
Iteration 19, inertia 52182370.32069162
Iteration 20, inertia 52173508.30178575
Iteration 21, inertia 52166284.08139576
Iteration 22, inertia 52161770.25541183
Iteration 23, inertia 52157204.3416397
Iteration 24, inertia 52152622.11358931
Iteration 25, inertia 52148019.05806373
Iteration 26, inertia 52144054.13722398
Iteration 27, inertia 52140667.320822425
Iteration 28, inertia 52137625.95328195
Iteration 29, inertia 52135724.177428946
Iteration 30, inertia 52134378.85735614
Iteration 31, inertia 52133438.09411515
Iteration 32, inertia 52132937.110406145
Iteration 33, inertia 52132258.93423261
Iteration 34, inertia 52131403.30317016
Iteration 35, inertia 52130536.973448806
Iteration 36, inertia 52129711.89495331
Iteration 37, inertia 52129282.97463091
Iteration 38, inertia 52128942.456682414
Iteration 39, inertia 52128672.63516333
Iteration 40, inertia 52128463.65921153
Iteration 41, inertia 52128325.65463006
Iteration 42, inertia 52128278.28027047
Converged at iteration 42: strict convergence.
Initialization complete
Iteration 0, inertia 80937580.49553354
Iteration 1, inertia 55041319.496078655
Iteration 2, inertia 53661622.48889176
Iteration 3, inertia 53176080.45589905
Iteration 4, inertia 52915507.783028156
Iteration 5, inertia 52755508.94264791
Iteration 6, inertia 52647505.04015716
Iteration 7, inertia 52571689.50978969
Iteration 8, inertia 52520544.61691019
Iteration 9, inertia 52478261.8248585
Iteration 10, inertia 52442320.29402477
Iteration 11, inertia 52412107.495876886
Iteration 12, inertia 52387855.05959964
Iteration 13, inertia 52369164.51591065
Iteration 14, inertia 52355232.62911622
Iteration 15, inertia 52342817.021030486
Iteration 16, inertia 52330525.37181198
Iteration 17, inertia 52324084.82641075
Iteration 18, inertia 52318485.018300265
Iteration 19, inertia 52312581.357670404
Iteration 20, inertia 52308745.02642462
Iteration 21, inertia 52305227.87218908
Iteration 22, inertia 52301387.75627086
Iteration 23, inertia 52298117.68256585
Iteration 24, inertia 52295869.621296145
Iteration 25, inertia 52293854.70316489
Iteration 26, inertia 52291037.74346309
Iteration 27, inertia 52289577.74978682
Iteration 28, inertia 52288425.34179758
Iteration 29, inertia 52287595.99227564
Iteration 30, inertia 52286981.225698195
Iteration 31, inertia 52286578.637468085
Iteration 32, inertia 52286138.58259777
Iteration 33, inertia 52285712.20602974
Iteration 34, inertia 52285093.75158627
Iteration 35, inertia 52284328.49164528
Iteration 36, inertia 52283793.1849048
Iteration 37, inertia 52283340.91095117
Iteration 38, inertia 52282690.6550028
Iteration 39, inertia 52282189.774322204
Iteration 40, inertia 52281823.19206974
Iteration 41, inertia 52281414.12340231
Iteration 42, inertia 52281233.963067055
Iteration 43, inertia 52281098.02738008
Iteration 44, inertia 52281036.83336217
Iteration 45, inertia 52281011.55333526
Iteration 46, inertia 52280999.44950272
Iteration 47, inertia 52280992.815418676
Converged at iteration 47: strict convergence.
Initialization complete
Iteration 0, inertia 80606445.26619574
Iteration 1, inertia 55084419.57626402
Iteration 2, inertia 53692985.9684129
Iteration 3, inertia 53185396.264342785
Iteration 4, inertia 52922582.161669515
Iteration 5, inertia 52779340.56233188
Iteration 6, inertia 52691738.64753584
Iteration 7, inertia 52626106.959947504
Iteration 8, inertia 52578020.08986868
Iteration 9, inertia 52536815.82313997
Iteration 10, inertia 52495817.96524307
Iteration 11, inertia 52468181.8101705
Iteration 12, inertia 52442989.44882597
Iteration 13, inertia 52414884.215852655
Iteration 14, inertia 52395822.97377945
Iteration 15, inertia 52380253.43002984
Iteration 16, inertia 52367213.039052814
Iteration 17, inertia 52354908.90557479
Iteration 18, inertia 52346650.51314165
Iteration 19, inertia 52340906.76493048
Iteration 20, inertia 52336941.513008654
Iteration 21, inertia 52334601.96477669
Iteration 22, inertia 52332845.62746623
Iteration 23, inertia 52331490.86110339
Iteration 24, inertia 52330233.479459845
Iteration 25, inertia 52329423.19166879
Iteration 26, inertia 52328609.65504304
Iteration 27, inertia 52328040.35109012
Iteration 28, inertia 52327567.81278186
Iteration 29, inertia 52326947.12164737
Iteration 30, inertia 52326254.03391354
Iteration 31, inertia 52325403.76965123
Iteration 32, inertia 52324277.31819212
Iteration 33, inertia 52323165.94587284
Iteration 34, inertia 52322387.84965905
Iteration 35, inertia 52321340.86811247
Iteration 36, inertia 52320535.72982747
Iteration 37, inertia 52320189.93249249
Iteration 38, inertia 52319644.84359512
Iteration 39, inertia 52319384.966921344
Iteration 40, inertia 52319079.02601669
Iteration 41, inertia 52318834.848162405
Iteration 42, inertia 52318562.20469023
Iteration 43, inertia 52318289.98529593
Iteration 44, inertia 52317996.86622293
Iteration 45, inertia 52317594.26266171
Iteration 46, inertia 52316787.57091294
Iteration 47, inertia 52316551.295760736
Iteration 48, inertia 52316261.076747164
Iteration 49, inertia 52316115.04462376
Iteration 50, inertia 52316070.91676334
Iteration 51, inertia 52316026.16354853
Converged at iteration 51: strict convergence.
Initialization complete
Iteration 0, inertia 80917032.0279972
Iteration 1, inertia 55075226.47165209
Iteration 2, inertia 53689341.39313348
Iteration 3, inertia 53173326.081347175
Iteration 4, inertia 52896422.25327599
Iteration 5, inertia 52741677.36310917
Iteration 6, inertia 52645059.259831116
Iteration 7, inertia 52578611.02060626
Iteration 8, inertia 52528964.7368084
Iteration 9, inertia 52492035.29826112
Iteration 10, inertia 52462738.05818899
Iteration 11, inertia 52444084.021800734
Iteration 12, inertia 52429851.26823213
Iteration 13, inertia 52416515.70773956
Iteration 14, inertia 52401017.7754406
Iteration 15, inertia 52387945.09404104
Iteration 16, inertia 52378031.680764854
Iteration 17, inertia 52369053.939011216
Iteration 18, inertia 52360789.70243057
Iteration 19, inertia 52352495.93277743
Iteration 20, inertia 52345878.973534726
Iteration 21, inertia 52340539.475993425
Iteration 22, inertia 52336652.828381754
Iteration 23, inertia 52334074.33871327
Iteration 24, inertia 52331280.653690726
Iteration 25, inertia 52329484.808600485
Iteration 26, inertia 52328032.25268232
Iteration 27, inertia 52326710.96255413
Iteration 28, inertia 52325904.68696875
Iteration 29, inertia 52325304.52629788
Iteration 30, inertia 52324591.06785359
Iteration 31, inertia 52323740.17718345
Iteration 32, inertia 52322996.35816563
Iteration 33, inertia 52322465.67118095
Iteration 34, inertia 52321859.155418985
Iteration 35, inertia 52320840.63349486
Iteration 36, inertia 52319727.73633549
Iteration 37, inertia 52318729.619545735
Iteration 38, inertia 52318077.50353948
Iteration 39, inertia 52317815.20222446
Iteration 40, inertia 52317506.45791873
Iteration 41, inertia 52317109.29408069
Iteration 42, inertia 52316526.92557262
Iteration 43, inertia 52316015.87675689
Iteration 44, inertia 52315151.57815646
Iteration 45, inertia 52314900.97629172
Iteration 46, inertia 52314769.51277684
Iteration 47, inertia 52314731.65395101
Iteration 48, inertia 52314689.15615279
Converged at iteration 48: strict convergence.
Initialization complete
Iteration 0, inertia 80634112.12923644
Iteration 1, inertia 54980427.65166074
Iteration 2, inertia 53621723.575892955
Iteration 3, inertia 53119584.90005484
Iteration 4, inertia 52862918.688538566
Iteration 5, inertia 52702651.92161967
Iteration 6, inertia 52602666.449351236
Iteration 7, inertia 52533976.24857081
Iteration 8, inertia 52482661.100471705
Iteration 9, inertia 52445826.02249522
Iteration 10, inertia 52411876.53814082
Iteration 11, inertia 52385181.80591027
Iteration 12, inertia 52364137.449642204
Iteration 13, inertia 52347778.97932908
Iteration 14, inertia 52334167.523490556
Iteration 15, inertia 52321507.76251117
Iteration 16, inertia 52311180.77211012
Iteration 17, inertia 52302462.70615199
Iteration 18, inertia 52293431.078082755
Iteration 19, inertia 52287607.52595691
Iteration 20, inertia 52283121.222731665
Iteration 21, inertia 52279653.29321002
Iteration 22, inertia 52276015.09729486
Iteration 23, inertia 52272909.50941506
Iteration 24, inertia 52270215.10025937
Iteration 25, inertia 52267685.76387866
Iteration 26, inertia 52265209.22100534
Iteration 27, inertia 52263086.794818036
Iteration 28, inertia 52261059.14010183
Iteration 29, inertia 52259695.77536594
Iteration 30, inertia 52257870.07635499
Iteration 31, inertia 52256759.92983092
Iteration 32, inertia 52256269.46497451
Iteration 33, inertia 52255904.776657075
Iteration 34, inertia 52255470.30771016
Iteration 35, inertia 52255092.29620823
Iteration 36, inertia 52254759.137473635
Iteration 37, inertia 52254291.438632384
Iteration 38, inertia 52253960.769917816
Iteration 39, inertia 52253680.24524614
Iteration 40, inertia 52253332.96404301
Iteration 41, inertia 52253008.31149484
Iteration 42, inertia 52252766.85308924
Iteration 43, inertia 52252578.66716591
Iteration 44, inertia 52252488.222981036
Iteration 45, inertia 52252445.21207443
Iteration 46, inertia 52252409.33468116
Iteration 47, inertia 52252405.740283884
Converged at iteration 47: strict convergence.
Initialization complete
Iteration 0, inertia 81087866.81426574
Iteration 1, inertia 55053864.42178465
Iteration 2, inertia 53604583.964133635
Iteration 3, inertia 53094410.31469756
Iteration 4, inertia 52838831.972179964
Iteration 5, inertia 52681312.467427
Iteration 6, inertia 52568939.591012396
Iteration 7, inertia 52488141.23081879
Iteration 8, inertia 52426768.70472979
Iteration 9, inertia 52378902.957688175
Iteration 10, inertia 52340947.32162906
Iteration 11, inertia 52311143.687380165
Iteration 12, inertia 52288629.81653686
Iteration 13, inertia 52272369.89317718
Iteration 14, inertia 52260196.881956905
Iteration 15, inertia 52250907.15232577
Iteration 16, inertia 52242181.85311235
Iteration 17, inertia 52234144.820307404
Iteration 18, inertia 52225842.64340636
Iteration 19, inertia 52216765.257520065
Iteration 20, inertia 52209185.13917382
Iteration 21, inertia 52202699.35999584
Iteration 22, inertia 52198118.337618664
Iteration 23, inertia 52193789.60585024
Iteration 24, inertia 52189124.729170635
Iteration 25, inertia 52185857.1365614
Iteration 26, inertia 52184149.334989026
Iteration 27, inertia 52182924.388374776
Iteration 28, inertia 52181795.87169815
Iteration 29, inertia 52181183.20040432
Iteration 30, inertia 52180769.85407859
Iteration 31, inertia 52180261.01154244
Iteration 32, inertia 52179712.60174775
Iteration 33, inertia 52179006.92748251
Iteration 34, inertia 52177563.625410214
Iteration 35, inertia 52176612.01933158
Iteration 36, inertia 52175957.460419275
Iteration 37, inertia 52175687.18411971
Iteration 38, inertia 52175654.67293592
Converged at iteration 38: strict convergence.
Initialization complete
Iteration 0, inertia 81009105.77543025
Iteration 1, inertia 55102169.152014606
Iteration 2, inertia 53698290.450195074
Iteration 3, inertia 53188115.7530965
Iteration 4, inertia 52913549.981506586
Iteration 5, inertia 52746573.078416556
Iteration 6, inertia 52634779.50444149
Iteration 7, inertia 52560615.295566015
Iteration 8, inertia 52508350.12965636
Iteration 9, inertia 52467750.380897194
Iteration 10, inertia 52433417.71739854
Iteration 11, inertia 52404467.30824762
Iteration 12, inertia 52379463.301158495
Iteration 13, inertia 52361159.0778475
Iteration 14, inertia 52347386.15561202
Iteration 15, inertia 52337758.10341521
Iteration 16, inertia 52330872.34825877
Iteration 17, inertia 52326305.79603578
Iteration 18, inertia 52322122.83242148
Iteration 19, inertia 52316492.36823555
Iteration 20, inertia 52310522.330768965
Iteration 21, inertia 52306106.930020444
Iteration 22, inertia 52302906.41104128
Iteration 23, inertia 52299732.38853864
Iteration 24, inertia 52297039.23272643
Iteration 25, inertia 52295089.27202161
Iteration 26, inertia 52293579.235549934
Iteration 27, inertia 52292206.84632579
Iteration 28, inertia 52291012.94252688
Iteration 29, inertia 52290291.71707615
Iteration 30, inertia 52288663.60934457
Iteration 31, inertia 52287170.58998905
Iteration 32, inertia 52286360.09039255
Iteration 33, inertia 52285703.23854825
Iteration 34, inertia 52285018.74092444
Iteration 35, inertia 52284436.345160656
Iteration 36, inertia 52284007.7696691
Iteration 37, inertia 52283700.29329878
Iteration 38, inertia 52283480.94618944
Iteration 39, inertia 52283431.37348382
Iteration 40, inertia 52283417.12415776
Iteration 41, inertia 52283410.54524017
Converged at iteration 41: strict convergence.
Initialization complete
Iteration 0, inertia 81039408.11979581
Iteration 1, inertia 55152953.65294446
Iteration 2, inertia 53749836.9756364
Iteration 3, inertia 53243435.3066113
Iteration 4, inertia 52963862.269717366
Iteration 5, inertia 52776713.260891035
Iteration 6, inertia 52652602.08026523
Iteration 7, inertia 52572916.63373958
Iteration 8, inertia 52509483.09504245
Iteration 9, inertia 52464599.966653265
Iteration 10, inertia 52433577.12879192
Iteration 11, inertia 52410188.87934073
Iteration 12, inertia 52390313.2224394
Iteration 13, inertia 52371476.98653501
Iteration 14, inertia 52356486.42041118
Iteration 15, inertia 52346266.102518186
Iteration 16, inertia 52338669.957666695
Iteration 17, inertia 52331036.30738307
Iteration 18, inertia 52324340.804821946
Iteration 19, inertia 52319222.45295793
Iteration 20, inertia 52313394.09749536
Iteration 21, inertia 52306505.81424865
Iteration 22, inertia 52301243.50235695
Iteration 23, inertia 52298248.73668817
Iteration 24, inertia 52295151.11436412
Iteration 25, inertia 52291770.27552485
Iteration 26, inertia 52289640.01452769
Iteration 27, inertia 52287254.27190665
Iteration 28, inertia 52285040.11441512
Iteration 29, inertia 52283721.64424445
Iteration 30, inertia 52282681.03822299
Iteration 31, inertia 52281652.34573085
Iteration 32, inertia 52280853.08863928
Iteration 33, inertia 52280219.631454416
Iteration 34, inertia 52279677.851879135
Iteration 35, inertia 52279157.437377036
Iteration 36, inertia 52278844.593869746
Iteration 37, inertia 52278655.27858329
Iteration 38, inertia 52278381.024594605
Iteration 39, inertia 52278250.89597916
Iteration 40, inertia 52278160.58675427
Iteration 41, inertia 52278124.45563743
Iteration 42, inertia 52278073.21514355
Converged at iteration 42: strict convergence.
Initialization complete
Iteration 0, inertia 80954336.02700019
Iteration 1, inertia 55078736.84591754
Iteration 2, inertia 53668041.00015878
Iteration 3, inertia 53149811.90758994
Iteration 4, inertia 52871658.899338976
Iteration 5, inertia 52690894.44674828
Iteration 6, inertia 52569740.59266475
Iteration 7, inertia 52488803.23652263
Iteration 8, inertia 52433393.33294644
Iteration 9, inertia 52391154.33261779
Iteration 10, inertia 52354145.898263186
Iteration 11, inertia 52323682.89286826
Iteration 12, inertia 52300839.40753476
Iteration 13, inertia 52279982.85403265
Iteration 14, inertia 52257409.85523427
Iteration 15, inertia 52239085.77320217
Iteration 16, inertia 52227037.48443213
Iteration 17, inertia 52217684.487515375
Iteration 18, inertia 52210132.43180176
Iteration 19, inertia 52203807.32872481
Iteration 20, inertia 52199374.35058961
Iteration 21, inertia 52195315.22740337
Iteration 22, inertia 52192318.300601006
Iteration 23, inertia 52189182.69694146
Iteration 24, inertia 52185611.70469252
Iteration 25, inertia 52180547.43442263
Iteration 26, inertia 52176925.00294179
Iteration 27, inertia 52175546.8472466
Iteration 28, inertia 52174518.69599827
Iteration 29, inertia 52173394.09327534
Iteration 30, inertia 52171480.595465384
Iteration 31, inertia 52169949.37352048
Iteration 32, inertia 52168975.307230905
Iteration 33, inertia 52168126.54741107
Iteration 34, inertia 52167552.17417249
Iteration 35, inertia 52166894.53704848
Iteration 36, inertia 52166302.14477507
Iteration 37, inertia 52165934.78592788
Iteration 38, inertia 52165665.52479482
Iteration 39, inertia 52165473.61018177
Iteration 40, inertia 52165372.02409818
Iteration 41, inertia 52165310.19856641
Iteration 42, inertia 52165168.57554296
Converged at iteration 42: strict convergence.
Filename: code/create_kmeans_clustering.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    10    493.8 MiB    493.8 MiB           1   @profile
    11                                         def kmeans_cluster(P, V, K, output_path, prefix, ref=''):
    12                                             """
    13                                             Uses the point.npy P, vocab.npy V files of a layer (generated using https://github.com/hsajjad/ConceptX/ library) to produce a clustering of <K> clusters at <output_path> named clusters-kmeans-{K}.txt
    14                                             """
    15    493.8 MiB      0.0 MiB           1       kmeans = KMeans(n_clusters=K, verbose=3, random_state=212)
    16    637.9 MiB    144.1 MiB           1       output = kmeans.fit(P)
    17                                             
    18    637.9 MiB      0.0 MiB           1       out_file =  f"{output_path}/{prefix}-clusters-kmeans-{K}{ref}.txt"
    19                                         
    20    637.9 MiB      0.0 MiB        1003       clusters = {i:[] for i in range(K)}
    21                                             
    22    642.9 MiB      3.0 MiB       64043       for v, l in zip(V, output.labels_):
    23    642.9 MiB      2.0 MiB       64042          clusters[l].append(f'{v}|||{l}')
    24                                         
    25                                         
    26    642.9 MiB      0.0 MiB           1       out = ""
    27    647.3 MiB      0.0 MiB        1001       for k,v in clusters.items():
    28    647.3 MiB      4.4 MiB        1000           out += '\n'.join(v) + '\n'
    29                                         
    30                                             
    31    647.3 MiB      0.0 MiB           1       with open(out_file, 'w') as f2:
    32    648.3 MiB      1.0 MiB           1           f2.write(out)
    33                                         
    34    648.3 MiB      0.0 MiB           1       return out


Runtime: 899.2657783031464
Combined output written to: visualize_1000/layer8/clusters-1000.txt

Completed iteration 8.

Running: ./utils_qcri/clustering.sh 1000 9 visualize
Output for iteration 9:
Preparing for visualize
USAGE: create_kmeans_clustering.py -p <POINT_FILE> -v <VOCAB_FILE> -k <CLUSTERS> -o <OUTPUT_FOLDER>
Initialization complete
Iteration 0, inertia 94266324.70625651
Iteration 1, inertia 61426437.4179307
Iteration 2, inertia 59715440.61381319
Iteration 3, inertia 59167982.28105459
Iteration 4, inertia 58888347.29538529
Iteration 5, inertia 58717857.3140996
Iteration 6, inertia 58603229.46496001
Iteration 7, inertia 58513926.1155072
Iteration 8, inertia 58442418.0105965
Iteration 9, inertia 58387367.94559394
Iteration 10, inertia 58346671.98165972
Iteration 11, inertia 58319333.2898698
Iteration 12, inertia 58290691.86312502
Iteration 13, inertia 58263227.70857397
Iteration 14, inertia 58247424.09366708
Iteration 15, inertia 58235902.94591044
Iteration 16, inertia 58223820.52099463
Iteration 17, inertia 58211372.400452025
Iteration 18, inertia 58205801.49457892
Iteration 19, inertia 58203678.41643191
Iteration 20, inertia 58200557.74358116
Iteration 21, inertia 58194322.20440924
Iteration 22, inertia 58182964.604340404
Iteration 23, inertia 58179735.24046853
Iteration 24, inertia 58171726.81885267
Iteration 25, inertia 58169489.96447662
Iteration 26, inertia 58168218.87900889
Iteration 27, inertia 58167518.38649013
Iteration 28, inertia 58166590.963070095
Iteration 29, inertia 58164001.82445716
Iteration 30, inertia 58162775.921685815
Iteration 31, inertia 58161611.08438435
Iteration 32, inertia 58161305.212476075
Iteration 33, inertia 58160424.04734724
Iteration 34, inertia 58159639.492424056
Iteration 35, inertia 58157642.46245767
Iteration 36, inertia 58155831.701584496
Iteration 37, inertia 58154791.86534306
Iteration 38, inertia 58153463.32498516
Iteration 39, inertia 58152012.98000406
Iteration 40, inertia 58151444.14575405
Iteration 41, inertia 58151354.35844845
Iteration 42, inertia 58151329.83721031
Iteration 43, inertia 58151328.325890474
Iteration 44, inertia 58151327.9458196
Converged at iteration 44: strict convergence.
Initialization complete
Iteration 0, inertia 94130228.99484022
Iteration 1, inertia 61580464.11404796
Iteration 2, inertia 59703508.93053615
Iteration 3, inertia 59077211.63420307
Iteration 4, inertia 58779516.3583705
Iteration 5, inertia 58634885.41774004
Iteration 6, inertia 58541166.62586445
Iteration 7, inertia 58465699.58378531
Iteration 8, inertia 58413466.87688582
Iteration 9, inertia 58386146.98172252
Iteration 10, inertia 58356413.12806364
Iteration 11, inertia 58340214.84730804
Iteration 12, inertia 58332131.39255259
Iteration 13, inertia 58326386.478648625
Iteration 14, inertia 58321642.784438625
Iteration 15, inertia 58318073.25326997
Iteration 16, inertia 58314626.92170833
Iteration 17, inertia 58312117.20052165
Iteration 18, inertia 58310846.46963614
Iteration 19, inertia 58309474.757794045
Iteration 20, inertia 58308127.74730547
Iteration 21, inertia 58307075.417707734
Iteration 22, inertia 58306207.368018486
Iteration 23, inertia 58305028.42435417
Iteration 24, inertia 58303949.666488975
Iteration 25, inertia 58303030.75545362
Iteration 26, inertia 58301522.21390996
Iteration 27, inertia 58300281.45205186
Iteration 28, inertia 58298765.338268265
Iteration 29, inertia 58295928.898924895
Iteration 30, inertia 58293971.46126218
Iteration 31, inertia 58292327.925325215
Iteration 32, inertia 58291108.18721775
Iteration 33, inertia 58290474.18683365
Iteration 34, inertia 58290028.15120241
Iteration 35, inertia 58289676.232904315
Iteration 36, inertia 58289345.07691128
Iteration 37, inertia 58288975.77219591
Iteration 38, inertia 58288590.95564416
Iteration 39, inertia 58288484.46188391
Iteration 40, inertia 58288374.86791005
Iteration 41, inertia 58288319.51502101
Iteration 42, inertia 58288272.97162045
Iteration 43, inertia 58288252.32522403
Iteration 44, inertia 58288228.10441578
Iteration 45, inertia 58288183.49825989
Iteration 46, inertia 58288136.23182025
Iteration 47, inertia 58288108.87490722
Iteration 48, inertia 58288103.48301051
Converged at iteration 48: strict convergence.
Initialization complete
Iteration 0, inertia 94210609.2429001
Iteration 1, inertia 61550296.610411264
Iteration 2, inertia 59583101.746507615
Iteration 3, inertia 58975049.7919731
Iteration 4, inertia 58709588.01517673
Iteration 5, inertia 58553773.63004302
Iteration 6, inertia 58449096.23602105
Iteration 7, inertia 58377843.57447686
Iteration 8, inertia 58314932.71231942
Iteration 9, inertia 58281741.16898517
Iteration 10, inertia 58258722.73897243
Iteration 11, inertia 58237377.695734836
Iteration 12, inertia 58224216.493153855
Iteration 13, inertia 58211957.2438739
Iteration 14, inertia 58202028.58312009
Iteration 15, inertia 58193754.00042781
Iteration 16, inertia 58187158.08491622
Iteration 17, inertia 58182478.155250885
Iteration 18, inertia 58177864.05146806
Iteration 19, inertia 58174776.61472619
Iteration 20, inertia 58173015.814789124
Iteration 21, inertia 58172250.329355285
Iteration 22, inertia 58171807.671539895
Iteration 23, inertia 58171346.84289743
Iteration 24, inertia 58170697.114565134
Iteration 25, inertia 58170388.73825835
Iteration 26, inertia 58169555.991790496
Iteration 27, inertia 58168496.19244198
Iteration 28, inertia 58167737.7046587
Iteration 29, inertia 58167015.83502342
Iteration 30, inertia 58166427.02651484
Iteration 31, inertia 58165737.43983678
Iteration 32, inertia 58165506.07475136
Iteration 33, inertia 58165329.87222118
Iteration 34, inertia 58165235.518116094
Iteration 35, inertia 58165151.665939674
Iteration 36, inertia 58165032.24909353
Iteration 37, inertia 58164961.69711903
Iteration 38, inertia 58164853.43228246
Iteration 39, inertia 58164810.539386846
Iteration 40, inertia 58164756.402257375
Iteration 41, inertia 58164688.41565792
Iteration 42, inertia 58164664.92128725
Iteration 43, inertia 58164657.001597814
Iteration 44, inertia 58164655.306258716
Iteration 45, inertia 58164655.08047527
Converged at iteration 45: strict convergence.
Initialization complete
Iteration 0, inertia 94535759.45385818
Iteration 1, inertia 61565527.72564043
Iteration 2, inertia 59598139.107564144
Iteration 3, inertia 58974756.41963733
Iteration 4, inertia 58728186.205504596
Iteration 5, inertia 58591772.384891406
Iteration 6, inertia 58499652.36272823
Iteration 7, inertia 58440860.6589978
Iteration 8, inertia 58389612.16507178
Iteration 9, inertia 58353394.202189796
Iteration 10, inertia 58321176.18362132
Iteration 11, inertia 58303066.266950816
Iteration 12, inertia 58290492.57605825
Iteration 13, inertia 58280601.572363
Iteration 14, inertia 58272835.806769006
Iteration 15, inertia 58265006.27076852
Iteration 16, inertia 58253151.736334726
Iteration 17, inertia 58244253.84913611
Iteration 18, inertia 58237542.00073595
Iteration 19, inertia 58232299.120908365
Iteration 20, inertia 58227859.00048413
Iteration 21, inertia 58221201.52376486
Iteration 22, inertia 58217271.02578333
Iteration 23, inertia 58214729.20520049
Iteration 24, inertia 58210921.836076096
Iteration 25, inertia 58207260.941550694
Iteration 26, inertia 58204726.81055987
Iteration 27, inertia 58202596.87032581
Iteration 28, inertia 58201314.64022659
Iteration 29, inertia 58200262.47747534
Iteration 30, inertia 58198958.98568559
Iteration 31, inertia 58195814.67641664
Iteration 32, inertia 58192600.76192319
Iteration 33, inertia 58191986.73664619
Iteration 34, inertia 58191730.908520386
Iteration 35, inertia 58191561.22056645
Iteration 36, inertia 58191305.42201754
Iteration 37, inertia 58191040.73908615
Iteration 38, inertia 58190869.303742215
Iteration 39, inertia 58190669.576931275
Iteration 40, inertia 58190433.703288786
Iteration 41, inertia 58190245.26398202
Iteration 42, inertia 58189957.19964233
Iteration 43, inertia 58189196.06003857
Iteration 44, inertia 58188565.77041132
Iteration 45, inertia 58188243.710456125
Iteration 46, inertia 58187967.91747356
Iteration 47, inertia 58187717.86145053
Iteration 48, inertia 58187257.27673422
Iteration 49, inertia 58186476.06520374
Iteration 50, inertia 58185849.19170831
Iteration 51, inertia 58185336.62079716
Iteration 52, inertia 58185207.47676096
Iteration 53, inertia 58185191.45979855
Iteration 54, inertia 58185148.02018462
Iteration 55, inertia 58185129.60548929
Iteration 56, inertia 58185073.315659605
Converged at iteration 56: strict convergence.
Initialization complete
Iteration 0, inertia 94397991.59325837
Iteration 1, inertia 61461730.976240486
Iteration 2, inertia 59558273.64124393
Iteration 3, inertia 58990558.63412348
Iteration 4, inertia 58719685.02913843
Iteration 5, inertia 58574809.15866278
Iteration 6, inertia 58449769.43031916
Iteration 7, inertia 58375529.76808093
Iteration 8, inertia 58319203.45867513
Iteration 9, inertia 58274423.41598641
Iteration 10, inertia 58245329.18103932
Iteration 11, inertia 58222693.346013494
Iteration 12, inertia 58195769.06120467
Iteration 13, inertia 58180076.29530126
Iteration 14, inertia 58167379.96190099
Iteration 15, inertia 58156848.53474946
Iteration 16, inertia 58143005.79632208
Iteration 17, inertia 58135148.05994352
Iteration 18, inertia 58126361.26717368
Iteration 19, inertia 58119595.87978108
Iteration 20, inertia 58113858.09263264
Iteration 21, inertia 58108556.60588454
Iteration 22, inertia 58100315.34010689
Iteration 23, inertia 58091552.83483034
Iteration 24, inertia 58083263.102474555
Iteration 25, inertia 58074801.76899531
Iteration 26, inertia 58066846.17252721
Iteration 27, inertia 58062442.414026424
Iteration 28, inertia 58057697.25295231
Iteration 29, inertia 58053297.09090866
Iteration 30, inertia 58048489.90087475
Iteration 31, inertia 58038822.35763681
Iteration 32, inertia 58033103.21358761
Iteration 33, inertia 58029847.05802943
Iteration 34, inertia 58027344.376301296
Iteration 35, inertia 58024914.59571544
Iteration 36, inertia 58023888.93186948
Iteration 37, inertia 58023003.192679815
Iteration 38, inertia 58021932.23401858
Iteration 39, inertia 58020903.89533589
Iteration 40, inertia 58020198.206841335
Iteration 41, inertia 58019963.8200235
Iteration 42, inertia 58019940.56821727
Iteration 43, inertia 58019925.71894449
Iteration 44, inertia 58019907.593182154
Iteration 45, inertia 58019888.855085924
Iteration 46, inertia 58019886.09702359
Iteration 47, inertia 58019885.237458944
Iteration 48, inertia 58019884.18288062
Iteration 49, inertia 58019883.66535072
Iteration 50, inertia 58019883.36763743
Converged at iteration 50: strict convergence.
Initialization complete
Iteration 0, inertia 94413213.67965849
Iteration 1, inertia 61637761.99824201
Iteration 2, inertia 59726300.52879867
Iteration 3, inertia 59078867.49534172
Iteration 4, inertia 58767331.80571272
Iteration 5, inertia 58593890.79487125
Iteration 6, inertia 58465805.65157043
Iteration 7, inertia 58395320.37858647
Iteration 8, inertia 58344014.8150133
Iteration 9, inertia 58294943.20597612
Iteration 10, inertia 58267171.07905751
Iteration 11, inertia 58243447.83104691
Iteration 12, inertia 58224731.101500444
Iteration 13, inertia 58213747.64542245
Iteration 14, inertia 58206529.170604534
Iteration 15, inertia 58196699.21459856
Iteration 16, inertia 58191732.95652031
Iteration 17, inertia 58187933.41273032
Iteration 18, inertia 58183445.95590559
Iteration 19, inertia 58179743.92347178
Iteration 20, inertia 58176245.80116319
Iteration 21, inertia 58174623.58530275
Iteration 22, inertia 58173482.46520305
Iteration 23, inertia 58172575.353297666
Iteration 24, inertia 58171788.94427169
Iteration 25, inertia 58171427.677735604
Iteration 26, inertia 58171321.72242039
Iteration 27, inertia 58170980.15755166
Iteration 28, inertia 58170509.978610486
Iteration 29, inertia 58169718.48472103
Iteration 30, inertia 58168783.38313181
Iteration 31, inertia 58167755.16604824
Iteration 32, inertia 58167120.36613171
Iteration 33, inertia 58166493.3444326
Iteration 34, inertia 58166135.9637039
Iteration 35, inertia 58165716.73222135
Iteration 36, inertia 58165457.01060141
Iteration 37, inertia 58165262.04063798
Iteration 38, inertia 58165096.28300595
Iteration 39, inertia 58165052.642105505
Iteration 40, inertia 58164985.525792345
Iteration 41, inertia 58164914.76453251
Iteration 42, inertia 58164878.82883639
Iteration 43, inertia 58164857.27645654
Iteration 44, inertia 58164838.59673334
Iteration 45, inertia 58164825.35947357
Iteration 46, inertia 58164816.23436337
Iteration 47, inertia 58164815.46065975
Converged at iteration 47: center shift 0.0002625709914274343 within tolerance 0.0002814473066046553.
Initialization complete
Iteration 0, inertia 93730698.62388235
Iteration 1, inertia 61356245.24498868
Iteration 2, inertia 59575288.956216976
Iteration 3, inertia 58989287.73760723
Iteration 4, inertia 58680761.22971665
Iteration 5, inertia 58519451.331343114
Iteration 6, inertia 58418991.81997016
Iteration 7, inertia 58359506.397986166
Iteration 8, inertia 58304776.2755273
Iteration 9, inertia 58259132.50563403
Iteration 10, inertia 58205766.64667887
Iteration 11, inertia 58175960.30204758
Iteration 12, inertia 58162638.268580414
Iteration 13, inertia 58153103.45741864
Iteration 14, inertia 58144420.59311177
Iteration 15, inertia 58139489.07609343
Iteration 16, inertia 58136983.401908696
Iteration 17, inertia 58135483.26609019
Iteration 18, inertia 58134201.28726122
Iteration 19, inertia 58133014.78988659
Iteration 20, inertia 58132225.86148396
Iteration 21, inertia 58131401.21592459
Iteration 22, inertia 58130882.19932574
Iteration 23, inertia 58130659.334508285
Iteration 24, inertia 58130555.79050073
Iteration 25, inertia 58130481.64812593
Iteration 26, inertia 58130447.360936925
Iteration 27, inertia 58130422.01081845
Iteration 28, inertia 58130405.06356657
Converged at iteration 28: strict convergence.
Initialization complete
Iteration 0, inertia 94463486.7401932
Iteration 1, inertia 61515483.65033359
Iteration 2, inertia 59548340.25278347
Iteration 3, inertia 58961866.85432191
Iteration 4, inertia 58685823.938498445
Iteration 5, inertia 58517132.028594874
Iteration 6, inertia 58408398.814454824
Iteration 7, inertia 58336464.67956994
Iteration 8, inertia 58291014.09960864
Iteration 9, inertia 58258231.233664475
Iteration 10, inertia 58238164.48428889
Iteration 11, inertia 58222207.72356032
Iteration 12, inertia 58203030.47610678
Iteration 13, inertia 58190521.664217025
Iteration 14, inertia 58181152.95631909
Iteration 15, inertia 58176239.736465335
Iteration 16, inertia 58172721.74922927
Iteration 17, inertia 58171115.43423739
Iteration 18, inertia 58169625.99822752
Iteration 19, inertia 58168484.738819145
Iteration 20, inertia 58167711.357910246
Iteration 21, inertia 58167242.89706992
Iteration 22, inertia 58166361.876451604
Iteration 23, inertia 58165185.03278085
Iteration 24, inertia 58164370.53591416
Iteration 25, inertia 58163080.366458036
Iteration 26, inertia 58161516.43143507
Iteration 27, inertia 58159635.12319139
Iteration 28, inertia 58158985.76009282
Iteration 29, inertia 58158440.510923915
Iteration 30, inertia 58157866.693065375
Iteration 31, inertia 58157385.02779418
Iteration 32, inertia 58157203.83205415
Iteration 33, inertia 58157114.983827055
Iteration 34, inertia 58157099.000679836
Iteration 35, inertia 58157084.34328078
Iteration 36, inertia 58157040.75102809
Iteration 37, inertia 58156967.96139628
Iteration 38, inertia 58156854.28430219
Iteration 39, inertia 58156759.38744153
Iteration 40, inertia 58156608.36997034
Iteration 41, inertia 58156479.183379464
Iteration 42, inertia 58156335.437747255
Iteration 43, inertia 58156115.43676256
Iteration 44, inertia 58155888.86050494
Iteration 45, inertia 58155672.928811185
Iteration 46, inertia 58155494.71400607
Iteration 47, inertia 58155391.686633006
Iteration 48, inertia 58155345.27383187
Iteration 49, inertia 58155310.87536933
Iteration 50, inertia 58155276.11789655
Iteration 51, inertia 58155219.87975864
Iteration 52, inertia 58155185.87549601
Iteration 53, inertia 58155145.449161254
Iteration 54, inertia 58155110.793879054
Iteration 55, inertia 58155095.05419433
Iteration 56, inertia 58155079.62622745
Iteration 57, inertia 58155057.88297135
Iteration 58, inertia 58155037.51173675
Iteration 59, inertia 58155024.67077151
Iteration 60, inertia 58155015.12935897
Iteration 61, inertia 58155004.13902228
Iteration 62, inertia 58154994.00431382
Iteration 63, inertia 58154979.73371649
Iteration 64, inertia 58154970.83311005
Iteration 65, inertia 58154964.123201266
Iteration 66, inertia 58154951.97473938
Iteration 67, inertia 58154940.85167171
Iteration 68, inertia 58154938.61708598
Iteration 69, inertia 58154936.72382223
Iteration 70, inertia 58154930.45867699
Iteration 71, inertia 58154926.09144371
Iteration 72, inertia 58154925.32352633
Iteration 73, inertia 58154924.47218876
Iteration 74, inertia 58154924.19576267
Converged at iteration 74: strict convergence.
Initialization complete
Iteration 0, inertia 94415854.75606997
Iteration 1, inertia 61714777.44451557
Iteration 2, inertia 59810138.463032305
Iteration 3, inertia 59193753.45465252
Iteration 4, inertia 58885651.49329311
Iteration 5, inertia 58704651.45868774
Iteration 6, inertia 58576023.69234401
Iteration 7, inertia 58491006.28471657
Iteration 8, inertia 58431835.4362169
Iteration 9, inertia 58392561.7710267
Iteration 10, inertia 58362896.41211286
Iteration 11, inertia 58347212.913313165
Iteration 12, inertia 58328856.22656789
Iteration 13, inertia 58311004.04216486
Iteration 14, inertia 58282830.89960548
Iteration 15, inertia 58270861.93709763
Iteration 16, inertia 58264834.16045937
Iteration 17, inertia 58259043.021847
Iteration 18, inertia 58254415.28124557
Iteration 19, inertia 58249295.58831051
Iteration 20, inertia 58242395.322294265
Iteration 21, inertia 58235866.13247063
Iteration 22, inertia 58233910.2322515
Iteration 23, inertia 58232381.67632276
Iteration 24, inertia 58230495.84389503
Iteration 25, inertia 58229706.45934193
Iteration 26, inertia 58229207.30565648
Iteration 27, inertia 58228783.55041037
Iteration 28, inertia 58227686.47173768
Iteration 29, inertia 58227263.52534558
Iteration 30, inertia 58227128.6765439
Iteration 31, inertia 58227097.95837845
Converged at iteration 31: strict convergence.
Initialization complete
Iteration 0, inertia 93802341.9798703
Iteration 1, inertia 61230366.19813248
Iteration 2, inertia 59360227.63024315
Iteration 3, inertia 58830957.670590155
Iteration 4, inertia 58581478.0527837
Iteration 5, inertia 58415096.55921256
Iteration 6, inertia 58320594.24855314
Iteration 7, inertia 58252078.41309199
Iteration 8, inertia 58202296.74966232
Iteration 9, inertia 58163064.610710725
Iteration 10, inertia 58136683.97105781
Iteration 11, inertia 58118274.029821075
Iteration 12, inertia 58096951.07624005
Iteration 13, inertia 58079826.55636155
Iteration 14, inertia 58066510.6691167
Iteration 15, inertia 58056129.36832554
Iteration 16, inertia 58046951.464059
Iteration 17, inertia 58040396.77011345
Iteration 18, inertia 58035927.17547164
Iteration 19, inertia 58031652.039366856
Iteration 20, inertia 58028271.2715052
Iteration 21, inertia 58026691.25391507
Iteration 22, inertia 58024811.608878866
Iteration 23, inertia 58023057.19591896
Iteration 24, inertia 58020616.3077694
Iteration 25, inertia 58013765.6942672
Iteration 26, inertia 58008277.77484794
Iteration 27, inertia 58006737.70526142
Iteration 28, inertia 58006289.39768487
Iteration 29, inertia 58006109.11591855
Iteration 30, inertia 58006056.54491167
Converged at iteration 30: strict convergence.
Filename: code/create_kmeans_clustering.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    10    551.2 MiB    551.2 MiB           1   @profile
    11                                         def kmeans_cluster(P, V, K, output_path, prefix, ref=''):
    12                                             """
    13                                             Uses the point.npy P, vocab.npy V files of a layer (generated using https://github.com/hsajjad/ConceptX/ library) to produce a clustering of <K> clusters at <output_path> named clusters-kmeans-{K}.txt
    14                                             """
    15    551.2 MiB      0.0 MiB           1       kmeans = KMeans(n_clusters=K, verbose=3, random_state=212)
    16    717.2 MiB    165.9 MiB           1       output = kmeans.fit(P)
    17                                             
    18    717.2 MiB      0.0 MiB           1       out_file =  f"{output_path}/{prefix}-clusters-kmeans-{K}{ref}.txt"
    19                                         
    20    717.2 MiB      0.0 MiB        1003       clusters = {i:[] for i in range(K)}
    21                                             
    22    723.2 MiB      1.0 MiB       72899       for v, l in zip(V, output.labels_):
    23    723.2 MiB      5.0 MiB       72898          clusters[l].append(f'{v}|||{l}')
    24                                         
    25                                         
    26    723.2 MiB      0.0 MiB           1       out = ""
    27    723.2 MiB      0.0 MiB        1001       for k,v in clusters.items():
    28    723.2 MiB      0.0 MiB        1000           out += '\n'.join(v) + '\n'
    29                                         
    30                                             
    31    723.2 MiB      0.0 MiB           1       with open(out_file, 'w') as f2:
    32    723.2 MiB      0.0 MiB           1           f2.write(out)
    33                                         
    34    723.2 MiB      0.0 MiB           1       return out


Runtime: 1018.2724184989929
USAGE: create_kmeans_clustering.py -p <POINT_FILE> -v <VOCAB_FILE> -k <CLUSTERS> -o <OUTPUT_FOLDER>
Initialization complete
Iteration 0, inertia 104991341.85064001
Iteration 1, inertia 71497056.34973396
Iteration 2, inertia 69696254.89168437
Iteration 3, inertia 69068893.12832795
Iteration 4, inertia 68697046.70209886
Iteration 5, inertia 68436909.81013453
Iteration 6, inertia 68263948.56158711
Iteration 7, inertia 68144988.64287634
Iteration 8, inertia 68049838.61465235
Iteration 9, inertia 67984061.07571955
Iteration 10, inertia 67935892.37399161
Iteration 11, inertia 67898494.54461324
Iteration 12, inertia 67864722.51982638
Iteration 13, inertia 67842863.54806656
Iteration 14, inertia 67826437.43690291
Iteration 15, inertia 67811856.24789205
Iteration 16, inertia 67796393.34287071
Iteration 17, inertia 67781310.26174806
Iteration 18, inertia 67770467.84999701
Iteration 19, inertia 67760584.25614847
Iteration 20, inertia 67752663.81248815
Iteration 21, inertia 67745469.69995584
Iteration 22, inertia 67735373.88636412
Iteration 23, inertia 67724253.89477852
Iteration 24, inertia 67713994.37725344
Iteration 25, inertia 67706930.00947475
Iteration 26, inertia 67702401.59035769
Iteration 27, inertia 67699628.81431627
Iteration 28, inertia 67697329.25070548
Iteration 29, inertia 67694770.51197545
Iteration 30, inertia 67692552.91776542
Iteration 31, inertia 67690899.85650177
Iteration 32, inertia 67689602.59959233
Iteration 33, inertia 67688342.0887861
Iteration 34, inertia 67687211.05017436
Iteration 35, inertia 67685797.79728684
Iteration 36, inertia 67684265.18163805
Iteration 37, inertia 67682455.87187046
Iteration 38, inertia 67681105.89195219
Iteration 39, inertia 67680016.54062672
Iteration 40, inertia 67678824.58996776
Iteration 41, inertia 67676680.2729625
Iteration 42, inertia 67675287.58287476
Iteration 43, inertia 67674496.49124037
Iteration 44, inertia 67673987.42671321
Iteration 45, inertia 67673102.6717284
Iteration 46, inertia 67672702.31153508
Iteration 47, inertia 67672437.84897994
Converged at iteration 47: strict convergence.
Initialization complete
Iteration 0, inertia 104810243.83522338
Iteration 1, inertia 71384626.52638607
Iteration 2, inertia 69567309.04914616
Iteration 3, inertia 68909711.33701971
Iteration 4, inertia 68577144.11375117
Iteration 5, inertia 68355711.72921354
Iteration 6, inertia 68209984.55636658
Iteration 7, inertia 68103454.06070906
Iteration 8, inertia 68022618.79150482
Iteration 9, inertia 67948166.35769467
Iteration 10, inertia 67889319.2135589
Iteration 11, inertia 67847886.96620314
Iteration 12, inertia 67819536.72914496
Iteration 13, inertia 67795674.77420573
Iteration 14, inertia 67778418.4251522
Iteration 15, inertia 67765526.22084244
Iteration 16, inertia 67754493.4967067
Iteration 17, inertia 67744875.4851895
Iteration 18, inertia 67734210.54004999
Iteration 19, inertia 67726126.46016155
Iteration 20, inertia 67719114.134081
Iteration 21, inertia 67713654.16886845
Iteration 22, inertia 67708825.14250408
Iteration 23, inertia 67704769.47167878
Iteration 24, inertia 67700082.52486444
Iteration 25, inertia 67695839.8645008
Iteration 26, inertia 67692826.48099497
Iteration 27, inertia 67690769.36851671
Iteration 28, inertia 67689270.777003
Iteration 29, inertia 67687561.33923973
Iteration 30, inertia 67685233.12267262
Iteration 31, inertia 67682936.68578185
Iteration 32, inertia 67680583.24630159
Iteration 33, inertia 67679779.74054602
Iteration 34, inertia 67679386.67416604
Iteration 35, inertia 67679232.36924309
Iteration 36, inertia 67679215.05669081
Iteration 37, inertia 67679211.27453591
Converged at iteration 37: strict convergence.
Initialization complete
Iteration 0, inertia 104487148.98006809
Iteration 1, inertia 71305857.57938714
Iteration 2, inertia 69530589.08483188
Iteration 3, inertia 68916657.4131738
Iteration 4, inertia 68586108.45858964
Iteration 5, inertia 68372285.4787035
Iteration 6, inertia 68224783.34724009
Iteration 7, inertia 68118983.50198384
Iteration 8, inertia 68038088.93079646
Iteration 9, inertia 67979642.12395817
Iteration 10, inertia 67933045.15301763
Iteration 11, inertia 67900689.08383824
Iteration 12, inertia 67877135.09878923
Iteration 13, inertia 67857754.12003084
Iteration 14, inertia 67839188.7139681
Iteration 15, inertia 67822503.05500555
Iteration 16, inertia 67808417.11571227
Iteration 17, inertia 67795551.89871457
Iteration 18, inertia 67784917.753734
Iteration 19, inertia 67777162.8653495
Iteration 20, inertia 67769837.6165193
Iteration 21, inertia 67764370.91305706
Iteration 22, inertia 67759625.49965179
Iteration 23, inertia 67755561.02241987
Iteration 24, inertia 67751550.78286682
Iteration 25, inertia 67746549.79652292
Iteration 26, inertia 67741453.63497351
Iteration 27, inertia 67735233.01801302
Iteration 28, inertia 67730501.3254376
Iteration 29, inertia 67726543.6471936
Iteration 30, inertia 67723148.2587237
Iteration 31, inertia 67720377.78590883
Iteration 32, inertia 67718148.14994442
Iteration 33, inertia 67716307.00867932
Iteration 34, inertia 67714858.77368703
Iteration 35, inertia 67713134.48700322
Iteration 36, inertia 67712322.63350588
Iteration 37, inertia 67711281.34930879
Iteration 38, inertia 67710392.67007269
Iteration 39, inertia 67709732.66317338
Iteration 40, inertia 67709526.40012854
Iteration 41, inertia 67709440.65513703
Iteration 42, inertia 67709292.32300499
Iteration 43, inertia 67708996.73069681
Iteration 44, inertia 67708764.10948217
Iteration 45, inertia 67708559.63947648
Iteration 46, inertia 67708496.04491468
Iteration 47, inertia 67708475.72892481
Iteration 48, inertia 67708448.86257534
Iteration 49, inertia 67708425.93960813
Iteration 50, inertia 67708402.68528901
Iteration 51, inertia 67708379.55122828
Converged at iteration 51: strict convergence.
Initialization complete
Iteration 0, inertia 104878887.21582475
Iteration 1, inertia 71468119.55975296
Iteration 2, inertia 69644644.10042098
Iteration 3, inertia 68983545.91510226
Iteration 4, inertia 68638265.6118533
Iteration 5, inertia 68426595.92270356
Iteration 6, inertia 68274146.24179998
Iteration 7, inertia 68167309.10887125
Iteration 8, inertia 68082887.47059323
Iteration 9, inertia 68017921.48471409
Iteration 10, inertia 67972247.89207284
Iteration 11, inertia 67940282.17188571
Iteration 12, inertia 67916233.64623882
Iteration 13, inertia 67900698.44604798
Iteration 14, inertia 67887082.89683719
Iteration 15, inertia 67876351.29086684
Iteration 16, inertia 67866684.60696338
Iteration 17, inertia 67857221.65682735
Iteration 18, inertia 67848388.42827064
Iteration 19, inertia 67842125.01545349
Iteration 20, inertia 67836370.83593255
Iteration 21, inertia 67830406.80271296
Iteration 22, inertia 67824160.77420089
Iteration 23, inertia 67818869.7530734
Iteration 24, inertia 67814820.61731903
Iteration 25, inertia 67809338.17226811
Iteration 26, inertia 67804434.23076648
Iteration 27, inertia 67800024.7838424
Iteration 28, inertia 67796533.23457032
Iteration 29, inertia 67793587.55499122
Iteration 30, inertia 67790850.88919374
Iteration 31, inertia 67787633.38638791
Iteration 32, inertia 67784841.37541157
Iteration 33, inertia 67782942.77447194
Iteration 34, inertia 67781114.1943111
Iteration 35, inertia 67779010.8699231
Iteration 36, inertia 67776554.46264347
Iteration 37, inertia 67774819.42728357
Iteration 38, inertia 67773527.89837028
Iteration 39, inertia 67772454.73640347
Iteration 40, inertia 67771738.6013929
Iteration 41, inertia 67771441.07069884
Iteration 42, inertia 67771283.7853092
Iteration 43, inertia 67771102.22938316
Iteration 44, inertia 67770929.13496928
Iteration 45, inertia 67770842.80372195
Iteration 46, inertia 67770750.63913524
Iteration 47, inertia 67770672.4417136
Iteration 48, inertia 67770575.46242788
Iteration 49, inertia 67770554.85313767
Converged at iteration 49: strict convergence.
Initialization complete
Iteration 0, inertia 104925475.31106354
Iteration 1, inertia 71406912.10136493
Iteration 2, inertia 69610905.75180449
Iteration 3, inertia 68972434.16181923
Iteration 4, inertia 68633223.0365866
Iteration 5, inertia 68433695.88301407
Iteration 6, inertia 68301665.43619636
Iteration 7, inertia 68209168.2085038
Iteration 8, inertia 68139658.70568813
Iteration 9, inertia 68084742.5603564
Iteration 10, inertia 68037817.50364877
Iteration 11, inertia 68003075.38050488
Iteration 12, inertia 67974563.2985245
Iteration 13, inertia 67949559.0336487
Iteration 14, inertia 67926416.65687619
Iteration 15, inertia 67907320.28404349
Iteration 16, inertia 67892124.89907147
Iteration 17, inertia 67880494.76086317
Iteration 18, inertia 67869429.95989326
Iteration 19, inertia 67856867.89171258
Iteration 20, inertia 67847372.409055
Iteration 21, inertia 67840103.31047504
Iteration 22, inertia 67833700.49289295
Iteration 23, inertia 67827746.70057973
Iteration 24, inertia 67823538.91856088
Iteration 25, inertia 67819337.69528402
Iteration 26, inertia 67815949.26902394
Iteration 27, inertia 67812553.80220634
Iteration 28, inertia 67809625.83013937
Iteration 29, inertia 67806853.07183978
Iteration 30, inertia 67804414.52742638
Iteration 31, inertia 67802657.61689438
Iteration 32, inertia 67801101.1777901
Iteration 33, inertia 67799773.58150011
Iteration 34, inertia 67798907.8986688
Iteration 35, inertia 67798247.17934425
Iteration 36, inertia 67797901.48153944
Iteration 37, inertia 67797225.6608768
Iteration 38, inertia 67796885.62889919
Iteration 39, inertia 67796424.35529129
Iteration 40, inertia 67795699.76553509
Iteration 41, inertia 67795411.55409154
Iteration 42, inertia 67795293.28973834
Iteration 43, inertia 67794796.54233345
Iteration 44, inertia 67794050.9264649
Iteration 45, inertia 67793571.31402396
Iteration 46, inertia 67793283.08679515
Iteration 47, inertia 67792856.17939347
Iteration 48, inertia 67792539.1544541
Iteration 49, inertia 67792388.15197712
Iteration 50, inertia 67792240.00055455
Iteration 51, inertia 67792118.26197669
Iteration 52, inertia 67792088.51702936
Iteration 53, inertia 67792032.30000718
Iteration 54, inertia 67792001.17917734
Converged at iteration 54: strict convergence.
Initialization complete
Iteration 0, inertia 104616995.59287122
Iteration 1, inertia 71420491.5832352
Iteration 2, inertia 69632204.75339764
Iteration 3, inertia 68990307.79381627
Iteration 4, inertia 68625000.4776452
Iteration 5, inertia 68407685.05375876
Iteration 6, inertia 68263886.90219085
Iteration 7, inertia 68165023.70539467
Iteration 8, inertia 68092827.45164047
Iteration 9, inertia 68041447.3874096
Iteration 10, inertia 68004939.45196816
Iteration 11, inertia 67974472.82134412
Iteration 12, inertia 67947866.0773417
Iteration 13, inertia 67930725.28517318
Iteration 14, inertia 67916244.78639628
Iteration 15, inertia 67904065.64953467
Iteration 16, inertia 67892660.24773648
Iteration 17, inertia 67883836.37135987
Iteration 18, inertia 67876150.59217589
Iteration 19, inertia 67870651.43715234
Iteration 20, inertia 67864838.04486197
Iteration 21, inertia 67859430.8822207
Iteration 22, inertia 67854126.79106426
Iteration 23, inertia 67849964.98701751
Iteration 24, inertia 67846556.92087992
Iteration 25, inertia 67844256.59517615
Iteration 26, inertia 67842179.1181993
Iteration 27, inertia 67839732.59774682
Iteration 28, inertia 67837512.17557122
Iteration 29, inertia 67835707.83935702
Iteration 30, inertia 67834059.28601472
Iteration 31, inertia 67832810.69317012
Iteration 32, inertia 67831159.74238013
Iteration 33, inertia 67829359.3083038
Iteration 34, inertia 67827667.2832112
Iteration 35, inertia 67826491.45635854
Iteration 36, inertia 67825717.36141853
Iteration 37, inertia 67825247.55706967
Iteration 38, inertia 67824680.4407931
Iteration 39, inertia 67824168.12269358
Iteration 40, inertia 67823756.08026241
Iteration 41, inertia 67823023.54894641
Iteration 42, inertia 67822125.87085822
Iteration 43, inertia 67821456.02915217
Iteration 44, inertia 67820530.32852799
Iteration 45, inertia 67819627.75284915
Iteration 46, inertia 67818838.09472728
Iteration 47, inertia 67817480.99799417
Iteration 48, inertia 67816332.3661629
Iteration 49, inertia 67815464.47963962
Iteration 50, inertia 67814664.87993585
Iteration 51, inertia 67814108.48272586
Iteration 52, inertia 67813557.47046915
Iteration 53, inertia 67813050.80714017
Iteration 54, inertia 67812558.97093578
Iteration 55, inertia 67812144.91829304
Iteration 56, inertia 67811882.05431922
Iteration 57, inertia 67811436.86915156
Iteration 58, inertia 67811003.89164066
Iteration 59, inertia 67810364.63246936
Iteration 60, inertia 67810079.47751462
Iteration 61, inertia 67809961.26426136
Iteration 62, inertia 67809937.17266649
Iteration 63, inertia 67809934.4437866
Converged at iteration 63: strict convergence.
Initialization complete
Iteration 0, inertia 104904910.53669769
Iteration 1, inertia 71332344.50674452
Iteration 2, inertia 69622640.37833868
Iteration 3, inertia 68995728.62925625
Iteration 4, inertia 68672168.51219569
Iteration 5, inertia 68459974.46307462
Iteration 6, inertia 68310675.93878789
Iteration 7, inertia 68201964.12648706
Iteration 8, inertia 68128701.64451097
Iteration 9, inertia 68068950.78430569
Iteration 10, inertia 68015654.75735258
Iteration 11, inertia 67971154.55267908
Iteration 12, inertia 67929311.47805357
Iteration 13, inertia 67895209.01878124
Iteration 14, inertia 67874210.36325955
Iteration 15, inertia 67858878.89221263
Iteration 16, inertia 67847065.083968
Iteration 17, inertia 67834294.88303523
Iteration 18, inertia 67821869.51488185
Iteration 19, inertia 67813113.56823504
Iteration 20, inertia 67806006.5264971
Iteration 21, inertia 67799349.64062972
Iteration 22, inertia 67793642.55818126
Iteration 23, inertia 67787974.80235878
Iteration 24, inertia 67783968.08744974
Iteration 25, inertia 67779722.95462124
Iteration 26, inertia 67774486.65132564
Iteration 27, inertia 67771104.46673639
Iteration 28, inertia 67767966.21486974
Iteration 29, inertia 67764990.87293017
Iteration 30, inertia 67763090.25546762
Iteration 31, inertia 67762058.74965256
Iteration 32, inertia 67761001.47034286
Iteration 33, inertia 67759981.40503405
Iteration 34, inertia 67758805.33184884
Iteration 35, inertia 67756915.78483084
Iteration 36, inertia 67756145.60893852
Iteration 37, inertia 67755513.54696919
Iteration 38, inertia 67754473.18095313
Iteration 39, inertia 67752898.95347625
Iteration 40, inertia 67751009.2810065
Iteration 41, inertia 67750768.94727243
Iteration 42, inertia 67750746.07471326
Converged at iteration 42: strict convergence.
Initialization complete
Iteration 0, inertia 104847184.01390536
Iteration 1, inertia 71490105.71170877
Iteration 2, inertia 69720941.66623908
Iteration 3, inertia 69063057.76521328
Iteration 4, inertia 68698209.99852605
Iteration 5, inertia 68472186.43796405
Iteration 6, inertia 68308314.83621483
Iteration 7, inertia 68187237.1193175
Iteration 8, inertia 68103288.10745655
Iteration 9, inertia 68048442.7154373
Iteration 10, inertia 68001736.54691409
Iteration 11, inertia 67962052.81596358
Iteration 12, inertia 67927093.44242276
Iteration 13, inertia 67891111.34655283
Iteration 14, inertia 67864058.28980249
Iteration 15, inertia 67838968.54823078
Iteration 16, inertia 67816211.00891553
Iteration 17, inertia 67798625.54856607
Iteration 18, inertia 67784941.87500276
Iteration 19, inertia 67772462.49365766
Iteration 20, inertia 67760654.40015844
Iteration 21, inertia 67747597.97736265
Iteration 22, inertia 67735975.14707412
Iteration 23, inertia 67729196.84181082
Iteration 24, inertia 67723015.93890464
Iteration 25, inertia 67719725.76546903
Iteration 26, inertia 67717768.4963225
Iteration 27, inertia 67716365.29579696
Iteration 28, inertia 67714101.35018128
Iteration 29, inertia 67712861.85199253
Iteration 30, inertia 67711733.72369036
Iteration 31, inertia 67710670.10804209
Iteration 32, inertia 67709215.69856879
Iteration 33, inertia 67707837.3962988
Iteration 34, inertia 67707202.31987359
Iteration 35, inertia 67706817.57416889
Iteration 36, inertia 67706447.71281496
Iteration 37, inertia 67706199.32263424
Iteration 38, inertia 67705902.38337678
Iteration 39, inertia 67705554.92665346
Iteration 40, inertia 67705394.3453075
Iteration 41, inertia 67705193.04377188
Iteration 42, inertia 67705114.4325019
Iteration 43, inertia 67705033.59336682
Iteration 44, inertia 67704972.83994992
Iteration 45, inertia 67704873.69944285
Iteration 46, inertia 67704705.52202573
Iteration 47, inertia 67704573.82040086
Iteration 48, inertia 67704459.6789092
Iteration 49, inertia 67704327.73014218
Iteration 50, inertia 67704156.3207231
Iteration 51, inertia 67704060.24341683
Iteration 52, inertia 67703999.74015656
Iteration 53, inertia 67703976.48811509
Iteration 54, inertia 67703942.61900619
Iteration 55, inertia 67703918.14461729
Iteration 56, inertia 67703868.99125847
Iteration 57, inertia 67703836.70881149
Iteration 58, inertia 67703816.50951225
Iteration 59, inertia 67703782.7228234
Iteration 60, inertia 67703760.29853629
Iteration 61, inertia 67703732.70773855
Iteration 62, inertia 67703724.68563458
Iteration 63, inertia 67703704.63139814
Iteration 64, inertia 67703677.58113708
Iteration 65, inertia 67703662.8614502
Iteration 66, inertia 67703658.02396342
Iteration 67, inertia 67703655.0221089
Converged at iteration 67: strict convergence.
Initialization complete
Iteration 0, inertia 105024917.96291892
Iteration 1, inertia 71389642.13515054
Iteration 2, inertia 69608241.1831055
Iteration 3, inertia 68974604.05229457
Iteration 4, inertia 68629220.36692344
Iteration 5, inertia 68422849.8099496
Iteration 6, inertia 68292251.74589755
Iteration 7, inertia 68189570.51036258
Iteration 8, inertia 68104871.85643266
Iteration 9, inertia 68032653.7783214
Iteration 10, inertia 67980332.12694862
Iteration 11, inertia 67943582.99058649
Iteration 12, inertia 67913688.84421061
Iteration 13, inertia 67891910.59222507
Iteration 14, inertia 67871078.50360821
Iteration 15, inertia 67853495.83227059
Iteration 16, inertia 67838379.63678996
Iteration 17, inertia 67825370.8642793
Iteration 18, inertia 67813453.06956317
Iteration 19, inertia 67803022.33412994
Iteration 20, inertia 67795444.04139245
Iteration 21, inertia 67790150.48916392
Iteration 22, inertia 67785000.92881042
Iteration 23, inertia 67780752.93650848
Iteration 24, inertia 67777006.17596589
Iteration 25, inertia 67772882.33973847
Iteration 26, inertia 67768176.80787626
Iteration 27, inertia 67764332.1108082
Iteration 28, inertia 67761528.77964085
Iteration 29, inertia 67759231.05059217
Iteration 30, inertia 67757909.79384227
Iteration 31, inertia 67756437.18796879
Iteration 32, inertia 67755323.95921813
Iteration 33, inertia 67754261.31500295
Iteration 34, inertia 67752787.10939315
Iteration 35, inertia 67751938.24006759
Iteration 36, inertia 67750857.11506763
Iteration 37, inertia 67750144.8116572
Iteration 38, inertia 67749695.72181457
Iteration 39, inertia 67749412.15025568
Iteration 40, inertia 67749407.19584262
Iteration 41, inertia 67749404.28774793
Iteration 42, inertia 67749393.9873623
Iteration 43, inertia 67749390.24259342
Converged at iteration 43: strict convergence.
Initialization complete
Iteration 0, inertia 104968507.10857473
Iteration 1, inertia 71405162.73306523
Iteration 2, inertia 69620632.57705468
Iteration 3, inertia 68987138.96157543
Iteration 4, inertia 68642359.53627765
Iteration 5, inertia 68424386.7351554
Iteration 6, inertia 68271609.78426984
Iteration 7, inertia 68161571.68439692
Iteration 8, inertia 68071249.17092104
Iteration 9, inertia 67998586.40731564
Iteration 10, inertia 67943863.14220692
Iteration 11, inertia 67903179.16740175
Iteration 12, inertia 67872982.53463364
Iteration 13, inertia 67849590.29535331
Iteration 14, inertia 67829678.6204153
Iteration 15, inertia 67810199.7243501
Iteration 16, inertia 67795578.69900678
Iteration 17, inertia 67783388.79676251
Iteration 18, inertia 67773686.34527566
Iteration 19, inertia 67766258.63941711
Iteration 20, inertia 67758756.07939255
Iteration 21, inertia 67752767.608626
Iteration 22, inertia 67749085.6366844
Iteration 23, inertia 67745211.87586257
Iteration 24, inertia 67742803.47209696
Iteration 25, inertia 67740911.67921212
Iteration 26, inertia 67739654.60190557
Iteration 27, inertia 67738580.15335037
Iteration 28, inertia 67737978.05813801
Iteration 29, inertia 67737346.27450137
Iteration 30, inertia 67736859.33416684
Iteration 31, inertia 67736394.84506044
Iteration 32, inertia 67736003.16110441
Iteration 33, inertia 67735745.15525389
Iteration 34, inertia 67735457.61579037
Iteration 35, inertia 67735170.19528867
Iteration 36, inertia 67735055.03775991
Iteration 37, inertia 67734991.57084988
Iteration 38, inertia 67734854.21159258
Iteration 39, inertia 67734777.41080397
Iteration 40, inertia 67734762.93244042
Converged at iteration 40: strict convergence.
Filename: code/create_kmeans_clustering.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    10    496.4 MiB    496.4 MiB           1   @profile
    11                                         def kmeans_cluster(P, V, K, output_path, prefix, ref=''):
    12                                             """
    13                                             Uses the point.npy P, vocab.npy V files of a layer (generated using https://github.com/hsajjad/ConceptX/ library) to produce a clustering of <K> clusters at <output_path> named clusters-kmeans-{K}.txt
    14                                             """
    15    496.4 MiB      0.0 MiB           1       kmeans = KMeans(n_clusters=K, verbose=3, random_state=212)
    16    619.2 MiB    122.8 MiB           1       output = kmeans.fit(P)
    17                                             
    18    619.2 MiB      0.0 MiB           1       out_file =  f"{output_path}/{prefix}-clusters-kmeans-{K}{ref}.txt"
    19                                         
    20    619.2 MiB      0.0 MiB        1003       clusters = {i:[] for i in range(K)}
    21                                             
    22    624.2 MiB      2.0 MiB       64043       for v, l in zip(V, output.labels_):
    23    624.2 MiB      3.0 MiB       64042          clusters[l].append(f'{v}|||{l}')
    24                                         
    25                                         
    26    624.2 MiB      0.0 MiB           1       out = ""
    27    636.7 MiB      0.0 MiB        1001       for k,v in clusters.items():
    28    636.7 MiB     12.4 MiB        1000           out += '\n'.join(v) + '\n'
    29                                         
    30                                             
    31    636.7 MiB      0.0 MiB           1       with open(out_file, 'w') as f2:
    32    636.7 MiB      0.0 MiB           1           f2.write(out)
    33                                         
    34    636.7 MiB      0.0 MiB           1       return out


Runtime: 954.5605416297913
Combined output written to: visualize_1000/layer9/clusters-1000.txt

Completed iteration 9.

Running: ./utils_qcri/clustering.sh 1000 10 visualize
Output for iteration 10:
Preparing for visualize
USAGE: create_kmeans_clustering.py -p <POINT_FILE> -v <VOCAB_FILE> -k <CLUSTERS> -o <OUTPUT_FOLDER>
Initialization complete
Iteration 0, inertia 126245522.25751278
Iteration 1, inertia 82784505.91352843
Iteration 2, inertia 80195671.97892366
Iteration 3, inertia 79349004.35213849
Iteration 4, inertia 78955749.78608792
Iteration 5, inertia 78698684.84376319
Iteration 6, inertia 78542938.09917176
Iteration 7, inertia 78446387.95184076
Iteration 8, inertia 78386582.18913709
Iteration 9, inertia 78331880.8158126
Iteration 10, inertia 78281479.61479369
Iteration 11, inertia 78234053.50945401
Iteration 12, inertia 78197122.19110268
Iteration 13, inertia 78183187.55865449
Iteration 14, inertia 78174387.74249816
Iteration 15, inertia 78162889.3870042
Iteration 16, inertia 78154036.94161093
Iteration 17, inertia 78149488.51335259
Iteration 18, inertia 78142661.82282135
Iteration 19, inertia 78133164.42829123
Iteration 20, inertia 78120892.98378359
Iteration 21, inertia 78107485.10001805
Iteration 22, inertia 78100906.3415457
Iteration 23, inertia 78096666.14642194
Iteration 24, inertia 78095104.03757803
Iteration 25, inertia 78093727.59050596
Iteration 26, inertia 78092529.43161291
Iteration 27, inertia 78091004.62992449
Iteration 28, inertia 78089866.04739247
Iteration 29, inertia 78089199.9667173
Iteration 30, inertia 78088827.65085131
Iteration 31, inertia 78088346.15745755
Iteration 32, inertia 78087921.6660145
Iteration 33, inertia 78087052.53380199
Iteration 34, inertia 78085786.77290535
Iteration 35, inertia 78083638.97699217
Iteration 36, inertia 78082467.63216521
Iteration 37, inertia 78081599.28237666
Iteration 38, inertia 78080108.99581054
Iteration 39, inertia 78079401.71840304
Iteration 40, inertia 78078992.03874202
Iteration 41, inertia 78078077.1263506
Iteration 42, inertia 78074843.67207208
Iteration 43, inertia 78070839.03732555
Iteration 44, inertia 78066446.29469056
Iteration 45, inertia 78062579.47753333
Iteration 46, inertia 78054516.54530425
Iteration 47, inertia 78051711.60077658
Iteration 48, inertia 78051539.8684202
Iteration 49, inertia 78051409.16919568
Iteration 50, inertia 78051274.13231425
Iteration 51, inertia 78051214.82765709
Iteration 52, inertia 78051164.19600525
Converged at iteration 52: strict convergence.
Initialization complete
Iteration 0, inertia 126122440.69723086
Iteration 1, inertia 82714342.95887735
Iteration 2, inertia 80117596.46968682
Iteration 3, inertia 79195886.93175492
Iteration 4, inertia 78713604.4564457
Iteration 5, inertia 78436275.14997332
Iteration 6, inertia 78281701.81444207
Iteration 7, inertia 78168770.0006547
Iteration 8, inertia 78073234.61651807
Iteration 9, inertia 78017420.40415125
Iteration 10, inertia 77978811.99441831
Iteration 11, inertia 77948936.89332378
Iteration 12, inertia 77923610.11884934
Iteration 13, inertia 77899655.989847
Iteration 14, inertia 77879998.39641306
Iteration 15, inertia 77863911.4043052
Iteration 16, inertia 77849440.32901414
Iteration 17, inertia 77838715.03574102
Iteration 18, inertia 77829823.22521815
Iteration 19, inertia 77823958.85397194
Iteration 20, inertia 77818015.263512
Iteration 21, inertia 77813394.03836648
Iteration 22, inertia 77810413.70504399
Iteration 23, inertia 77808764.19240057
Iteration 24, inertia 77808088.29843025
Iteration 25, inertia 77807978.04202308
Iteration 26, inertia 77807877.64627016
Iteration 27, inertia 77807849.82397112
Iteration 28, inertia 77807837.23752233
Iteration 29, inertia 77807832.47222933
Iteration 30, inertia 77807831.54904199
Converged at iteration 30: strict convergence.
Initialization complete
Iteration 0, inertia 125792145.17070779
Iteration 1, inertia 82428090.98334892
Iteration 2, inertia 79976301.05590703
Iteration 3, inertia 79114318.69210652
Iteration 4, inertia 78697690.74248222
Iteration 5, inertia 78473614.18791543
Iteration 6, inertia 78317064.44770917
Iteration 7, inertia 78218836.65129186
Iteration 8, inertia 78159433.18494712
Iteration 9, inertia 78114859.04510428
Iteration 10, inertia 78071826.09428194
Iteration 11, inertia 78041739.66208892
Iteration 12, inertia 78025084.13642183
Iteration 13, inertia 78005117.84659955
Iteration 14, inertia 77987904.28682643
Iteration 15, inertia 77973253.93926199
Iteration 16, inertia 77963342.83667448
Iteration 17, inertia 77955084.75177392
Iteration 18, inertia 77941228.33519696
Iteration 19, inertia 77928802.27622339
Iteration 20, inertia 77921429.1462272
Iteration 21, inertia 77917912.86140639
Iteration 22, inertia 77915962.69976982
Iteration 23, inertia 77914681.94692147
Iteration 24, inertia 77914330.65640189
Iteration 25, inertia 77913848.31025305
Iteration 26, inertia 77913249.79739062
Iteration 27, inertia 77911747.82702582
Iteration 28, inertia 77911196.54055434
Iteration 29, inertia 77910578.5795394
Iteration 30, inertia 77910182.17069937
Iteration 31, inertia 77909796.90113224
Iteration 32, inertia 77909511.92631038
Iteration 33, inertia 77909355.18017855
Iteration 34, inertia 77909065.0796338
Iteration 35, inertia 77908890.10418488
Iteration 36, inertia 77908723.22593792
Converged at iteration 36: strict convergence.
Initialization complete
Iteration 0, inertia 126052382.72754964
Iteration 1, inertia 82529075.3626131
Iteration 2, inertia 80078610.57901406
Iteration 3, inertia 79169087.46757062
Iteration 4, inertia 78700706.1955796
Iteration 5, inertia 78432389.55055894
Iteration 6, inertia 78279796.59904146
Iteration 7, inertia 78168406.0366945
Iteration 8, inertia 78082118.1549544
Iteration 9, inertia 78011283.56032299
Iteration 10, inertia 77961104.96993956
Iteration 11, inertia 77932906.73241067
Iteration 12, inertia 77910477.97730787
Iteration 13, inertia 77895248.59534553
Iteration 14, inertia 77884499.17538111
Iteration 15, inertia 77876418.30590773
Iteration 16, inertia 77867131.38116302
Iteration 17, inertia 77857202.79168515
Iteration 18, inertia 77850764.29705441
Iteration 19, inertia 77847034.37554686
Iteration 20, inertia 77844308.06497791
Iteration 21, inertia 77842721.3132749
Iteration 22, inertia 77840719.50309081
Iteration 23, inertia 77839167.82667927
Iteration 24, inertia 77838544.14704002
Iteration 25, inertia 77838102.26979823
Iteration 26, inertia 77837775.0476896
Iteration 27, inertia 77837628.24274185
Iteration 28, inertia 77837569.97149874
Iteration 29, inertia 77837555.38174547
Iteration 30, inertia 77837543.98449789
Iteration 31, inertia 77837536.80809751
Iteration 32, inertia 77837528.19831465
Iteration 33, inertia 77837523.58177082
Iteration 34, inertia 77837520.9107128
Iteration 35, inertia 77837519.74016793
Converged at iteration 35: center shift 0.000178108012980365 within tolerance 0.000405793555144062.
Initialization complete
Iteration 0, inertia 125601106.49856895
Iteration 1, inertia 82381175.92092462
Iteration 2, inertia 79971396.44182815
Iteration 3, inertia 79133728.78536105
Iteration 4, inertia 78706681.79912087
Iteration 5, inertia 78441936.09902054
Iteration 6, inertia 78240383.78684752
Iteration 7, inertia 78077360.53817755
Iteration 8, inertia 77963971.87886246
Iteration 9, inertia 77898679.13794395
Iteration 10, inertia 77849215.47262779
Iteration 11, inertia 77814524.504976
Iteration 12, inertia 77780855.55289884
Iteration 13, inertia 77746795.7822461
Iteration 14, inertia 77722318.59793359
Iteration 15, inertia 77703963.44527048
Iteration 16, inertia 77693569.9216462
Iteration 17, inertia 77683972.65315278
Iteration 18, inertia 77674810.93515521
Iteration 19, inertia 77669192.97887385
Iteration 20, inertia 77666465.48659872
Iteration 21, inertia 77665272.80643842
Iteration 22, inertia 77664102.84112428
Iteration 23, inertia 77662259.67472264
Iteration 24, inertia 77660184.21433769
Iteration 25, inertia 77659237.4059233
Iteration 26, inertia 77658547.64234073
Iteration 27, inertia 77657861.5527658
Iteration 28, inertia 77657282.69253702
Iteration 29, inertia 77657008.86789136
Iteration 30, inertia 77656751.97808665
Iteration 31, inertia 77656505.04282717
Iteration 32, inertia 77656383.2475368
Iteration 33, inertia 77656277.85718295
Iteration 34, inertia 77656157.59435877
Iteration 35, inertia 77656113.02994184
Iteration 36, inertia 77656069.38334437
Iteration 37, inertia 77656039.75190574
Iteration 38, inertia 77656023.2457005
Iteration 39, inertia 77656004.4820276
Iteration 40, inertia 77655986.4280579
Iteration 41, inertia 77655971.59039043
Iteration 42, inertia 77655957.89664432
Iteration 43, inertia 77655941.68724862
Iteration 44, inertia 77655931.22908317
Iteration 45, inertia 77655928.0624686
Iteration 46, inertia 77655927.16935655
Iteration 47, inertia 77655926.54300053
Iteration 48, inertia 77655926.21902317
Converged at iteration 48: center shift 0.000309046188140174 within tolerance 0.000405793555144062.
Initialization complete
Iteration 0, inertia 125627246.9806456
Iteration 1, inertia 82312187.18355228
Iteration 2, inertia 79830659.38709812
Iteration 3, inertia 79056099.05872186
Iteration 4, inertia 78667226.33199994
Iteration 5, inertia 78473785.62679045
Iteration 6, inertia 78334341.59790099
Iteration 7, inertia 78220078.22586407
Iteration 8, inertia 78142213.55369648
Iteration 9, inertia 78100317.0203694
Iteration 10, inertia 78059607.41950198
Iteration 11, inertia 78031994.69660066
Iteration 12, inertia 78006586.08385433
Iteration 13, inertia 77980236.55399145
Iteration 14, inertia 77957238.08768003
Iteration 15, inertia 77936128.1237651
Iteration 16, inertia 77921270.47997084
Iteration 17, inertia 77910137.08997193
Iteration 18, inertia 77899190.73154923
Iteration 19, inertia 77891465.37771969
Iteration 20, inertia 77882811.44210112
Iteration 21, inertia 77874247.55537431
Iteration 22, inertia 77866883.46636808
Iteration 23, inertia 77863357.14683583
Iteration 24, inertia 77860628.23536123
Iteration 25, inertia 77856563.84422946
Iteration 26, inertia 77852055.76567449
Iteration 27, inertia 77849482.19177847
Iteration 28, inertia 77848010.59408943
Iteration 29, inertia 77847361.4148068
Iteration 30, inertia 77846623.39187734
Iteration 31, inertia 77846053.25215249
Iteration 32, inertia 77845154.22354491
Iteration 33, inertia 77844354.57448679
Iteration 34, inertia 77843483.46354184
Iteration 35, inertia 77842867.07720812
Iteration 36, inertia 77842552.29205655
Iteration 37, inertia 77842252.24627331
Iteration 38, inertia 77841131.10666572
Iteration 39, inertia 77839997.74985293
Iteration 40, inertia 77839051.33326969
Iteration 41, inertia 77838043.9469983
Iteration 42, inertia 77835677.97390333
Iteration 43, inertia 77835185.7831323
Iteration 44, inertia 77834524.26786642
Iteration 45, inertia 77834129.16680442
Iteration 46, inertia 77833548.07076976
Iteration 47, inertia 77832645.36635888
Iteration 48, inertia 77832107.56616883
Iteration 49, inertia 77831837.43418957
Iteration 50, inertia 77831398.69954316
Iteration 51, inertia 77830720.92866611
Iteration 52, inertia 77829908.43372041
Iteration 53, inertia 77828859.62825736
Iteration 54, inertia 77826861.36781165
Iteration 55, inertia 77825970.95768036
Iteration 56, inertia 77825663.86203201
Converged at iteration 56: strict convergence.
Initialization complete
Iteration 0, inertia 125773013.71381164
Iteration 1, inertia 83048612.8150338
Iteration 2, inertia 80439108.19793862
Iteration 3, inertia 79505677.25828673
Iteration 4, inertia 79065693.58111441
Iteration 5, inertia 78801500.93815154
Iteration 6, inertia 78621608.56810886
Iteration 7, inertia 78491849.4924236
Iteration 8, inertia 78386841.92376907
Iteration 9, inertia 78313341.39000492
Iteration 10, inertia 78268066.06021316
Iteration 11, inertia 78229780.33231337
Iteration 12, inertia 78192789.13656501
Iteration 13, inertia 78158279.44588833
Iteration 14, inertia 78131626.71948498
Iteration 15, inertia 78105814.96835947
Iteration 16, inertia 78091673.63532367
Iteration 17, inertia 78084799.60106418
Iteration 18, inertia 78079097.84048787
Iteration 19, inertia 78074644.10127394
Iteration 20, inertia 78068754.33128762
Iteration 21, inertia 78064164.14014292
Iteration 22, inertia 78061289.17782378
Iteration 23, inertia 78058865.78272201
Iteration 24, inertia 78057803.17385422
Iteration 25, inertia 78056915.21661465
Iteration 26, inertia 78056618.32542846
Iteration 27, inertia 78056314.69632895
Iteration 28, inertia 78056253.93720932
Converged at iteration 28: strict convergence.
Initialization complete
Iteration 0, inertia 126400138.80925007
Iteration 1, inertia 82600054.20851871
Iteration 2, inertia 80044146.89177914
Iteration 3, inertia 79151884.05031012
Iteration 4, inertia 78696388.01998082
Iteration 5, inertia 78439729.9913629
Iteration 6, inertia 78312513.12839578
Iteration 7, inertia 78224165.20473807
Iteration 8, inertia 78155179.30863085
Iteration 9, inertia 78097346.48248732
Iteration 10, inertia 78063192.20133111
Iteration 11, inertia 78037615.53557856
Iteration 12, inertia 78017432.64798006
Iteration 13, inertia 78001600.57442123
Iteration 14, inertia 77990114.87874965
Iteration 15, inertia 77979158.06580271
Iteration 16, inertia 77970337.70990121
Iteration 17, inertia 77965622.00844413
Iteration 18, inertia 77962790.1491125
Iteration 19, inertia 77961300.19031635
Iteration 20, inertia 77960318.71953021
Iteration 21, inertia 77959377.19542328
Iteration 22, inertia 77958698.38401648
Iteration 23, inertia 77958477.58740522
Iteration 24, inertia 77958331.70965965
Iteration 25, inertia 77958285.99794081
Iteration 26, inertia 77958263.80716234
Iteration 27, inertia 77958223.06925058
Iteration 28, inertia 77958167.77540912
Iteration 29, inertia 77958120.67243819
Iteration 30, inertia 77958077.48156784
Iteration 31, inertia 77958042.35167038
Iteration 32, inertia 77958012.46229102
Iteration 33, inertia 77957975.81528
Iteration 34, inertia 77957952.60243878
Iteration 35, inertia 77957947.02482675
Iteration 36, inertia 77957945.82887246
Iteration 37, inertia 77957944.11916688
Iteration 38, inertia 77957935.04923667
Iteration 39, inertia 77957933.38751405
Iteration 40, inertia 77957930.07794382
Iteration 41, inertia 77957924.29388747
Iteration 42, inertia 77957920.18199316
Iteration 43, inertia 77957918.06933177
Iteration 44, inertia 77957916.07059562
Iteration 45, inertia 77957903.93108818
Iteration 46, inertia 77957892.37800612
Iteration 47, inertia 77957888.72845335
Iteration 48, inertia 77957885.38284837
Iteration 49, inertia 77957881.17260388
Iteration 50, inertia 77957879.43721661
Iteration 51, inertia 77957878.40196073
Iteration 52, inertia 77957878.04819946
Iteration 53, inertia 77957877.67180368
Iteration 54, inertia 77957876.46219932
Iteration 55, inertia 77957874.03073141
Iteration 56, inertia 77957871.82087278
Iteration 57, inertia 77957866.28350985
Iteration 58, inertia 77957855.36060254
Iteration 59, inertia 77957847.45636043
Iteration 60, inertia 77957841.24086098
Iteration 61, inertia 77957833.34991579
Iteration 62, inertia 77957819.00514674
Iteration 63, inertia 77957808.69647875
Iteration 64, inertia 77957798.54506722
Iteration 65, inertia 77957794.4535145
Iteration 66, inertia 77957793.3926359
Converged at iteration 66: strict convergence.
Initialization complete
Iteration 0, inertia 126141348.29209358
Iteration 1, inertia 82447732.5030103
Iteration 2, inertia 79955763.89858004
Iteration 3, inertia 79145259.5130906
Iteration 4, inertia 78758125.2208435
Iteration 5, inertia 78535901.2561362
Iteration 6, inertia 78354544.95598081
Iteration 7, inertia 78251791.34895113
Iteration 8, inertia 78170527.65395485
Iteration 9, inertia 78114537.73369062
Iteration 10, inertia 78082595.90831468
Iteration 11, inertia 78057100.69002974
Iteration 12, inertia 78027772.67721725
Iteration 13, inertia 78005837.51951559
Iteration 14, inertia 77987813.30257232
Iteration 15, inertia 77977286.01783101
Iteration 16, inertia 77968977.63477436
Iteration 17, inertia 77959265.64756665
Iteration 18, inertia 77944004.17194693
Iteration 19, inertia 77934741.35414375
Iteration 20, inertia 77925889.60146493
Iteration 21, inertia 77921236.41616602
Iteration 22, inertia 77913472.61077505
Iteration 23, inertia 77904649.6020503
Iteration 24, inertia 77898398.47966565
Iteration 25, inertia 77895100.15383656
Iteration 26, inertia 77892759.59430274
Iteration 27, inertia 77891381.80423789
Iteration 28, inertia 77890387.21146832
Iteration 29, inertia 77889618.8125262
Iteration 30, inertia 77889283.05166334
Iteration 31, inertia 77888768.87237899
Iteration 32, inertia 77888140.25356683
Iteration 33, inertia 77887306.96891594
Iteration 34, inertia 77886465.35058784
Iteration 35, inertia 77884938.94529349
Iteration 36, inertia 77883404.92418219
Iteration 37, inertia 77882566.03921427
Iteration 38, inertia 77882139.08031091
Iteration 39, inertia 77881790.79780585
Iteration 40, inertia 77881338.15215866
Iteration 41, inertia 77881201.6689779
Iteration 42, inertia 77881079.6318427
Iteration 43, inertia 77881058.3080419
Iteration 44, inertia 77881024.78568667
Iteration 45, inertia 77880985.95576236
Iteration 46, inertia 77880965.78874223
Iteration 47, inertia 77880947.70243989
Iteration 48, inertia 77880893.56453131
Converged at iteration 48: strict convergence.
Initialization complete
Iteration 0, inertia 126074931.57164538
Iteration 1, inertia 82346884.9483473
Iteration 2, inertia 79842130.5939935
Iteration 3, inertia 79022267.94518447
Iteration 4, inertia 78618115.66848041
Iteration 5, inertia 78372579.24373746
Iteration 6, inertia 78200053.88740247
Iteration 7, inertia 78081982.59386498
Iteration 8, inertia 78012137.26482117
Iteration 9, inertia 77958649.25899716
Iteration 10, inertia 77909030.11832033
Iteration 11, inertia 77873636.5007872
Iteration 12, inertia 77844335.07372838
Iteration 13, inertia 77811856.1282624
Iteration 14, inertia 77792679.17978035
Iteration 15, inertia 77782356.59316143
Iteration 16, inertia 77774141.17023063
Iteration 17, inertia 77763025.87941584
Iteration 18, inertia 77752691.17711355
Iteration 19, inertia 77746957.08960158
Iteration 20, inertia 77740945.34056427
Iteration 21, inertia 77731964.79853615
Iteration 22, inertia 77725642.92854069
Iteration 23, inertia 77718735.80850583
Iteration 24, inertia 77713537.0982006
Iteration 25, inertia 77711410.82244019
Iteration 26, inertia 77709684.25437875
Iteration 27, inertia 77703809.43907666
Iteration 28, inertia 77702716.55948187
Iteration 29, inertia 77702370.54595163
Iteration 30, inertia 77701946.98424432
Iteration 31, inertia 77701043.56037097
Iteration 32, inertia 77700437.0018211
Iteration 33, inertia 77700296.08723103
Iteration 34, inertia 77700194.88433555
Iteration 35, inertia 77700139.59737429
Iteration 36, inertia 77700105.29842587
Converged at iteration 36: strict convergence.
Filename: code/create_kmeans_clustering.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    10    551.3 MiB    551.3 MiB           1   @profile
    11                                         def kmeans_cluster(P, V, K, output_path, prefix, ref=''):
    12                                             """
    13                                             Uses the point.npy P, vocab.npy V files of a layer (generated using https://github.com/hsajjad/ConceptX/ library) to produce a clustering of <K> clusters at <output_path> named clusters-kmeans-{K}.txt
    14                                             """
    15    551.3 MiB      0.0 MiB           1       kmeans = KMeans(n_clusters=K, verbose=3, random_state=212)
    16    697.3 MiB    145.9 MiB           1       output = kmeans.fit(P)
    17                                             
    18    697.3 MiB      0.0 MiB           1       out_file =  f"{output_path}/{prefix}-clusters-kmeans-{K}{ref}.txt"
    19                                         
    20    697.3 MiB      0.0 MiB        1003       clusters = {i:[] for i in range(K)}
    21                                             
    22    703.3 MiB      0.0 MiB       72899       for v, l in zip(V, output.labels_):
    23    703.3 MiB      6.0 MiB       72898          clusters[l].append(f'{v}|||{l}')
    24                                         
    25                                         
    26    703.3 MiB      0.0 MiB           1       out = ""
    27    713.3 MiB      0.0 MiB        1001       for k,v in clusters.items():
    28    713.3 MiB     10.0 MiB        1000           out += '\n'.join(v) + '\n'
    29                                         
    30                                             
    31    713.3 MiB      0.0 MiB           1       with open(out_file, 'w') as f2:
    32    713.4 MiB      0.1 MiB           1           f2.write(out)
    33                                         
    34    713.4 MiB      0.0 MiB           1       return out


Runtime: 1026.058264017105
USAGE: create_kmeans_clustering.py -p <POINT_FILE> -v <VOCAB_FILE> -k <CLUSTERS> -o <OUTPUT_FOLDER>
Initialization complete
Iteration 0, inertia 125761258.42990841
Iteration 1, inertia 85972276.58994964
Iteration 2, inertia 83803830.13694
Iteration 3, inertia 82991324.37224159
Iteration 4, inertia 82551727.49606209
Iteration 5, inertia 82290786.39304382
Iteration 6, inertia 82111434.29691228
Iteration 7, inertia 81982129.64518295
Iteration 8, inertia 81897045.85183373
Iteration 9, inertia 81828239.51097818
Iteration 10, inertia 81771089.92384417
Iteration 11, inertia 81724626.59365231
Iteration 12, inertia 81691377.22044407
Iteration 13, inertia 81662508.83778165
Iteration 14, inertia 81637274.69212851
Iteration 15, inertia 81617120.65261175
Iteration 16, inertia 81602843.63199416
Iteration 17, inertia 81593483.86898452
Iteration 18, inertia 81584742.02008353
Iteration 19, inertia 81575014.92566833
Iteration 20, inertia 81565191.01168603
Iteration 21, inertia 81555344.51337281
Iteration 22, inertia 81547140.89343542
Iteration 23, inertia 81540179.33026317
Iteration 24, inertia 81533059.49006625
Iteration 25, inertia 81528209.45861554
Iteration 26, inertia 81524279.48848987
Iteration 27, inertia 81521003.01783529
Iteration 28, inertia 81517483.14839378
Iteration 29, inertia 81515122.573908
Iteration 30, inertia 81513092.5072663
Iteration 31, inertia 81511068.4426248
Iteration 32, inertia 81509536.99544618
Iteration 33, inertia 81508355.7394371
Iteration 34, inertia 81507551.01342124
Iteration 35, inertia 81506537.89186488
Iteration 36, inertia 81505839.44696486
Iteration 37, inertia 81505040.04727718
Iteration 38, inertia 81504393.31815997
Iteration 39, inertia 81503782.02675563
Iteration 40, inertia 81503173.57789484
Iteration 41, inertia 81502270.12600999
Iteration 42, inertia 81501573.38494426
Iteration 43, inertia 81501082.91886027
Iteration 44, inertia 81500911.7872233
Iteration 45, inertia 81500878.85317951
Converged at iteration 45: strict convergence.
Initialization complete
Iteration 0, inertia 125728594.7036279
Iteration 1, inertia 85934391.46801999
Iteration 2, inertia 83876954.66855893
Iteration 3, inertia 83094637.54236123
Iteration 4, inertia 82667673.54749219
Iteration 5, inertia 82404967.76328516
Iteration 6, inertia 82224603.613246
Iteration 7, inertia 82093523.46143721
Iteration 8, inertia 81991127.28310728
Iteration 9, inertia 81919255.60174109
Iteration 10, inertia 81857740.53082474
Iteration 11, inertia 81808524.92816038
Iteration 12, inertia 81769355.60411938
Iteration 13, inertia 81734732.72342831
Iteration 14, inertia 81709035.27385178
Iteration 15, inertia 81690931.67341012
Iteration 16, inertia 81673349.07887727
Iteration 17, inertia 81659312.03074521
Iteration 18, inertia 81647726.04743008
Iteration 19, inertia 81637062.34200892
Iteration 20, inertia 81628282.89659363
Iteration 21, inertia 81620024.62668945
Iteration 22, inertia 81612287.9778159
Iteration 23, inertia 81605491.16525519
Iteration 24, inertia 81600900.82026882
Iteration 25, inertia 81596732.39209048
Iteration 26, inertia 81592725.97055839
Iteration 27, inertia 81589414.07927333
Iteration 28, inertia 81585739.40645643
Iteration 29, inertia 81582396.38040544
Iteration 30, inertia 81578354.15677503
Iteration 31, inertia 81573961.58661118
Iteration 32, inertia 81569795.74349189
Iteration 33, inertia 81567654.06483418
Iteration 34, inertia 81565873.10584395
Iteration 35, inertia 81564374.8088592
Iteration 36, inertia 81563122.40790583
Iteration 37, inertia 81562587.53991412
Iteration 38, inertia 81562336.1166061
Iteration 39, inertia 81562163.15372157
Iteration 40, inertia 81562003.67763112
Iteration 41, inertia 81561833.42212103
Converged at iteration 41: strict convergence.
Initialization complete
Iteration 0, inertia 125734771.26554634
Iteration 1, inertia 86051051.83686553
Iteration 2, inertia 83990300.34679759
Iteration 3, inertia 83176667.26488034
Iteration 4, inertia 82716273.50421286
Iteration 5, inertia 82422231.67770734
Iteration 6, inertia 82241681.00647262
Iteration 7, inertia 82119029.38686314
Iteration 8, inertia 82012137.47671689
Iteration 9, inertia 81939978.91038498
Iteration 10, inertia 81879265.1813259
Iteration 11, inertia 81836394.18384482
Iteration 12, inertia 81802750.02666548
Iteration 13, inertia 81773852.30650054
Iteration 14, inertia 81750525.26984394
Iteration 15, inertia 81727154.52079186
Iteration 16, inertia 81710492.42699759
Iteration 17, inertia 81698075.94755536
Iteration 18, inertia 81684984.18433866
Iteration 19, inertia 81675422.29148363
Iteration 20, inertia 81667960.21381135
Iteration 21, inertia 81661062.57787997
Iteration 22, inertia 81655962.32150449
Iteration 23, inertia 81650727.91623539
Iteration 24, inertia 81646508.03982033
Iteration 25, inertia 81643369.55804828
Iteration 26, inertia 81640277.68014963
Iteration 27, inertia 81637362.06128596
Iteration 28, inertia 81633363.9102887
Iteration 29, inertia 81630558.03348225
Iteration 30, inertia 81628355.586382
Iteration 31, inertia 81626493.98900901
Iteration 32, inertia 81625210.89260212
Iteration 33, inertia 81623923.05216248
Iteration 34, inertia 81622882.94221486
Iteration 35, inertia 81621940.36057237
Iteration 36, inertia 81620535.334957
Iteration 37, inertia 81619668.38896799
Iteration 38, inertia 81619069.35157625
Iteration 39, inertia 81618374.23741847
Iteration 40, inertia 81617779.64602438
Iteration 41, inertia 81617450.79796168
Iteration 42, inertia 81617344.76430745
Iteration 43, inertia 81617286.4103088
Iteration 44, inertia 81617231.55995852
Converged at iteration 44: strict convergence.
Initialization complete
Iteration 0, inertia 125662730.17290258
Iteration 1, inertia 86000506.02739617
Iteration 2, inertia 83858077.33630854
Iteration 3, inertia 83069415.78704165
Iteration 4, inertia 82640179.27018379
Iteration 5, inertia 82373344.96402535
Iteration 6, inertia 82184561.95780165
Iteration 7, inertia 82049895.29243289
Iteration 8, inertia 81957775.63487625
Iteration 9, inertia 81890390.02341084
Iteration 10, inertia 81840864.03718646
Iteration 11, inertia 81804735.74888867
Iteration 12, inertia 81775446.54281205
Iteration 13, inertia 81747700.11215548
Iteration 14, inertia 81724247.88662982
Iteration 15, inertia 81705612.24443652
Iteration 16, inertia 81691735.84001864
Iteration 17, inertia 81681121.12371616
Iteration 18, inertia 81672145.28092864
Iteration 19, inertia 81664101.71959497
Iteration 20, inertia 81658506.09457342
Iteration 21, inertia 81653002.0182279
Iteration 22, inertia 81648321.77286652
Iteration 23, inertia 81644628.7977355
Iteration 24, inertia 81639887.4707109
Iteration 25, inertia 81636344.01979934
Iteration 26, inertia 81634242.92957944
Iteration 27, inertia 81632277.1899671
Iteration 28, inertia 81630916.98285492
Iteration 29, inertia 81629682.47272071
Iteration 30, inertia 81628386.58652835
Iteration 31, inertia 81627134.18989265
Iteration 32, inertia 81626311.84834552
Iteration 33, inertia 81625148.29844464
Iteration 34, inertia 81624022.00589195
Iteration 35, inertia 81622833.98735803
Iteration 36, inertia 81620975.59083152
Iteration 37, inertia 81618854.88096815
Iteration 38, inertia 81616064.28582206
Iteration 39, inertia 81612767.31308591
Iteration 40, inertia 81609941.534091
Iteration 41, inertia 81607434.4835363
Iteration 42, inertia 81605935.96377352
Iteration 43, inertia 81605152.07371691
Iteration 44, inertia 81604658.3239236
Iteration 45, inertia 81604448.48246062
Iteration 46, inertia 81604092.23128249
Iteration 47, inertia 81603550.89112486
Iteration 48, inertia 81602981.60375012
Iteration 49, inertia 81602763.30413887
Iteration 50, inertia 81602682.59056894
Iteration 51, inertia 81602510.0932938
Iteration 52, inertia 81602373.98817198
Iteration 53, inertia 81601946.50685188
Iteration 54, inertia 81601019.55958046
Iteration 55, inertia 81600661.58069485
Iteration 56, inertia 81600241.88999045
Iteration 57, inertia 81599571.87178464
Iteration 58, inertia 81599444.35075039
Iteration 59, inertia 81599417.4358086
Iteration 60, inertia 81599377.73497388
Iteration 61, inertia 81599350.78541072
Converged at iteration 61: strict convergence.
Initialization complete
Iteration 0, inertia 125396240.87056454
Iteration 1, inertia 85769940.88419765
Iteration 2, inertia 83653251.80889836
Iteration 3, inertia 82873292.22839169
Iteration 4, inertia 82469886.62989591
Iteration 5, inertia 82235050.67750978
Iteration 6, inertia 82079159.45051868
Iteration 7, inertia 81972501.70368719
Iteration 8, inertia 81887447.48795827
Iteration 9, inertia 81828202.48023883
Iteration 10, inertia 81784772.22922032
Iteration 11, inertia 81751308.1024989
Iteration 12, inertia 81718697.7146724
Iteration 13, inertia 81686842.49840271
Iteration 14, inertia 81659380.91013876
Iteration 15, inertia 81633021.1747444
Iteration 16, inertia 81616338.22521174
Iteration 17, inertia 81603421.4754236
Iteration 18, inertia 81591085.83465618
Iteration 19, inertia 81578187.09877594
Iteration 20, inertia 81564234.98805684
Iteration 21, inertia 81555271.83032855
Iteration 22, inertia 81548902.49718332
Iteration 23, inertia 81543033.85578664
Iteration 24, inertia 81537263.86480363
Iteration 25, inertia 81532986.54385878
Iteration 26, inertia 81529452.14665933
Iteration 27, inertia 81526346.15077339
Iteration 28, inertia 81521697.62966757
Iteration 29, inertia 81518688.9276917
Iteration 30, inertia 81517003.28294964
Iteration 31, inertia 81515389.4473751
Iteration 32, inertia 81512566.73618628
Iteration 33, inertia 81509776.40770951
Iteration 34, inertia 81507256.78919317
Iteration 35, inertia 81505271.5874521
Iteration 36, inertia 81504029.13531998
Iteration 37, inertia 81503152.47821374
Iteration 38, inertia 81502601.89013389
Iteration 39, inertia 81501978.1782265
Iteration 40, inertia 81501083.8635414
Iteration 41, inertia 81500022.60036993
Iteration 42, inertia 81498720.49505293
Iteration 43, inertia 81497331.16112962
Iteration 44, inertia 81496120.24987352
Iteration 45, inertia 81495274.85646553
Iteration 46, inertia 81494405.17905293
Iteration 47, inertia 81493367.7086079
Iteration 48, inertia 81492987.80389743
Iteration 49, inertia 81492726.3074731
Iteration 50, inertia 81492553.47645453
Iteration 51, inertia 81492439.41581506
Iteration 52, inertia 81492380.07960895
Iteration 53, inertia 81492301.09148693
Converged at iteration 53: strict convergence.
Initialization complete
Iteration 0, inertia 125614864.46155086
Iteration 1, inertia 86081001.35167074
Iteration 2, inertia 83905630.6614335
Iteration 3, inertia 83079486.14611432
Iteration 4, inertia 82627428.58661106
Iteration 5, inertia 82341438.13075311
Iteration 6, inertia 82147577.71237369
Iteration 7, inertia 82005745.30652523
Iteration 8, inertia 81906537.9504241
Iteration 9, inertia 81833761.34049298
Iteration 10, inertia 81783375.68638125
Iteration 11, inertia 81742308.05439204
Iteration 12, inertia 81708160.4707937
Iteration 13, inertia 81680182.59001856
Iteration 14, inertia 81654543.75575133
Iteration 15, inertia 81632302.89131588
Iteration 16, inertia 81615930.8119596
Iteration 17, inertia 81601956.4807602
Iteration 18, inertia 81591758.18467161
Iteration 19, inertia 81584762.7813301
Iteration 20, inertia 81579417.91678505
Iteration 21, inertia 81574879.43454592
Iteration 22, inertia 81571319.46322586
Iteration 23, inertia 81567701.42260186
Iteration 24, inertia 81564909.84186359
Iteration 25, inertia 81562282.9974443
Iteration 26, inertia 81559044.08488612
Iteration 27, inertia 81555912.61702384
Iteration 28, inertia 81553592.85564733
Iteration 29, inertia 81551816.93819205
Iteration 30, inertia 81550595.39239642
Iteration 31, inertia 81549281.12251034
Iteration 32, inertia 81547940.54389082
Iteration 33, inertia 81546956.96838728
Iteration 34, inertia 81546076.82388665
Iteration 35, inertia 81545541.0670649
Iteration 36, inertia 81545136.4155464
Iteration 37, inertia 81544572.91514769
Iteration 38, inertia 81544153.79765117
Iteration 39, inertia 81543862.07247339
Iteration 40, inertia 81543463.02562065
Iteration 41, inertia 81543121.5351249
Iteration 42, inertia 81542382.77991576
Iteration 43, inertia 81541445.17294347
Iteration 44, inertia 81540610.50767395
Iteration 45, inertia 81539702.76278679
Iteration 46, inertia 81539150.4240706
Iteration 47, inertia 81538816.65413362
Iteration 48, inertia 81538690.4826514
Converged at iteration 48: strict convergence.
Initialization complete
Iteration 0, inertia 125384106.91730484
Iteration 1, inertia 85940054.72578347
Iteration 2, inertia 83834569.4466324
Iteration 3, inertia 83064797.47088538
Iteration 4, inertia 82648999.34763719
Iteration 5, inertia 82376215.60444848
Iteration 6, inertia 82185121.35656615
Iteration 7, inertia 82044116.18348452
Iteration 8, inertia 81931279.715126
Iteration 9, inertia 81850892.393765
Iteration 10, inertia 81784081.11898585
Iteration 11, inertia 81731187.54081196
Iteration 12, inertia 81687993.2981604
Iteration 13, inertia 81649264.94477807
Iteration 14, inertia 81622709.30226107
Iteration 15, inertia 81598421.52642943
Iteration 16, inertia 81578862.38952047
Iteration 17, inertia 81563141.4839394
Iteration 18, inertia 81551960.36354198
Iteration 19, inertia 81542908.35908343
Iteration 20, inertia 81534466.99189533
Iteration 21, inertia 81526051.16089833
Iteration 22, inertia 81519775.99070252
Iteration 23, inertia 81513064.20202263
Iteration 24, inertia 81505732.55912918
Iteration 25, inertia 81496095.7578962
Iteration 26, inertia 81491604.73144545
Iteration 27, inertia 81487737.81278512
Iteration 28, inertia 81484327.68964888
Iteration 29, inertia 81481434.97427239
Iteration 30, inertia 81478744.80934809
Iteration 31, inertia 81476271.97082628
Iteration 32, inertia 81474007.27584307
Iteration 33, inertia 81471924.39268894
Iteration 34, inertia 81470425.84468453
Iteration 35, inertia 81469386.8519375
Iteration 36, inertia 81468481.83127068
Iteration 37, inertia 81467991.74972217
Iteration 38, inertia 81467667.53404945
Iteration 39, inertia 81467447.51341543
Iteration 40, inertia 81467145.8523432
Iteration 41, inertia 81466787.94431703
Iteration 42, inertia 81466403.70548743
Iteration 43, inertia 81466130.64090319
Iteration 44, inertia 81465779.01695152
Iteration 45, inertia 81465423.40952145
Iteration 46, inertia 81464986.0827954
Iteration 47, inertia 81464875.22667532
Iteration 48, inertia 81464828.82312922
Iteration 49, inertia 81464747.26852925
Iteration 50, inertia 81464672.44303446
Iteration 51, inertia 81464557.84131312
Iteration 52, inertia 81464517.02321677
Iteration 53, inertia 81464475.96380062
Converged at iteration 53: strict convergence.
Initialization complete
Iteration 0, inertia 125847617.5103387
Iteration 1, inertia 86019321.34097019
Iteration 2, inertia 83888147.59231113
Iteration 3, inertia 83081028.89054416
Iteration 4, inertia 82647216.71857344
Iteration 5, inertia 82395086.79901062
Iteration 6, inertia 82231452.21033159
Iteration 7, inertia 82103716.57294984
Iteration 8, inertia 82000308.52130929
Iteration 9, inertia 81918016.9011674
Iteration 10, inertia 81854016.01618713
Iteration 11, inertia 81809601.31217472
Iteration 12, inertia 81769080.93880895
Iteration 13, inertia 81736537.33884695
Iteration 14, inertia 81710611.55419798
Iteration 15, inertia 81686530.73202866
Iteration 16, inertia 81662940.95183806
Iteration 17, inertia 81641838.42427461
Iteration 18, inertia 81622185.79332978
Iteration 19, inertia 81608228.56191352
Iteration 20, inertia 81596193.54141866
Iteration 21, inertia 81586243.10567294
Iteration 22, inertia 81576575.64668109
Iteration 23, inertia 81568837.03628619
Iteration 24, inertia 81561911.08117166
Iteration 25, inertia 81554320.09824602
Iteration 26, inertia 81546801.76885515
Iteration 27, inertia 81539811.8894516
Iteration 28, inertia 81534288.87688652
Iteration 29, inertia 81531140.33659084
Iteration 30, inertia 81529084.45538048
Iteration 31, inertia 81527444.24916145
Iteration 32, inertia 81526568.47265112
Iteration 33, inertia 81525574.76498005
Iteration 34, inertia 81524900.44372602
Iteration 35, inertia 81524499.49671838
Iteration 36, inertia 81524123.53534935
Iteration 37, inertia 81523885.29848076
Iteration 38, inertia 81523693.81279235
Iteration 39, inertia 81523503.57826968
Iteration 40, inertia 81523321.54288368
Iteration 41, inertia 81523154.49446729
Iteration 42, inertia 81522953.91673243
Iteration 43, inertia 81522712.22146565
Iteration 44, inertia 81522257.50160407
Iteration 45, inertia 81521850.17260505
Iteration 46, inertia 81521585.78971694
Iteration 47, inertia 81521399.59567745
Iteration 48, inertia 81521282.66093224
Iteration 49, inertia 81521235.53132606
Iteration 50, inertia 81521207.96980688
Iteration 51, inertia 81521185.59003493
Iteration 52, inertia 81521182.20132129
Converged at iteration 52: strict convergence.
Initialization complete
Iteration 0, inertia 125354634.7361505
Iteration 1, inertia 85986157.33215868
Iteration 2, inertia 83855414.52658436
Iteration 3, inertia 83058956.17994452
Iteration 4, inertia 82616327.82570587
Iteration 5, inertia 82347226.34693134
Iteration 6, inertia 82159037.05779892
Iteration 7, inertia 82007491.34724028
Iteration 8, inertia 81890689.26106977
Iteration 9, inertia 81802873.21387514
Iteration 10, inertia 81734919.91820104
Iteration 11, inertia 81680648.63922346
Iteration 12, inertia 81636407.45275599
Iteration 13, inertia 81601616.91969858
Iteration 14, inertia 81572012.50068827
Iteration 15, inertia 81548884.96552001
Iteration 16, inertia 81531559.95144011
Iteration 17, inertia 81513501.15652342
Iteration 18, inertia 81499167.26645856
Iteration 19, inertia 81486986.4656502
Iteration 20, inertia 81477680.71008515
Iteration 21, inertia 81469906.63921243
Iteration 22, inertia 81463408.61726663
Iteration 23, inertia 81457625.00148875
Iteration 24, inertia 81451497.98147205
Iteration 25, inertia 81446942.4892676
Iteration 26, inertia 81442946.22408824
Iteration 27, inertia 81438125.98879473
Iteration 28, inertia 81433783.33412729
Iteration 29, inertia 81429641.36822997
Iteration 30, inertia 81426404.18323985
Iteration 31, inertia 81423888.90491937
Iteration 32, inertia 81421183.68813524
Iteration 33, inertia 81419502.69649515
Iteration 34, inertia 81418576.46137136
Iteration 35, inertia 81418255.5453815
Iteration 36, inertia 81418222.30257213
Iteration 37, inertia 81418195.31879093
Iteration 38, inertia 81418176.46435514
Converged at iteration 38: strict convergence.
Initialization complete
Iteration 0, inertia 125590168.83419247
Iteration 1, inertia 85857812.74343029
Iteration 2, inertia 83724331.80761258
Iteration 3, inertia 82940712.71133846
Iteration 4, inertia 82530287.28581937
Iteration 5, inertia 82281339.61243345
Iteration 6, inertia 82119470.7562943
Iteration 7, inertia 81995688.59055592
Iteration 8, inertia 81902483.6304709
Iteration 9, inertia 81831980.87495647
Iteration 10, inertia 81779243.51699184
Iteration 11, inertia 81740546.82281841
Iteration 12, inertia 81708527.71422255
Iteration 13, inertia 81684013.8186962
Iteration 14, inertia 81662932.84942128
Iteration 15, inertia 81645151.03035508
Iteration 16, inertia 81628987.15850922
Iteration 17, inertia 81613580.87536895
Iteration 18, inertia 81597198.65763532
Iteration 19, inertia 81584992.27605878
Iteration 20, inertia 81576169.15816535
Iteration 21, inertia 81568604.69458893
Iteration 22, inertia 81561649.03915918
Iteration 23, inertia 81555653.12390457
Iteration 24, inertia 81551427.10815413
Iteration 25, inertia 81548685.20742676
Iteration 26, inertia 81546528.74469696
Iteration 27, inertia 81545346.62246923
Iteration 28, inertia 81544003.96889201
Iteration 29, inertia 81542820.95634961
Iteration 30, inertia 81541503.07464264
Iteration 31, inertia 81540081.75235224
Iteration 32, inertia 81538997.06339608
Iteration 33, inertia 81537480.61260435
Iteration 34, inertia 81535855.21569374
Iteration 35, inertia 81534145.16958629
Iteration 36, inertia 81532734.36338958
Iteration 37, inertia 81531783.76158318
Iteration 38, inertia 81530796.71367787
Iteration 39, inertia 81529922.13157058
Iteration 40, inertia 81529377.95108853
Iteration 41, inertia 81529213.39280267
Iteration 42, inertia 81529103.96871324
Iteration 43, inertia 81528919.45212682
Iteration 44, inertia 81528614.1454035
Iteration 45, inertia 81528518.06903937
Iteration 46, inertia 81528348.93574455
Iteration 47, inertia 81528046.94023947
Iteration 48, inertia 81527582.71486181
Iteration 49, inertia 81527216.82452853
Iteration 50, inertia 81526626.80187951
Iteration 51, inertia 81526075.62612313
Iteration 52, inertia 81525747.19092916
Iteration 53, inertia 81525546.62474078
Iteration 54, inertia 81525328.78488515
Iteration 55, inertia 81524829.68460104
Iteration 56, inertia 81524597.47371271
Iteration 57, inertia 81524199.2963311
Iteration 58, inertia 81523756.94230892
Iteration 59, inertia 81523209.3396737
Iteration 60, inertia 81522617.68358135
Iteration 61, inertia 81521362.89783317
Iteration 62, inertia 81518041.92771831
Iteration 63, inertia 81512344.58410615
Iteration 64, inertia 81510362.52073233
Iteration 65, inertia 81509024.15056288
Iteration 66, inertia 81508443.88609539
Iteration 67, inertia 81507927.47459105
Iteration 68, inertia 81507361.24220122
Iteration 69, inertia 81506998.02978678
Iteration 70, inertia 81506727.07505964
Iteration 71, inertia 81506543.45994459
Iteration 72, inertia 81506383.9489025
Iteration 73, inertia 81506294.36867255
Converged at iteration 73: strict convergence.
Filename: code/create_kmeans_clustering.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    10    494.4 MiB    494.4 MiB           1   @profile
    11                                         def kmeans_cluster(P, V, K, output_path, prefix, ref=''):
    12                                             """
    13                                             Uses the point.npy P, vocab.npy V files of a layer (generated using https://github.com/hsajjad/ConceptX/ library) to produce a clustering of <K> clusters at <output_path> named clusters-kmeans-{K}.txt
    14                                             """
    15    494.4 MiB      0.0 MiB           1       kmeans = KMeans(n_clusters=K, verbose=3, random_state=212)
    16    642.3 MiB    147.9 MiB           1       output = kmeans.fit(P)
    17                                             
    18    642.3 MiB      0.0 MiB           1       out_file =  f"{output_path}/{prefix}-clusters-kmeans-{K}{ref}.txt"
    19                                         
    20    642.3 MiB      0.0 MiB        1003       clusters = {i:[] for i in range(K)}
    21                                             
    22    648.3 MiB      1.0 MiB       64043       for v, l in zip(V, output.labels_):
    23    648.3 MiB      5.0 MiB       64042          clusters[l].append(f'{v}|||{l}')
    24                                         
    25                                         
    26    648.3 MiB      0.0 MiB           1       out = ""
    27    655.3 MiB      0.0 MiB        1001       for k,v in clusters.items():
    28    655.3 MiB      7.0 MiB        1000           out += '\n'.join(v) + '\n'
    29                                         
    30                                             
    31    655.3 MiB      0.0 MiB           1       with open(out_file, 'w') as f2:
    32    655.3 MiB      0.0 MiB           1           f2.write(out)
    33                                         
    34    655.3 MiB      0.0 MiB           1       return out


Runtime: 954.7544779777527
Combined output written to: visualize_1000/layer10/clusters-1000.txt

Completed iteration 10.

Running: ./utils_qcri/clustering.sh 1000 11 visualize
Output for iteration 11:
Preparing for visualize
USAGE: create_kmeans_clustering.py -p <POINT_FILE> -v <VOCAB_FILE> -k <CLUSTERS> -o <OUTPUT_FOLDER>
Initialization complete
Iteration 0, inertia 168412878.9070324
Iteration 1, inertia 110509511.69420803
Iteration 2, inertia 107393652.06162116
Iteration 3, inertia 106254306.78216656
Iteration 4, inertia 105683179.94660714
Iteration 5, inertia 105335269.04982814
Iteration 6, inertia 105062242.5126427
Iteration 7, inertia 104883116.97389498
Iteration 8, inertia 104771220.15827535
Iteration 9, inertia 104697615.30625919
Iteration 10, inertia 104644785.08365619
Iteration 11, inertia 104601618.74763092
Iteration 12, inertia 104559766.69513476
Iteration 13, inertia 104528520.38732332
Iteration 14, inertia 104504372.55789253
Iteration 15, inertia 104465783.97011513
Iteration 16, inertia 104440985.22488955
Iteration 17, inertia 104423087.44886571
Iteration 18, inertia 104409562.6266526
Iteration 19, inertia 104401370.22944033
Iteration 20, inertia 104389897.24400714
Iteration 21, inertia 104381010.75163424
Iteration 22, inertia 104371596.84063973
Iteration 23, inertia 104366313.88814677
Iteration 24, inertia 104361886.42855471
Iteration 25, inertia 104357226.54505576
Iteration 26, inertia 104352909.86861956
Iteration 27, inertia 104349405.76964395
Iteration 28, inertia 104345298.60024804
Iteration 29, inertia 104341488.603436
Iteration 30, inertia 104337604.70720175
Iteration 31, inertia 104333920.90694202
Iteration 32, inertia 104331012.23064882
Iteration 33, inertia 104329496.38792263
Iteration 34, inertia 104326065.83279386
Iteration 35, inertia 104322838.63253985
Iteration 36, inertia 104318471.1443353
Iteration 37, inertia 104306572.32022554
Iteration 38, inertia 104303109.0835181
Iteration 39, inertia 104302827.29299235
Iteration 40, inertia 104302029.93148455
Iteration 41, inertia 104301007.15823111
Iteration 42, inertia 104300519.1614925
Iteration 43, inertia 104300214.7303996
Iteration 44, inertia 104300017.7759751
Iteration 45, inertia 104299800.3119354
Iteration 46, inertia 104299702.26525638
Iteration 47, inertia 104299657.43504399
Converged at iteration 47: strict convergence.
Initialization complete
Iteration 0, inertia 168967093.9966696
Iteration 1, inertia 110474902.99383532
Iteration 2, inertia 107034044.01683784
Iteration 3, inertia 105872332.17596415
Iteration 4, inertia 105318955.19840132
Iteration 5, inertia 105022022.6784569
Iteration 6, inertia 104828793.03929988
Iteration 7, inertia 104704569.29379335
Iteration 8, inertia 104615322.38571443
Iteration 9, inertia 104532914.5195105
Iteration 10, inertia 104471891.33153626
Iteration 11, inertia 104427593.17832805
Iteration 12, inertia 104397512.99596114
Iteration 13, inertia 104375568.26956205
Iteration 14, inertia 104348181.98156165
Iteration 15, inertia 104328725.08518937
Iteration 16, inertia 104318332.89206353
Iteration 17, inertia 104309934.93488596
Iteration 18, inertia 104303942.85755694
Iteration 19, inertia 104300282.24269255
Iteration 20, inertia 104296867.6817918
Iteration 21, inertia 104294030.79572958
Iteration 22, inertia 104290806.83653602
Iteration 23, inertia 104287784.97516869
Iteration 24, inertia 104284422.68267688
Iteration 25, inertia 104281951.60572162
Iteration 26, inertia 104279665.5187074
Iteration 27, inertia 104278194.52143146
Iteration 28, inertia 104276142.73446631
Iteration 29, inertia 104274716.03684926
Iteration 30, inertia 104273980.16271488
Iteration 31, inertia 104273768.05411595
Iteration 32, inertia 104273608.1239234
Iteration 33, inertia 104273386.12875153
Iteration 34, inertia 104272883.03394836
Iteration 35, inertia 104272049.8109285
Iteration 36, inertia 104271593.81031996
Iteration 37, inertia 104271280.69829965
Converged at iteration 37: center shift 0.01636900813336885 within tolerance 0.02736771834675807.
Initialization complete
Iteration 0, inertia 168653207.63347417
Iteration 1, inertia 110383788.81921777
Iteration 2, inertia 107055958.07026045
Iteration 3, inertia 105909302.35212538
Iteration 4, inertia 105347300.02281842
Iteration 5, inertia 105030458.36498238
Iteration 6, inertia 104835400.05306381
Iteration 7, inertia 104714493.20092289
Iteration 8, inertia 104624758.3126582
Iteration 9, inertia 104558450.68585695
Iteration 10, inertia 104503542.10382187
Iteration 11, inertia 104463561.66356891
Iteration 12, inertia 104431519.38213104
Iteration 13, inertia 104407809.5972578
Iteration 14, inertia 104392666.55638066
Iteration 15, inertia 104380780.52903792
Iteration 16, inertia 104373067.4846171
Iteration 17, inertia 104367746.45832583
Iteration 18, inertia 104363819.56174943
Iteration 19, inertia 104359831.51470345
Iteration 20, inertia 104355732.08559859
Iteration 21, inertia 104352399.70799235
Iteration 22, inertia 104349583.83646008
Iteration 23, inertia 104347832.16963145
Iteration 24, inertia 104346272.18235897
Iteration 25, inertia 104344573.73913741
Iteration 26, inertia 104343350.88819139
Iteration 27, inertia 104342472.76260602
Iteration 28, inertia 104342100.2816425
Iteration 29, inertia 104341689.85006815
Iteration 30, inertia 104341229.9419167
Iteration 31, inertia 104340899.66362026
Iteration 32, inertia 104340770.02133305
Iteration 33, inertia 104340648.11796513
Iteration 34, inertia 104340388.64535439
Iteration 35, inertia 104339940.76412769
Iteration 36, inertia 104339361.16233258
Iteration 37, inertia 104338722.95069414
Iteration 38, inertia 104337974.15304168
Iteration 39, inertia 104337230.37868361
Iteration 40, inertia 104334615.23954546
Iteration 41, inertia 104330027.67770262
Iteration 42, inertia 104329876.63811384
Iteration 43, inertia 104329828.85998128
Iteration 44, inertia 104329785.77053289
Iteration 45, inertia 104329725.47667903
Iteration 46, inertia 104329628.95502824
Iteration 47, inertia 104329509.05239967
Iteration 48, inertia 104329146.85797797
Iteration 49, inertia 104327735.95205002
Iteration 50, inertia 104327366.06902741
Iteration 51, inertia 104327338.45375061
Iteration 52, inertia 104327264.5124979
Converged at iteration 52: strict convergence.
Initialization complete
Iteration 0, inertia 168688434.4500577
Iteration 1, inertia 110269637.50412112
Iteration 2, inertia 106974696.18365246
Iteration 3, inertia 105828752.71669567
Iteration 4, inertia 105254855.96565652
Iteration 5, inertia 104925677.75839968
Iteration 6, inertia 104723786.86341742
Iteration 7, inertia 104572532.56637102
Iteration 8, inertia 104477132.42867815
Iteration 9, inertia 104408590.7769003
Iteration 10, inertia 104358333.6082021
Iteration 11, inertia 104311440.65790728
Iteration 12, inertia 104255384.2429122
Iteration 13, inertia 104204890.84039284
Iteration 14, inertia 104173803.02253063
Iteration 15, inertia 104143191.59623645
Iteration 16, inertia 104121220.95842887
Iteration 17, inertia 104112367.54059878
Iteration 18, inertia 104107559.42481837
Iteration 19, inertia 104104033.46964014
Iteration 20, inertia 104101041.66651717
Iteration 21, inertia 104097942.0782403
Iteration 22, inertia 104096974.4375298
Iteration 23, inertia 104096479.32471031
Iteration 24, inertia 104096090.5759252
Iteration 25, inertia 104095842.37476236
Iteration 26, inertia 104095636.50550392
Iteration 27, inertia 104095555.66555052
Converged at iteration 27: strict convergence.
Initialization complete
Iteration 0, inertia 169052828.258444
Iteration 1, inertia 110597682.57825902
Iteration 2, inertia 107216281.55108349
Iteration 3, inertia 106063186.99455398
Iteration 4, inertia 105492789.79209769
Iteration 5, inertia 105176613.48602334
Iteration 6, inertia 104974330.60910979
Iteration 7, inertia 104843401.83573629
Iteration 8, inertia 104747252.30238947
Iteration 9, inertia 104662617.18187563
Iteration 10, inertia 104598923.49756867
Iteration 11, inertia 104551162.84347372
Iteration 12, inertia 104513123.01853195
Iteration 13, inertia 104471434.02609144
Iteration 14, inertia 104424928.38563018
Iteration 15, inertia 104391318.40396164
Iteration 16, inertia 104370494.44147217
Iteration 17, inertia 104356287.081013
Iteration 18, inertia 104343590.24817522
Iteration 19, inertia 104331146.89793484
Iteration 20, inertia 104322164.54616134
Iteration 21, inertia 104315426.0180939
Iteration 22, inertia 104310126.02580744
Iteration 23, inertia 104303791.4577924
Iteration 24, inertia 104297494.07663888
Iteration 25, inertia 104286060.54107232
Iteration 26, inertia 104281207.6893788
Iteration 27, inertia 104274666.1497691
Iteration 28, inertia 104262414.14267847
Iteration 29, inertia 104260286.9233681
Iteration 30, inertia 104259633.68732177
Iteration 31, inertia 104259272.24707754
Iteration 32, inertia 104258969.22281113
Iteration 33, inertia 104258878.66916224
Iteration 34, inertia 104258833.83405879
Iteration 35, inertia 104258774.84854722
Converged at iteration 35: center shift 0.00031659005420969967 within tolerance 0.02736771834675807.
Initialization complete
Iteration 0, inertia 168020142.89502588
Iteration 1, inertia 110489292.48232391
Iteration 2, inertia 107126580.57061377
Iteration 3, inertia 106016428.01553582
Iteration 4, inertia 105481317.4714732
Iteration 5, inertia 105176027.5517885
Iteration 6, inertia 104955275.59568565
Iteration 7, inertia 104807886.06168583
Iteration 8, inertia 104706907.8114154
Iteration 9, inertia 104629085.4367851
Iteration 10, inertia 104560373.69323845
Iteration 11, inertia 104518398.43907794
Iteration 12, inertia 104496905.31099786
Iteration 13, inertia 104477634.66769655
Iteration 14, inertia 104463934.39158382
Iteration 15, inertia 104452583.60178402
Iteration 16, inertia 104444205.7293044
Iteration 17, inertia 104438121.1766514
Iteration 18, inertia 104433479.01181066
Iteration 19, inertia 104427354.00171313
Iteration 20, inertia 104419087.80685507
Iteration 21, inertia 104407207.35919312
Iteration 22, inertia 104399083.89292423
Iteration 23, inertia 104395059.97076638
Iteration 24, inertia 104390876.60202824
Iteration 25, inertia 104385861.88301934
Iteration 26, inertia 104382422.81022134
Iteration 27, inertia 104380322.8342169
Iteration 28, inertia 104377824.7313484
Iteration 29, inertia 104374861.96708418
Iteration 30, inertia 104370501.34506805
Iteration 31, inertia 104367692.27515082
Iteration 32, inertia 104365730.71054998
Iteration 33, inertia 104364512.84458348
Iteration 34, inertia 104363170.57483387
Iteration 35, inertia 104362325.95232153
Iteration 36, inertia 104362023.45485021
Iteration 37, inertia 104361947.0046909
Iteration 38, inertia 104361908.69783647
Iteration 39, inertia 104361832.8292948
Iteration 40, inertia 104361793.50867921
Iteration 41, inertia 104361737.62830839
Iteration 42, inertia 104361680.9823274
Iteration 43, inertia 104361642.67683274
Iteration 44, inertia 104361586.37462296
Iteration 45, inertia 104361539.82949533
Iteration 46, inertia 104361508.14855352
Converged at iteration 46: strict convergence.
Initialization complete
Iteration 0, inertia 168807312.4933426
Iteration 1, inertia 110570459.99497259
Iteration 2, inertia 107200158.42547958
Iteration 3, inertia 106103855.74759555
Iteration 4, inertia 105568380.52155171
Iteration 5, inertia 105240204.55950864
Iteration 6, inertia 105052117.4079375
Iteration 7, inertia 104931226.1875914
Iteration 8, inertia 104834312.39483327
Iteration 9, inertia 104755111.90991543
Iteration 10, inertia 104688585.99605364
Iteration 11, inertia 104635452.07246017
Iteration 12, inertia 104595878.4521511
Iteration 13, inertia 104556604.97578567
Iteration 14, inertia 104523020.59846708
Iteration 15, inertia 104502032.99204572
Iteration 16, inertia 104486304.43147066
Iteration 17, inertia 104470274.17441735
Iteration 18, inertia 104461270.15108891
Iteration 19, inertia 104455103.3977898
Iteration 20, inertia 104447383.66158377
Iteration 21, inertia 104441147.00076145
Iteration 22, inertia 104427934.16107704
Iteration 23, inertia 104421784.47222196
Iteration 24, inertia 104418184.03999889
Iteration 25, inertia 104415635.69063725
Iteration 26, inertia 104410449.8022795
Iteration 27, inertia 104406422.2956036
Iteration 28, inertia 104402911.65109456
Iteration 29, inertia 104398533.61657783
Iteration 30, inertia 104394502.13744311
Iteration 31, inertia 104392516.13473487
Iteration 32, inertia 104391897.64742528
Iteration 33, inertia 104391492.9286398
Iteration 34, inertia 104390646.48062378
Iteration 35, inertia 104390100.49495949
Iteration 36, inertia 104389431.68554388
Iteration 37, inertia 104388620.3617396
Converged at iteration 37: strict convergence.
Initialization complete
Iteration 0, inertia 169147279.49096513
Iteration 1, inertia 110506513.87921646
Iteration 2, inertia 107414366.74537444
Iteration 3, inertia 106291943.58843248
Iteration 4, inertia 105726095.12923768
Iteration 5, inertia 105405935.37107891
Iteration 6, inertia 105179964.08407858
Iteration 7, inertia 105008016.23936222
Iteration 8, inertia 104873581.56530486
Iteration 9, inertia 104753400.45051987
Iteration 10, inertia 104679451.09478281
Iteration 11, inertia 104627860.05702518
Iteration 12, inertia 104578632.3986633
Iteration 13, inertia 104546079.45353195
Iteration 14, inertia 104521078.17139691
Iteration 15, inertia 104502972.68291336
Iteration 16, inertia 104487307.89451005
Iteration 17, inertia 104472299.38359748
Iteration 18, inertia 104459518.24239045
Iteration 19, inertia 104447035.39829427
Iteration 20, inertia 104434367.81405802
Iteration 21, inertia 104424939.51723284
Iteration 22, inertia 104419010.9897981
Iteration 23, inertia 104415464.65232694
Iteration 24, inertia 104412206.00065017
Iteration 25, inertia 104410359.82863508
Iteration 26, inertia 104407628.06256019
Iteration 27, inertia 104405815.43302555
Iteration 28, inertia 104405134.1088913
Iteration 29, inertia 104405062.79443562
Converged at iteration 29: strict convergence.
Initialization complete
Iteration 0, inertia 169088966.64811867
Iteration 1, inertia 110551979.46674938
Iteration 2, inertia 107168707.87653223
Iteration 3, inertia 106003085.66146134
Iteration 4, inertia 105485467.76202431
Iteration 5, inertia 105201732.8076936
Iteration 6, inertia 105028809.42322385
Iteration 7, inertia 104889080.2455994
Iteration 8, inertia 104783541.3419041
Iteration 9, inertia 104698837.14834642
Iteration 10, inertia 104627116.3037522
Iteration 11, inertia 104587126.92781669
Iteration 12, inertia 104549449.9185347
Iteration 13, inertia 104519945.28288239
Iteration 14, inertia 104497435.8581922
Iteration 15, inertia 104477788.42613691
Iteration 16, inertia 104464851.30952692
Iteration 17, inertia 104453088.71879733
Iteration 18, inertia 104441457.9990748
Iteration 19, inertia 104433995.54318477
Iteration 20, inertia 104427719.25538702
Iteration 21, inertia 104422768.1564969
Iteration 22, inertia 104418505.9233073
Iteration 23, inertia 104412187.91032313
Iteration 24, inertia 104405875.85967602
Iteration 25, inertia 104403927.28822751
Iteration 26, inertia 104399306.11896405
Iteration 27, inertia 104385429.84435965
Iteration 28, inertia 104378976.78097062
Iteration 29, inertia 104373656.71896973
Iteration 30, inertia 104370398.80881408
Iteration 31, inertia 104369275.60619876
Iteration 32, inertia 104369081.63678671
Converged at iteration 32: strict convergence.
Initialization complete
Iteration 0, inertia 168581751.3838804
Iteration 1, inertia 110545157.11861002
Iteration 2, inertia 107358555.7282216
Iteration 3, inertia 106123558.53755262
Iteration 4, inertia 105554655.33056143
Iteration 5, inertia 105215566.82118872
Iteration 6, inertia 104994449.45779984
Iteration 7, inertia 104845436.42458963
Iteration 8, inertia 104727392.4401643
Iteration 9, inertia 104637591.67194326
Iteration 10, inertia 104584642.82088402
Iteration 11, inertia 104543688.78390567
Iteration 12, inertia 104505829.86507776
Iteration 13, inertia 104471894.50979692
Iteration 14, inertia 104454473.62232545
Iteration 15, inertia 104439845.72940075
Iteration 16, inertia 104427281.42131431
Iteration 17, inertia 104420499.49654548
Iteration 18, inertia 104413848.7351381
Iteration 19, inertia 104408622.07625732
Iteration 20, inertia 104400519.91127916
Iteration 21, inertia 104395487.5873649
Iteration 22, inertia 104391879.78973804
Iteration 23, inertia 104388046.93552503
Iteration 24, inertia 104383691.61744589
Iteration 25, inertia 104376736.98934245
Iteration 26, inertia 104365765.82761092
Iteration 27, inertia 104361520.27022307
Iteration 28, inertia 104357895.32456753
Iteration 29, inertia 104354228.44954439
Iteration 30, inertia 104350633.61420394
Iteration 31, inertia 104349290.57681277
Iteration 32, inertia 104348133.4474675
Iteration 33, inertia 104346345.89453828
Iteration 34, inertia 104344468.68968907
Iteration 35, inertia 104343904.72920209
Iteration 36, inertia 104343599.53398643
Iteration 37, inertia 104343360.15109888
Iteration 38, inertia 104343238.67893931
Converged at iteration 38: center shift 0.021929942901175583 within tolerance 0.02736771834675807.
Filename: code/create_kmeans_clustering.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    10    550.6 MiB    550.6 MiB           1   @profile
    11                                         def kmeans_cluster(P, V, K, output_path, prefix, ref=''):
    12                                             """
    13                                             Uses the point.npy P, vocab.npy V files of a layer (generated using https://github.com/hsajjad/ConceptX/ library) to produce a clustering of <K> clusters at <output_path> named clusters-kmeans-{K}.txt
    14                                             """
    15    550.6 MiB      0.0 MiB           1       kmeans = KMeans(n_clusters=K, verbose=3, random_state=212)
    16    709.4 MiB    158.9 MiB           1       output = kmeans.fit(P)
    17                                             
    18    709.4 MiB      0.0 MiB           1       out_file =  f"{output_path}/{prefix}-clusters-kmeans-{K}{ref}.txt"
    19                                         
    20    709.4 MiB      0.0 MiB        1003       clusters = {i:[] for i in range(K)}
    21                                             
    22    715.4 MiB      1.0 MiB       72899       for v, l in zip(V, output.labels_):
    23    715.4 MiB      5.0 MiB       72898          clusters[l].append(f'{v}|||{l}')
    24                                         
    25                                         
    26    715.4 MiB      0.0 MiB           1       out = ""
    27    715.4 MiB      0.0 MiB        1001       for k,v in clusters.items():
    28    715.4 MiB      0.0 MiB        1000           out += '\n'.join(v) + '\n'
    29                                         
    30                                             
    31    715.4 MiB      0.0 MiB           1       with open(out_file, 'w') as f2:
    32    716.3 MiB      0.9 MiB           1           f2.write(out)
    33                                         
    34    716.3 MiB      0.0 MiB           1       return out


Runtime: 999.2644457817078
USAGE: create_kmeans_clustering.py -p <POINT_FILE> -v <VOCAB_FILE> -k <CLUSTERS> -o <OUTPUT_FOLDER>
Initialization complete
Iteration 0, inertia 152910404.17761445
Iteration 1, inertia 104941953.95430984
Iteration 2, inertia 102363624.43003486
Iteration 3, inertia 101455777.78996311
Iteration 4, inertia 100978534.10065989
Iteration 5, inertia 100686571.6571896
Iteration 6, inertia 100479753.50401998
Iteration 7, inertia 100328475.04264547
Iteration 8, inertia 100208763.18136473
Iteration 9, inertia 100114017.63862541
Iteration 10, inertia 100045954.91762148
Iteration 11, inertia 99991255.40619202
Iteration 12, inertia 99940227.3748333
Iteration 13, inertia 99900455.08673415
Iteration 14, inertia 99871371.23829266
Iteration 15, inertia 99849483.6275592
Iteration 16, inertia 99828159.34104016
Iteration 17, inertia 99811024.31029327
Iteration 18, inertia 99799592.36493194
Iteration 19, inertia 99789734.21916169
Iteration 20, inertia 99781355.88923812
Iteration 21, inertia 99771623.51341446
Iteration 22, inertia 99762118.24808507
Iteration 23, inertia 99753147.37668994
Iteration 24, inertia 99746138.30425309
Iteration 25, inertia 99740517.43192407
Iteration 26, inertia 99736241.60889289
Iteration 27, inertia 99732227.58798444
Iteration 28, inertia 99728614.77172361
Iteration 29, inertia 99725866.63503826
Iteration 30, inertia 99723834.14765584
Iteration 31, inertia 99722052.0637718
Iteration 32, inertia 99721150.60476476
Iteration 33, inertia 99720514.1011315
Iteration 34, inertia 99720156.12786005
Iteration 35, inertia 99719873.4605206
Iteration 36, inertia 99719667.06355275
Iteration 37, inertia 99719570.69474782
Iteration 38, inertia 99719465.02123727
Iteration 39, inertia 99719276.2175769
Iteration 40, inertia 99719059.6608623
Iteration 41, inertia 99718857.75183776
Iteration 42, inertia 99718684.04969163
Iteration 43, inertia 99718574.06448331
Iteration 44, inertia 99718347.50658971
Iteration 45, inertia 99718209.43420969
Iteration 46, inertia 99718117.6924898
Iteration 47, inertia 99718029.3397055
Converged at iteration 47: strict convergence.
Initialization complete
Iteration 0, inertia 153430262.1680083
Iteration 1, inertia 105261646.02589402
Iteration 2, inertia 102636437.40378793
Iteration 3, inertia 101697940.93269528
Iteration 4, inertia 101182528.02744052
Iteration 5, inertia 100855757.92597876
Iteration 6, inertia 100627138.0688529
Iteration 7, inertia 100453093.45862274
Iteration 8, inertia 100328353.18270771
Iteration 9, inertia 100233824.95465024
Iteration 10, inertia 100159485.80312482
Iteration 11, inertia 100098860.57322605
Iteration 12, inertia 100055090.77419296
Iteration 13, inertia 100021191.58018993
Iteration 14, inertia 99994599.80942231
Iteration 15, inertia 99972018.08306387
Iteration 16, inertia 99949838.21004713
Iteration 17, inertia 99931274.45271067
Iteration 18, inertia 99918790.92551118
Iteration 19, inertia 99910250.58761457
Iteration 20, inertia 99903111.98591726
Iteration 21, inertia 99897345.69190706
Iteration 22, inertia 99892191.57171592
Iteration 23, inertia 99889165.94493528
Iteration 24, inertia 99886391.69305335
Iteration 25, inertia 99884477.80500068
Iteration 26, inertia 99883515.65610506
Iteration 27, inertia 99882799.12108678
Iteration 28, inertia 99882143.80179016
Iteration 29, inertia 99881575.91974127
Iteration 30, inertia 99881261.52417302
Iteration 31, inertia 99880920.31122428
Iteration 32, inertia 99880489.82010786
Iteration 33, inertia 99880053.38561259
Iteration 34, inertia 99879170.58327787
Iteration 35, inertia 99878402.51121031
Iteration 36, inertia 99877481.67134614
Iteration 37, inertia 99876924.99402934
Iteration 38, inertia 99876170.29138361
Iteration 39, inertia 99875135.63586764
Iteration 40, inertia 99874213.37279311
Iteration 41, inertia 99873631.62061748
Iteration 42, inertia 99873022.53460282
Iteration 43, inertia 99872371.40626878
Iteration 44, inertia 99871574.26467794
Iteration 45, inertia 99870641.33999963
Iteration 46, inertia 99869635.02269672
Iteration 47, inertia 99868238.23968336
Iteration 48, inertia 99867219.0455459
Iteration 49, inertia 99866594.2462685
Iteration 50, inertia 99865624.32437114
Iteration 51, inertia 99864336.9861693
Iteration 52, inertia 99862615.96579392
Iteration 53, inertia 99861515.77143446
Iteration 54, inertia 99860932.33904465
Iteration 55, inertia 99860344.63567208
Iteration 56, inertia 99859932.71128657
Iteration 57, inertia 99859472.89342757
Iteration 58, inertia 99858913.73245691
Iteration 59, inertia 99857535.30372317
Iteration 60, inertia 99856653.10045731
Iteration 61, inertia 99856145.83212696
Iteration 62, inertia 99855622.61173208
Iteration 63, inertia 99854937.98707
Iteration 64, inertia 99854445.02731857
Iteration 65, inertia 99853704.20273623
Iteration 66, inertia 99852798.06109694
Iteration 67, inertia 99852189.68878248
Iteration 68, inertia 99851608.39604634
Iteration 69, inertia 99851288.09598301
Iteration 70, inertia 99850590.91142967
Iteration 71, inertia 99850298.11338113
Iteration 72, inertia 99850240.62203468
Iteration 73, inertia 99850112.36256874
Iteration 74, inertia 99850027.83311614
Converged at iteration 74: strict convergence.
Initialization complete
Iteration 0, inertia 152731541.25428113
Iteration 1, inertia 105205556.96788497
Iteration 2, inertia 102560434.17122085
Iteration 3, inertia 101588310.04656786
Iteration 4, inertia 101081954.6261723
Iteration 5, inertia 100768329.76605572
Iteration 6, inertia 100556608.38254006
Iteration 7, inertia 100406245.90736505
Iteration 8, inertia 100284002.39200146
Iteration 9, inertia 100189539.25158764
Iteration 10, inertia 100105575.31933811
Iteration 11, inertia 100041558.90502274
Iteration 12, inertia 99996674.13167189
Iteration 13, inertia 99955244.2442116
Iteration 14, inertia 99929341.42765196
Iteration 15, inertia 99908881.6346342
Iteration 16, inertia 99889734.43542917
Iteration 17, inertia 99872406.77029064
Iteration 18, inertia 99854614.17229788
Iteration 19, inertia 99839064.25268973
Iteration 20, inertia 99825645.36176358
Iteration 21, inertia 99813686.68796663
Iteration 22, inertia 99802795.16800037
Iteration 23, inertia 99795504.11245467
Iteration 24, inertia 99788376.19860525
Iteration 25, inertia 99781228.19965515
Iteration 26, inertia 99773268.10358137
Iteration 27, inertia 99769559.19210747
Iteration 28, inertia 99766158.53280054
Iteration 29, inertia 99764178.02187085
Iteration 30, inertia 99762639.30927315
Iteration 31, inertia 99761598.21387018
Iteration 32, inertia 99760768.31347194
Iteration 33, inertia 99759874.4865543
Iteration 34, inertia 99759242.40589099
Iteration 35, inertia 99758679.99656366
Iteration 36, inertia 99758240.1998231
Iteration 37, inertia 99757549.5767685
Iteration 38, inertia 99756651.84767202
Iteration 39, inertia 99755815.01328136
Iteration 40, inertia 99755077.84685288
Iteration 41, inertia 99754715.78462984
Iteration 42, inertia 99754673.60556
Iteration 43, inertia 99754656.22620894
Iteration 44, inertia 99754648.08030583
Iteration 45, inertia 99754632.67658569
Iteration 46, inertia 99754612.7052742
Iteration 47, inertia 99754602.43940662
Iteration 48, inertia 99754581.66681947
Converged at iteration 48: strict convergence.
Initialization complete
Iteration 0, inertia 153028494.14304355
Iteration 1, inertia 105110865.44011071
Iteration 2, inertia 102505203.33253027
Iteration 3, inertia 101566036.74275883
Iteration 4, inertia 101049060.35756443
Iteration 5, inertia 100712934.69457002
Iteration 6, inertia 100486356.53352267
Iteration 7, inertia 100326978.22745357
Iteration 8, inertia 100209041.67782623
Iteration 9, inertia 100116284.65138121
Iteration 10, inertia 100043375.33396302
Iteration 11, inertia 99987756.50545682
Iteration 12, inertia 99945047.44635282
Iteration 13, inertia 99910908.34040384
Iteration 14, inertia 99883949.41914353
Iteration 15, inertia 99858737.45175654
Iteration 16, inertia 99837117.78526051
Iteration 17, inertia 99821876.48796616
Iteration 18, inertia 99811772.68996051
Iteration 19, inertia 99804362.1721699
Iteration 20, inertia 99800187.54157974
Iteration 21, inertia 99796403.04899485
Iteration 22, inertia 99793705.33865961
Iteration 23, inertia 99790988.3078712
Iteration 24, inertia 99788524.87207061
Iteration 25, inertia 99786639.79575025
Iteration 26, inertia 99785531.64844474
Iteration 27, inertia 99785115.21932244
Iteration 28, inertia 99784731.06838366
Iteration 29, inertia 99784050.51094973
Iteration 30, inertia 99783639.77826819
Iteration 31, inertia 99782996.25559436
Iteration 32, inertia 99782361.80092885
Iteration 33, inertia 99781856.12139855
Iteration 34, inertia 99781001.6078526
Iteration 35, inertia 99780010.71819513
Iteration 36, inertia 99779318.0220725
Iteration 37, inertia 99778121.31158443
Iteration 38, inertia 99776486.83559583
Iteration 39, inertia 99775393.49996066
Iteration 40, inertia 99774701.40449966
Iteration 41, inertia 99774081.68772018
Iteration 42, inertia 99773472.5824194
Iteration 43, inertia 99772778.05366176
Iteration 44, inertia 99772365.95696664
Iteration 45, inertia 99772011.45687337
Iteration 46, inertia 99771628.10273248
Iteration 47, inertia 99771261.77804053
Iteration 48, inertia 99770895.66159616
Iteration 49, inertia 99770730.82293133
Iteration 50, inertia 99770606.6029429
Iteration 51, inertia 99770497.66745216
Iteration 52, inertia 99770394.01619886
Iteration 53, inertia 99770314.73137428
Iteration 54, inertia 99770248.46766399
Iteration 55, inertia 99770194.30879878
Iteration 56, inertia 99770162.65509102
Iteration 57, inertia 99770051.99100329
Iteration 58, inertia 99769817.91310367
Iteration 59, inertia 99769273.70494315
Iteration 60, inertia 99768355.09626614
Iteration 61, inertia 99767342.91631751
Iteration 62, inertia 99766209.44932564
Iteration 63, inertia 99765630.20570654
Iteration 64, inertia 99765434.00984101
Iteration 65, inertia 99765359.16829814
Iteration 66, inertia 99765345.709313
Iteration 67, inertia 99765330.35510795
Iteration 68, inertia 99765303.27201824
Iteration 69, inertia 99765297.22450702
Converged at iteration 69: strict convergence.
Initialization complete
Iteration 0, inertia 153040135.0880942
Iteration 1, inertia 105266639.46750192
Iteration 2, inertia 102603057.7033755
Iteration 3, inertia 101608878.2482344
Iteration 4, inertia 101084412.15820779
Iteration 5, inertia 100760250.48046531
Iteration 6, inertia 100538322.34367548
Iteration 7, inertia 100371674.32083158
Iteration 8, inertia 100237544.23082168
Iteration 9, inertia 100138589.49535203
Iteration 10, inertia 100062874.62940076
Iteration 11, inertia 99999137.95134205
Iteration 12, inertia 99950693.5290808
Iteration 13, inertia 99907070.1430616
Iteration 14, inertia 99871649.08822012
Iteration 15, inertia 99845332.80897018
Iteration 16, inertia 99824550.2694832
Iteration 17, inertia 99806337.59607607
Iteration 18, inertia 99790113.50628693
Iteration 19, inertia 99778214.10395075
Iteration 20, inertia 99766490.8450273
Iteration 21, inertia 99753430.85749964
Iteration 22, inertia 99739409.50249651
Iteration 23, inertia 99730463.12719332
Iteration 24, inertia 99724511.66652022
Iteration 25, inertia 99719853.4907389
Iteration 26, inertia 99716446.78796765
Iteration 27, inertia 99713826.5624971
Iteration 28, inertia 99711511.9462014
Iteration 29, inertia 99709784.93996455
Iteration 30, inertia 99707859.48407885
Iteration 31, inertia 99706138.46359964
Iteration 32, inertia 99703629.9846575
Iteration 33, inertia 99701587.81301795
Iteration 34, inertia 99700496.9416215
Iteration 35, inertia 99699236.19857787
Iteration 36, inertia 99697514.18678463
Iteration 37, inertia 99694824.85139392
Iteration 38, inertia 99692495.2736928
Iteration 39, inertia 99690041.44971354
Iteration 40, inertia 99688467.74336976
Iteration 41, inertia 99687632.17434652
Iteration 42, inertia 99686946.31677864
Iteration 43, inertia 99686340.75431953
Iteration 44, inertia 99685616.06117183
Iteration 45, inertia 99684818.64523618
Iteration 46, inertia 99683833.42377043
Iteration 47, inertia 99682942.92890927
Iteration 48, inertia 99682195.57706131
Iteration 49, inertia 99681819.70290911
Iteration 50, inertia 99681682.94427851
Iteration 51, inertia 99681474.5719988
Iteration 52, inertia 99681247.14827098
Iteration 53, inertia 99681085.19912262
Iteration 54, inertia 99680985.45268449
Iteration 55, inertia 99680963.00887308
Iteration 56, inertia 99680927.08898173
Iteration 57, inertia 99680887.09292628
Iteration 58, inertia 99680854.85611726
Iteration 59, inertia 99680848.83812937
Converged at iteration 59: strict convergence.
Initialization complete
Iteration 0, inertia 153221725.62651327
Iteration 1, inertia 105376137.51086397
Iteration 2, inertia 102746366.23630545
Iteration 3, inertia 101724821.54799426
Iteration 4, inertia 101185074.39640951
Iteration 5, inertia 100843717.55666581
Iteration 6, inertia 100604424.78338309
Iteration 7, inertia 100424581.85584122
Iteration 8, inertia 100289459.8138843
Iteration 9, inertia 100190300.98634067
Iteration 10, inertia 100112193.01333033
Iteration 11, inertia 100053443.56459615
Iteration 12, inertia 100007080.3643044
Iteration 13, inertia 99963986.7105846
Iteration 14, inertia 99928328.91298361
Iteration 15, inertia 99897226.0041783
Iteration 16, inertia 99870610.2506861
Iteration 17, inertia 99850513.71195313
Iteration 18, inertia 99833256.42110124
Iteration 19, inertia 99819408.73226443
Iteration 20, inertia 99808041.91907084
Iteration 21, inertia 99798164.5152668
Iteration 22, inertia 99792451.31377357
Iteration 23, inertia 99788256.61357561
Iteration 24, inertia 99785385.7418429
Iteration 25, inertia 99783300.26075397
Iteration 26, inertia 99781383.85844234
Iteration 27, inertia 99780166.96709123
Iteration 28, inertia 99779001.4501807
Iteration 29, inertia 99777833.76849353
Iteration 30, inertia 99776915.4561316
Iteration 31, inertia 99776334.52164741
Iteration 32, inertia 99775928.09629661
Iteration 33, inertia 99775699.87916008
Iteration 34, inertia 99775579.14974838
Iteration 35, inertia 99775483.13303956
Iteration 36, inertia 99775421.72961216
Iteration 37, inertia 99775317.70056055
Iteration 38, inertia 99775168.36884698
Iteration 39, inertia 99774909.26461221
Iteration 40, inertia 99774641.88465607
Iteration 41, inertia 99774466.49025653
Iteration 42, inertia 99774285.24890819
Iteration 43, inertia 99774121.73139286
Iteration 44, inertia 99774032.96935536
Iteration 45, inertia 99773872.68604407
Iteration 46, inertia 99773551.15271717
Iteration 47, inertia 99773444.8202005
Iteration 48, inertia 99773342.84176847
Iteration 49, inertia 99773125.48112418
Iteration 50, inertia 99772881.97377768
Iteration 51, inertia 99772663.39076836
Iteration 52, inertia 99772579.13537584
Iteration 53, inertia 99772421.19193219
Iteration 54, inertia 99772235.19405074
Iteration 55, inertia 99772031.47841012
Iteration 56, inertia 99771880.07673496
Iteration 57, inertia 99771708.10208134
Iteration 58, inertia 99771641.6784522
Iteration 59, inertia 99771554.06155579
Iteration 60, inertia 99771439.25661206
Iteration 61, inertia 99771309.65167353
Iteration 62, inertia 99771179.43199639
Iteration 63, inertia 99771059.62134095
Iteration 64, inertia 99770942.09018816
Iteration 65, inertia 99770797.95126142
Iteration 66, inertia 99770627.93615505
Iteration 67, inertia 99770487.9991081
Iteration 68, inertia 99770382.98411213
Iteration 69, inertia 99770103.87309766
Iteration 70, inertia 99769736.49202918
Iteration 71, inertia 99769550.03169478
Iteration 72, inertia 99769414.6996786
Iteration 73, inertia 99769323.0710866
Iteration 74, inertia 99769285.05545107
Iteration 75, inertia 99769244.57378387
Iteration 76, inertia 99769216.02660103
Iteration 77, inertia 99769185.43506464
Iteration 78, inertia 99769128.88890776
Iteration 79, inertia 99769064.91968164
Iteration 80, inertia 99769038.75617883
Iteration 81, inertia 99769020.12205127
Iteration 82, inertia 99768988.79932395
Iteration 83, inertia 99768941.9176849
Iteration 84, inertia 99768887.74012077
Iteration 85, inertia 99768848.3204372
Iteration 86, inertia 99768824.53475642
Iteration 87, inertia 99768796.35908292
Iteration 88, inertia 99768767.4328544
Iteration 89, inertia 99768747.34978001
Converged at iteration 89: strict convergence.
Initialization complete
Iteration 0, inertia 152782922.91350195
Iteration 1, inertia 105392578.33736472
Iteration 2, inertia 102742839.03293195
Iteration 3, inertia 101772130.18103519
Iteration 4, inertia 101216498.26929463
Iteration 5, inertia 100868022.48312819
Iteration 6, inertia 100648923.06753606
Iteration 7, inertia 100492730.26894096
Iteration 8, inertia 100375891.88345513
Iteration 9, inertia 100283782.30737983
Iteration 10, inertia 100206694.89040482
Iteration 11, inertia 100143184.70712602
Iteration 12, inertia 100087789.16834901
Iteration 13, inertia 100042131.08702768
Iteration 14, inertia 100004935.88791205
Iteration 15, inertia 99974648.33232686
Iteration 16, inertia 99947693.78291424
Iteration 17, inertia 99924597.37994058
Iteration 18, inertia 99903142.48625675
Iteration 19, inertia 99884555.33311878
Iteration 20, inertia 99859571.16552484
Iteration 21, inertia 99846948.50517239
Iteration 22, inertia 99839848.2956454
Iteration 23, inertia 99832609.01097828
Iteration 24, inertia 99825989.97714251
Iteration 25, inertia 99820976.75165446
Iteration 26, inertia 99815042.70795554
Iteration 27, inertia 99810405.68252802
Iteration 28, inertia 99807128.92869754
Iteration 29, inertia 99804931.16124794
Iteration 30, inertia 99803082.06418696
Iteration 31, inertia 99802212.69117543
Iteration 32, inertia 99801313.6230923
Iteration 33, inertia 99799827.85583231
Iteration 34, inertia 99798803.00446297
Iteration 35, inertia 99797964.95913716
Iteration 36, inertia 99797413.16200086
Iteration 37, inertia 99796894.86789948
Iteration 38, inertia 99796108.59780566
Iteration 39, inertia 99795581.38092557
Iteration 40, inertia 99795105.61998525
Iteration 41, inertia 99794713.20708768
Iteration 42, inertia 99794005.46685094
Iteration 43, inertia 99793351.3556876
Iteration 44, inertia 99793110.80781361
Iteration 45, inertia 99792979.83960937
Iteration 46, inertia 99792826.9116818
Iteration 47, inertia 99792701.37643951
Converged at iteration 47: strict convergence.
Initialization complete
Iteration 0, inertia 153268298.0437637
Iteration 1, inertia 105290990.94326411
Iteration 2, inertia 102631204.87592539
Iteration 3, inertia 101619113.82686602
Iteration 4, inertia 101087245.44003673
Iteration 5, inertia 100766722.96988605
Iteration 6, inertia 100554123.17275462
Iteration 7, inertia 100403180.40777166
Iteration 8, inertia 100294814.45564196
Iteration 9, inertia 100212615.30339245
Iteration 10, inertia 100151932.3495812
Iteration 11, inertia 100103144.1485531
Iteration 12, inertia 100064304.68257715
Iteration 13, inertia 100031304.40089619
Iteration 14, inertia 100003006.22888514
Iteration 15, inertia 99978253.58851665
Iteration 16, inertia 99960411.73061527
Iteration 17, inertia 99942837.6850878
Iteration 18, inertia 99929509.67787324
Iteration 19, inertia 99919424.98915668
Iteration 20, inertia 99912874.55365182
Iteration 21, inertia 99906972.65082933
Iteration 22, inertia 99902180.76848884
Iteration 23, inertia 99897465.93331742
Iteration 24, inertia 99893981.87526318
Iteration 25, inertia 99889765.3513982
Iteration 26, inertia 99886372.43406105
Iteration 27, inertia 99883974.93725172
Iteration 28, inertia 99880989.29721506
Iteration 29, inertia 99878459.75895213
Iteration 30, inertia 99876845.52193072
Iteration 31, inertia 99875058.98717588
Iteration 32, inertia 99872694.91951926
Iteration 33, inertia 99870059.1549926
Iteration 34, inertia 99866992.25065891
Iteration 35, inertia 99863361.89090681
Iteration 36, inertia 99858998.62126666
Iteration 37, inertia 99853767.07512371
Iteration 38, inertia 99849155.65690312
Iteration 39, inertia 99843387.51241185
Iteration 40, inertia 99839050.31303354
Iteration 41, inertia 99837210.81033362
Iteration 42, inertia 99836784.07610357
Iteration 43, inertia 99836607.43272753
Iteration 44, inertia 99836216.22228748
Iteration 45, inertia 99835984.82841264
Iteration 46, inertia 99835908.90739623
Iteration 47, inertia 99835870.84680593
Iteration 48, inertia 99835848.2720984
Iteration 49, inertia 99835818.64822344
Iteration 50, inertia 99835741.72665037
Iteration 51, inertia 99835648.40614781
Iteration 52, inertia 99835549.8279594
Iteration 53, inertia 99835507.80885151
Iteration 54, inertia 99835472.21594107
Iteration 55, inertia 99835389.71047169
Iteration 56, inertia 99835267.99026838
Iteration 57, inertia 99835186.6703194
Iteration 58, inertia 99835106.13478844
Iteration 59, inertia 99835015.33495778
Iteration 60, inertia 99834963.5722211
Iteration 61, inertia 99834901.56669682
Iteration 62, inertia 99834898.15809293
Converged at iteration 62: strict convergence.
Initialization complete
Iteration 0, inertia 153042399.42177185
Iteration 1, inertia 105204404.45158371
Iteration 2, inertia 102619572.80501576
Iteration 3, inertia 101638171.8927329
Iteration 4, inertia 101101660.215216
Iteration 5, inertia 100748824.75334701
Iteration 6, inertia 100513272.88375023
Iteration 7, inertia 100334902.18634267
Iteration 8, inertia 100201990.95739542
Iteration 9, inertia 100107973.6271131
Iteration 10, inertia 100031823.23427698
Iteration 11, inertia 99970199.05060011
Iteration 12, inertia 99922667.14428724
Iteration 13, inertia 99881751.60221545
Iteration 14, inertia 99847180.13131227
Iteration 15, inertia 99820741.08350311
Iteration 16, inertia 99796485.0322649
Iteration 17, inertia 99776148.76130415
Iteration 18, inertia 99757890.54057114
Iteration 19, inertia 99739562.72415826
Iteration 20, inertia 99723057.7229735
Iteration 21, inertia 99710111.5848964
Iteration 22, inertia 99698174.43620601
Iteration 23, inertia 99684494.25150433
Iteration 24, inertia 99675107.27681798
Iteration 25, inertia 99668147.19876282
Iteration 26, inertia 99663061.3628845
Iteration 27, inertia 99658370.41711396
Iteration 28, inertia 99654381.95435305
Iteration 29, inertia 99651203.46287453
Iteration 30, inertia 99649615.17315821
Iteration 31, inertia 99648124.44947621
Iteration 32, inertia 99646825.77467811
Iteration 33, inertia 99645391.81000654
Iteration 34, inertia 99644273.5929455
Iteration 35, inertia 99642852.11361982
Iteration 36, inertia 99641231.56129329
Iteration 37, inertia 99639740.81773987
Iteration 38, inertia 99637944.57544869
Iteration 39, inertia 99636443.265229
Iteration 40, inertia 99635205.35837081
Iteration 41, inertia 99633913.08066699
Iteration 42, inertia 99632314.97114049
Iteration 43, inertia 99630563.01582026
Iteration 44, inertia 99629212.28362925
Iteration 45, inertia 99627624.67775626
Iteration 46, inertia 99626422.27186745
Iteration 47, inertia 99624108.83895993
Iteration 48, inertia 99622775.09363243
Iteration 49, inertia 99621344.78703798
Iteration 50, inertia 99620205.7881471
Iteration 51, inertia 99619279.10456882
Iteration 52, inertia 99618639.83596122
Iteration 53, inertia 99618211.16859794
Iteration 54, inertia 99617702.555099
Iteration 55, inertia 99617306.58813357
Iteration 56, inertia 99617149.92791802
Iteration 57, inertia 99617131.25121543
Converged at iteration 57: strict convergence.
Initialization complete
Iteration 0, inertia 152975190.85434812
Iteration 1, inertia 105360788.92614873
Iteration 2, inertia 102772755.68122719
Iteration 3, inertia 101800806.64931843
Iteration 4, inertia 101259665.4420935
Iteration 5, inertia 100913781.35131527
Iteration 6, inertia 100686519.57166396
Iteration 7, inertia 100536015.54212832
Iteration 8, inertia 100420901.38015996
Iteration 9, inertia 100329726.00066751
Iteration 10, inertia 100252222.72333069
Iteration 11, inertia 100185759.67752965
Iteration 12, inertia 100133465.84079742
Iteration 13, inertia 100093191.95119904
Iteration 14, inertia 100056288.19515951
Iteration 15, inertia 100023424.1176606
Iteration 16, inertia 99999011.24908489
Iteration 17, inertia 99978575.09135495
Iteration 18, inertia 99963684.97059785
Iteration 19, inertia 99949552.14354867
Iteration 20, inertia 99939734.70470881
Iteration 21, inertia 99931669.53709705
Iteration 22, inertia 99923103.59283938
Iteration 23, inertia 99918133.9394312
Iteration 24, inertia 99914669.35371365
Iteration 25, inertia 99911725.36895807
Iteration 26, inertia 99910018.05198553
Iteration 27, inertia 99908983.58821447
Iteration 28, inertia 99907623.87666042
Iteration 29, inertia 99906671.42586704
Iteration 30, inertia 99905693.12835723
Iteration 31, inertia 99904569.44516096
Iteration 32, inertia 99903916.74312183
Iteration 33, inertia 99903632.62551795
Iteration 34, inertia 99903530.1519289
Iteration 35, inertia 99903488.42739104
Iteration 36, inertia 99903440.60794196
Iteration 37, inertia 99903429.85133773
Iteration 38, inertia 99903405.20360363
Iteration 39, inertia 99903334.01842263
Iteration 40, inertia 99903236.35878739
Iteration 41, inertia 99903178.89116985
Converged at iteration 41: strict convergence.
Filename: code/create_kmeans_clustering.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    10    495.6 MiB    495.6 MiB           1   @profile
    11                                         def kmeans_cluster(P, V, K, output_path, prefix, ref=''):
    12                                             """
    13                                             Uses the point.npy P, vocab.npy V files of a layer (generated using https://github.com/hsajjad/ConceptX/ library) to produce a clustering of <K> clusters at <output_path> named clusters-kmeans-{K}.txt
    14                                             """
    15    495.6 MiB      0.0 MiB           1       kmeans = KMeans(n_clusters=K, verbose=3, random_state=212)
    16    648.3 MiB    152.7 MiB           1       output = kmeans.fit(P)
    17                                             
    18    648.3 MiB      0.0 MiB           1       out_file =  f"{output_path}/{prefix}-clusters-kmeans-{K}{ref}.txt"
    19                                         
    20    648.3 MiB      0.0 MiB        1003       clusters = {i:[] for i in range(K)}
    21                                             
    22    653.3 MiB      0.0 MiB       64043       for v, l in zip(V, output.labels_):
    23    653.3 MiB      5.0 MiB       64042          clusters[l].append(f'{v}|||{l}')
    24                                         
    25                                         
    26    653.3 MiB      0.0 MiB           1       out = ""
    27    657.0 MiB      0.0 MiB        1001       for k,v in clusters.items():
    28    657.0 MiB      3.6 MiB        1000           out += '\n'.join(v) + '\n'
    29                                         
    30                                             
    31    657.0 MiB      0.0 MiB           1       with open(out_file, 'w') as f2:
    32    657.0 MiB      0.0 MiB           1           f2.write(out)
    33                                         
    34    657.0 MiB      0.0 MiB           1       return out


Runtime: 1003.1845200061798
Combined output written to: visualize_1000/layer11/clusters-1000.txt

Completed iteration 11.

Running: ./utils_qcri/clustering.sh 1000 12 visualize
Output for iteration 12:
Preparing for visualize
USAGE: create_kmeans_clustering.py -p <POINT_FILE> -v <VOCAB_FILE> -k <CLUSTERS> -o <OUTPUT_FOLDER>
Initialization complete
Iteration 0, inertia 3042243.711386877
Iteration 1, inertia 2057598.0458570991
Iteration 2, inertia 1989721.5369324144
Iteration 3, inertia 1963846.6443468486
Iteration 4, inertia 1950687.839626136
Iteration 5, inertia 1944308.0838316793
Iteration 6, inertia 1940897.5851683323
Iteration 7, inertia 1938262.7781760218
Iteration 8, inertia 1936003.8733199926
Iteration 9, inertia 1934223.1619120683
Iteration 10, inertia 1933058.508775642
Iteration 11, inertia 1932292.0877001353
Iteration 12, inertia 1931657.9542418101
Iteration 13, inertia 1931159.3294694289
Iteration 14, inertia 1930845.4924694544
Iteration 15, inertia 1930465.4487169918
Iteration 16, inertia 1930090.4691501108
Iteration 17, inertia 1929766.4738379242
Iteration 18, inertia 1929486.2021492375
Iteration 19, inertia 1929188.9901946506
Iteration 20, inertia 1929019.6608646023
Iteration 21, inertia 1928898.0811308473
Iteration 22, inertia 1928832.864135809
Iteration 23, inertia 1928779.1418321135
Iteration 24, inertia 1928749.207689695
Iteration 25, inertia 1928731.683938833
Iteration 26, inertia 1928713.6341599543
Iteration 27, inertia 1928690.9973970714
Iteration 28, inertia 1928670.9188447718
Iteration 29, inertia 1928655.4419925415
Iteration 30, inertia 1928647.2431627854
Iteration 31, inertia 1928641.214499356
Iteration 32, inertia 1928637.3371924271
Iteration 33, inertia 1928633.2756493983
Iteration 34, inertia 1928632.2178123621
Iteration 35, inertia 1928632.1546212484
Iteration 36, inertia 1928632.1057375611
Iteration 37, inertia 1928632.0218763684
Iteration 38, inertia 1928631.997050686
Iteration 39, inertia 1928631.9808164646
Iteration 40, inertia 1928631.968825578
Iteration 41, inertia 1928631.9579897728
Iteration 42, inertia 1928631.949974703
Converged at iteration 42: strict convergence.
Initialization complete
Iteration 0, inertia 3052565.8788024434
Iteration 1, inertia 2058157.5582812054
Iteration 2, inertia 1990796.451788179
Iteration 3, inertia 1964185.4923252773
Iteration 4, inertia 1951176.5003983686
Iteration 5, inertia 1946020.4298396776
Iteration 6, inertia 1942481.4133038605
Iteration 7, inertia 1939903.6299613998
Iteration 8, inertia 1938015.2121387012
Iteration 9, inertia 1936498.8582270222
Iteration 10, inertia 1935511.7795815612
Iteration 11, inertia 1934694.7792206663
Iteration 12, inertia 1933998.8506153817
Iteration 13, inertia 1933523.0087368356
Iteration 14, inertia 1933120.8355168663
Iteration 15, inertia 1932768.125701298
Iteration 16, inertia 1932529.4912778111
Iteration 17, inertia 1932315.2059755523
Iteration 18, inertia 1932159.7811419284
Iteration 19, inertia 1931994.854495081
Iteration 20, inertia 1931878.0334169685
Iteration 21, inertia 1931792.1604552683
Iteration 22, inertia 1931689.6970643557
Iteration 23, inertia 1931618.0241147866
Iteration 24, inertia 1931597.4965354558
Iteration 25, inertia 1931579.2324346567
Iteration 26, inertia 1931570.041363617
Iteration 27, inertia 1931567.434282435
Iteration 28, inertia 1931564.0007370037
Iteration 29, inertia 1931562.0753223195
Iteration 30, inertia 1931561.442947114
Iteration 31, inertia 1931561.4155042681
Iteration 32, inertia 1931561.405363801
Iteration 33, inertia 1931561.394196046
Iteration 34, inertia 1931561.3793611554
Converged at iteration 34: strict convergence.
Initialization complete
Iteration 0, inertia 3047599.712850726
Iteration 1, inertia 2054323.211604479
Iteration 2, inertia 1987294.7604362953
Iteration 3, inertia 1962773.3194432962
Iteration 4, inertia 1949496.8328039246
Iteration 5, inertia 1943706.8505733132
Iteration 6, inertia 1940099.7187271097
Iteration 7, inertia 1937737.2142646548
Iteration 8, inertia 1935734.7401708
Iteration 9, inertia 1933809.9590841448
Iteration 10, inertia 1932345.9625890434
Iteration 11, inertia 1931461.0364572683
Iteration 12, inertia 1930852.8329292955
Iteration 13, inertia 1930284.9913653587
Iteration 14, inertia 1929773.6476812197
Iteration 15, inertia 1929395.8623694156
Iteration 16, inertia 1929091.759895997
Iteration 17, inertia 1928786.475630962
Iteration 18, inertia 1928549.6124170811
Iteration 19, inertia 1928403.28296307
Iteration 20, inertia 1928297.5320855726
Iteration 21, inertia 1928201.7202562625
Iteration 22, inertia 1928120.9490537252
Iteration 23, inertia 1928054.952377009
Iteration 24, inertia 1928014.120494644
Iteration 25, inertia 1927965.9926328957
Iteration 26, inertia 1927933.387156877
Iteration 27, inertia 1927873.1705532768
Iteration 28, inertia 1927811.7421519523
Iteration 29, inertia 1927747.8478908164
Iteration 30, inertia 1927688.9239187478
Iteration 31, inertia 1927648.514884396
Iteration 32, inertia 1927624.8758060748
Iteration 33, inertia 1927611.9878036499
Iteration 34, inertia 1927598.2396107616
Iteration 35, inertia 1927586.5124215481
Iteration 36, inertia 1927572.8594005238
Iteration 37, inertia 1927565.3813985852
Iteration 38, inertia 1927559.0807325242
Iteration 39, inertia 1927553.3534020302
Iteration 40, inertia 1927548.7855610892
Iteration 41, inertia 1927544.3208401294
Iteration 42, inertia 1927538.1906041936
Iteration 43, inertia 1927530.0364911542
Iteration 44, inertia 1927514.7959172751
Iteration 45, inertia 1927466.9223636263
Iteration 46, inertia 1927448.9477850676
Iteration 47, inertia 1927440.8284135947
Iteration 48, inertia 1927432.7500960245
Iteration 49, inertia 1927422.633655542
Iteration 50, inertia 1927417.3394519126
Iteration 51, inertia 1927414.3440766933
Iteration 52, inertia 1927409.2238620294
Iteration 53, inertia 1927402.8369981993
Iteration 54, inertia 1927399.1891836538
Iteration 55, inertia 1927392.423002585
Iteration 56, inertia 1927371.4013260296
Iteration 57, inertia 1927349.7336901221
Iteration 58, inertia 1927328.0051911944
Iteration 59, inertia 1927310.3977220207
Iteration 60, inertia 1927302.6249806774
Iteration 61, inertia 1927295.5427916504
Iteration 62, inertia 1927292.4082064268
Iteration 63, inertia 1927289.5288923737
Iteration 64, inertia 1927287.846583367
Iteration 65, inertia 1927285.9025273696
Iteration 66, inertia 1927283.684762011
Iteration 67, inertia 1927280.4115195528
Iteration 68, inertia 1927279.3411391014
Iteration 69, inertia 1927276.305018418
Iteration 70, inertia 1927271.42425181
Iteration 71, inertia 1927263.3669411263
Iteration 72, inertia 1927257.3007272778
Iteration 73, inertia 1927254.4030912085
Iteration 74, inertia 1927254.2991613434
Iteration 75, inertia 1927254.2011506553
Iteration 76, inertia 1927254.070200531
Iteration 77, inertia 1927253.7724319098
Iteration 78, inertia 1927253.3776700401
Iteration 79, inertia 1927253.27316425
Iteration 80, inertia 1927253.170835883
Iteration 81, inertia 1927253.0955523315
Iteration 82, inertia 1927252.9315348633
Iteration 83, inertia 1927252.6791157231
Iteration 84, inertia 1927252.5585972464
Iteration 85, inertia 1927252.4954061327
Iteration 86, inertia 1927252.4465224454
Iteration 87, inertia 1927252.362661253
Iteration 88, inertia 1927252.3378355706
Iteration 89, inertia 1927252.3216013494
Iteration 90, inertia 1927252.3096104627
Iteration 91, inertia 1927252.2987746573
Iteration 92, inertia 1927252.290759588
Converged at iteration 92: strict convergence.
Initialization complete
Iteration 0, inertia 3057210.6540653864
Iteration 1, inertia 2055645.8400958993
Iteration 2, inertia 1987744.544264722
Iteration 3, inertia 1962513.077883338
Iteration 4, inertia 1948462.196192479
Iteration 5, inertia 1941318.221435882
Iteration 6, inertia 1937217.7261803788
Iteration 7, inertia 1934645.1207098544
Iteration 8, inertia 1932751.3198144974
Iteration 9, inertia 1931349.268477085
Iteration 10, inertia 1930275.2812482817
Iteration 11, inertia 1929621.0461897657
Iteration 12, inertia 1929067.0723341585
Iteration 13, inertia 1928589.6034304267
Iteration 14, inertia 1928177.5882934206
Iteration 15, inertia 1927914.7529522846
Iteration 16, inertia 1927632.8514986625
Iteration 17, inertia 1927480.59896254
Iteration 18, inertia 1927365.849742984
Iteration 19, inertia 1927218.6199833294
Iteration 20, inertia 1927090.825561734
Iteration 21, inertia 1927010.448391969
Iteration 22, inertia 1926899.068005854
Iteration 23, inertia 1926844.0085005458
Iteration 24, inertia 1926826.9677384724
Iteration 25, inertia 1926816.0827026756
Iteration 26, inertia 1926792.9319094564
Iteration 27, inertia 1926765.5847499592
Iteration 28, inertia 1926741.5174016885
Iteration 29, inertia 1926730.87789244
Iteration 30, inertia 1926723.6461181608
Iteration 31, inertia 1926715.4159918253
Iteration 32, inertia 1926709.2449063389
Iteration 33, inertia 1926690.9624533283
Iteration 34, inertia 1926678.5905853792
Iteration 35, inertia 1926666.3992102449
Iteration 36, inertia 1926658.0400880366
Iteration 37, inertia 1926651.9527383351
Iteration 38, inertia 1926644.9193609955
Iteration 39, inertia 1926642.5441402134
Iteration 40, inertia 1926641.035745256
Iteration 41, inertia 1926638.9510839847
Iteration 42, inertia 1926637.1039388787
Iteration 43, inertia 1926634.4833675984
Iteration 44, inertia 1926631.636301363
Iteration 45, inertia 1926629.50259618
Iteration 46, inertia 1926628.101876218
Iteration 47, inertia 1926625.840361266
Iteration 48, inertia 1926622.784795642
Iteration 49, inertia 1926618.996493799
Iteration 50, inertia 1926614.1601632745
Iteration 51, inertia 1926610.272441132
Iteration 52, inertia 1926607.4959052575
Iteration 53, inertia 1926605.8288088723
Iteration 54, inertia 1926604.682717714
Iteration 55, inertia 1926602.3207031165
Iteration 56, inertia 1926599.792200381
Iteration 57, inertia 1926597.2045906305
Iteration 58, inertia 1926595.1439673859
Iteration 59, inertia 1926592.6459836836
Iteration 60, inertia 1926591.1034683562
Iteration 61, inertia 1926589.5599088664
Iteration 62, inertia 1926587.4392585733
Iteration 63, inertia 1926584.8246864278
Iteration 64, inertia 1926583.1535712343
Iteration 65, inertia 1926581.3333536575
Iteration 66, inertia 1926579.7023078518
Iteration 67, inertia 1926578.2791453912
Iteration 68, inertia 1926577.677282979
Iteration 69, inertia 1926577.275172213
Iteration 70, inertia 1926576.9428169103
Iteration 71, inertia 1926576.696721833
Iteration 72, inertia 1926576.5742115478
Iteration 73, inertia 1926576.4532392172
Iteration 74, inertia 1926576.3666378409
Iteration 75, inertia 1926576.2928965257
Iteration 76, inertia 1926576.2661702898
Iteration 77, inertia 1926576.2575643554
Iteration 78, inertia 1926576.231334263
Iteration 79, inertia 1926576.2061045994
Iteration 80, inertia 1926576.188783994
Iteration 81, inertia 1926576.1524340638
Iteration 82, inertia 1926576.0414815359
Iteration 83, inertia 1926575.908971421
Iteration 84, inertia 1926575.5691111702
Iteration 85, inertia 1926574.8926405432
Iteration 86, inertia 1926574.1067473965
Iteration 87, inertia 1926573.9284768777
Iteration 88, inertia 1926573.725778114
Iteration 89, inertia 1926573.638139452
Iteration 90, inertia 1926573.5441829727
Iteration 91, inertia 1926573.365480578
Iteration 92, inertia 1926573.3165572349
Iteration 93, inertia 1926573.2792864311
Iteration 94, inertia 1926573.2471457904
Iteration 95, inertia 1926573.2374958687
Converged at iteration 95: strict convergence.
Initialization complete
Iteration 0, inertia 3030016.402687901
Iteration 1, inertia 2057890.3657758748
Iteration 2, inertia 1986372.358250428
Iteration 3, inertia 1959014.12265392
Iteration 4, inertia 1944357.124394576
Iteration 5, inertia 1938103.357885001
Iteration 6, inertia 1934734.642355468
Iteration 7, inertia 1932787.103813193
Iteration 8, inertia 1931644.81187054
Iteration 9, inertia 1930707.7161530964
Iteration 10, inertia 1929987.5614821196
Iteration 11, inertia 1929479.6833874027
Iteration 12, inertia 1929053.1488124595
Iteration 13, inertia 1928735.3483492546
Iteration 14, inertia 1928451.9953095128
Iteration 15, inertia 1928198.9574046682
Iteration 16, inertia 1927904.0886953573
Iteration 17, inertia 1927573.6817803925
Iteration 18, inertia 1927240.2413962262
Iteration 19, inertia 1927011.444333663
Iteration 20, inertia 1926868.197076343
Iteration 21, inertia 1926799.2852169876
Iteration 22, inertia 1926737.6131988456
Iteration 23, inertia 1926691.568544742
Iteration 24, inertia 1926632.6237863041
Iteration 25, inertia 1926580.1355790026
Iteration 26, inertia 1926530.5520991147
Iteration 27, inertia 1926481.1440004513
Iteration 28, inertia 1926419.5340611853
Iteration 29, inertia 1926385.0477413686
Iteration 30, inertia 1926360.2055698335
Iteration 31, inertia 1926347.2760112686
Iteration 32, inertia 1926340.5423031715
Iteration 33, inertia 1926331.7275062168
Iteration 34, inertia 1926323.737401935
Iteration 35, inertia 1926312.8123011373
Iteration 36, inertia 1926302.6566967822
Iteration 37, inertia 1926297.551743836
Iteration 38, inertia 1926291.5192487228
Iteration 39, inertia 1926285.2884785768
Iteration 40, inertia 1926281.4342713938
Iteration 41, inertia 1926277.5864645457
Iteration 42, inertia 1926273.4534155594
Iteration 43, inertia 1926270.2415908675
Iteration 44, inertia 1926269.617442344
Iteration 45, inertia 1926269.1023357112
Iteration 46, inertia 1926268.7463906289
Iteration 47, inertia 1926268.6021813026
Iteration 48, inertia 1926268.493529924
Iteration 49, inertia 1926268.4332436118
Iteration 50, inertia 1926268.423888961
Iteration 51, inertia 1926268.410313279
Iteration 52, inertia 1926268.402873354
Converged at iteration 52: strict convergence.
Initialization complete
Iteration 0, inertia 3052177.859441479
Iteration 1, inertia 2053918.0317724138
Iteration 2, inertia 1985808.7866940096
Iteration 3, inertia 1958331.1464118864
Iteration 4, inertia 1945276.4180259418
Iteration 5, inertia 1939353.5614114655
Iteration 6, inertia 1935439.979119311
Iteration 7, inertia 1932489.2613112193
Iteration 8, inertia 1930309.9446289397
Iteration 9, inertia 1928599.5363381158
Iteration 10, inertia 1927602.9858280318
Iteration 11, inertia 1926901.2743911282
Iteration 12, inertia 1926410.127266945
Iteration 13, inertia 1925992.3165354824
Iteration 14, inertia 1925558.6372059248
Iteration 15, inertia 1925251.82441547
Iteration 16, inertia 1924860.868091555
Iteration 17, inertia 1924582.8120582046
Iteration 18, inertia 1924320.0806301641
Iteration 19, inertia 1924112.9744087267
Iteration 20, inertia 1923868.3039119046
Iteration 21, inertia 1923731.7941777834
Iteration 22, inertia 1923621.052664811
Iteration 23, inertia 1923552.7206319063
Iteration 24, inertia 1923500.3758993382
Iteration 25, inertia 1923459.385274015
Iteration 26, inertia 1923408.3381221704
Iteration 27, inertia 1923381.8677849846
Iteration 28, inertia 1923360.4809447655
Iteration 29, inertia 1923324.5378057498
Iteration 30, inertia 1923282.0190439639
Iteration 31, inertia 1923260.156314131
Iteration 32, inertia 1923247.9469846562
Iteration 33, inertia 1923242.013009918
Iteration 34, inertia 1923239.2381163705
Iteration 35, inertia 1923236.4580319845
Iteration 36, inertia 1923233.8014869294
Converged at iteration 36: strict convergence.
Initialization complete
Iteration 0, inertia 3053227.2010468673
Iteration 1, inertia 2054113.9522583056
Iteration 2, inertia 1987044.9466143486
Iteration 3, inertia 1960827.775139042
Iteration 4, inertia 1947972.5523260776
Iteration 5, inertia 1940920.8290043182
Iteration 6, inertia 1936583.4394697337
Iteration 7, inertia 1933559.233756542
Iteration 8, inertia 1931107.5005929805
Iteration 9, inertia 1929510.257799006
Iteration 10, inertia 1928185.7791608253
Iteration 11, inertia 1927220.9566253056
Iteration 12, inertia 1926576.053167613
Iteration 13, inertia 1926035.1831233809
Iteration 14, inertia 1925548.0858529997
Iteration 15, inertia 1925188.1637309964
Iteration 16, inertia 1924838.9537560241
Iteration 17, inertia 1924531.15127724
Iteration 18, inertia 1924303.0243683173
Iteration 19, inertia 1924101.891310277
Iteration 20, inertia 1923932.893468764
Iteration 21, inertia 1923859.7014120626
Iteration 22, inertia 1923829.1894054904
Iteration 23, inertia 1923814.2597352504
Iteration 24, inertia 1923803.1897418844
Iteration 25, inertia 1923795.652619274
Iteration 26, inertia 1923788.1941193338
Iteration 27, inertia 1923784.8559651754
Iteration 28, inertia 1923782.3111164384
Iteration 29, inertia 1923779.3795489473
Iteration 30, inertia 1923777.2388258069
Iteration 31, inertia 1923775.4896089756
Iteration 32, inertia 1923773.1936674535
Iteration 33, inertia 1923770.6018150845
Iteration 34, inertia 1923768.7982967633
Iteration 35, inertia 1923767.0445952956
Iteration 36, inertia 1923764.6401073185
Iteration 37, inertia 1923762.2385730012
Iteration 38, inertia 1923760.192252873
Iteration 39, inertia 1923758.7878886831
Iteration 40, inertia 1923758.098697292
Iteration 41, inertia 1923757.5918718213
Iteration 42, inertia 1923757.0890017515
Iteration 43, inertia 1923756.6225337847
Iteration 44, inertia 1923756.1267344523
Iteration 45, inertia 1923755.7492874416
Iteration 46, inertia 1923755.514262792
Iteration 47, inertia 1923755.4063843905
Iteration 48, inertia 1923755.2937678464
Iteration 49, inertia 1923755.213860363
Iteration 50, inertia 1923755.1019031992
Iteration 51, inertia 1923755.0425400103
Iteration 52, inertia 1923754.9572905302
Iteration 53, inertia 1923754.876130676
Iteration 54, inertia 1923754.7722008105
Iteration 55, inertia 1923754.6741901226
Iteration 56, inertia 1923754.5432399982
Iteration 57, inertia 1923754.2454713776
Iteration 58, inertia 1923753.8507095075
Iteration 59, inertia 1923753.7462037168
Iteration 60, inertia 1923753.64387535
Iteration 61, inertia 1923753.568591799
Iteration 62, inertia 1923753.4045743311
Iteration 63, inertia 1923753.1521551902
Iteration 64, inertia 1923753.0316367145
Iteration 65, inertia 1923752.9684456005
Iteration 66, inertia 1923752.9195619135
Iteration 67, inertia 1923752.8357007203
Iteration 68, inertia 1923752.810875038
Iteration 69, inertia 1923752.7946408167
Iteration 70, inertia 1923752.7826499306
Iteration 71, inertia 1923752.7718141247
Iteration 72, inertia 1923752.7637990552
Converged at iteration 72: strict convergence.
Initialization complete
Iteration 0, inertia 3043454.7729871897
Iteration 1, inertia 2063102.2170950363
Iteration 2, inertia 1992066.3834291562
Iteration 3, inertia 1964138.7267851015
Iteration 4, inertia 1950401.1380055551
Iteration 5, inertia 1944705.1004682367
Iteration 6, inertia 1941303.6768204593
Iteration 7, inertia 1939393.7061687252
Iteration 8, inertia 1938056.0400923123
Iteration 9, inertia 1936964.8147891143
Iteration 10, inertia 1935639.3343861755
Iteration 11, inertia 1934569.5482991864
Iteration 12, inertia 1933556.2407346617
Iteration 13, inertia 1932961.805669677
Iteration 14, inertia 1932480.0181651462
Iteration 15, inertia 1931981.7740586568
Iteration 16, inertia 1931691.547323405
Iteration 17, inertia 1931504.8069192192
Iteration 18, inertia 1931409.846129332
Iteration 19, inertia 1931295.5122403267
Iteration 20, inertia 1931194.6265372029
Iteration 21, inertia 1931105.1395219304
Iteration 22, inertia 1930885.7618903166
Iteration 23, inertia 1930800.7924814858
Iteration 24, inertia 1930738.5156183052
Iteration 25, inertia 1930673.4434775696
Iteration 26, inertia 1930599.633891712
Iteration 27, inertia 1930541.7324948492
Iteration 28, inertia 1930498.2630308822
Iteration 29, inertia 1930461.0395162746
Iteration 30, inertia 1930433.9301160246
Iteration 31, inertia 1930402.9612043959
Iteration 32, inertia 1930372.6209565513
Iteration 33, inertia 1930339.0778877004
Iteration 34, inertia 1930305.2800524647
Iteration 35, inertia 1930266.2310512692
Iteration 36, inertia 1930244.9672894946
Iteration 37, inertia 1930235.3334284415
Iteration 38, inertia 1930226.2279321605
Iteration 39, inertia 1930219.6793120683
Iteration 40, inertia 1930207.6882553936
Iteration 41, inertia 1930199.9726292905
Iteration 42, inertia 1930198.7837268023
Iteration 43, inertia 1930198.3453226383
Converged at iteration 43: strict convergence.
Initialization complete
Iteration 0, inertia 3047633.4765868876
Iteration 1, inertia 2051005.4315649872
Iteration 2, inertia 1982555.761934795
Iteration 3, inertia 1955926.1014884347
Iteration 4, inertia 1942509.3016401355
Iteration 5, inertia 1937044.479598522
Iteration 6, inertia 1933798.2611815825
Iteration 7, inertia 1931608.3647850158
Iteration 8, inertia 1929940.7908743687
Iteration 9, inertia 1928557.9979652604
Iteration 10, inertia 1927474.2684450047
Iteration 11, inertia 1926743.6727986254
Iteration 12, inertia 1926122.8599028934
Iteration 13, inertia 1925679.3745038332
Iteration 14, inertia 1925189.769340816
Iteration 15, inertia 1924706.0872155163
Iteration 16, inertia 1924257.1502358555
Iteration 17, inertia 1923960.3304851535
Iteration 18, inertia 1923746.0448881062
Iteration 19, inertia 1923588.9843114987
Iteration 20, inertia 1923385.183588783
Iteration 21, inertia 1923264.043955837
Iteration 22, inertia 1923184.4032785685
Iteration 23, inertia 1923125.7305528854
Iteration 24, inertia 1923049.8656189623
Iteration 25, inertia 1922934.8779287203
Iteration 26, inertia 1922850.7573875482
Iteration 27, inertia 1922795.3660582858
Iteration 28, inertia 1922731.4512999905
Iteration 29, inertia 1922679.3803331882
Iteration 30, inertia 1922629.9113887807
Iteration 31, inertia 1922584.5408366746
Iteration 32, inertia 1922538.9892122033
Iteration 33, inertia 1922511.425928832
Iteration 34, inertia 1922502.7105644285
Iteration 35, inertia 1922496.7266763751
Iteration 36, inertia 1922490.5840730704
Iteration 37, inertia 1922487.3147189948
Iteration 38, inertia 1922484.3682934742
Iteration 39, inertia 1922479.2382554738
Iteration 40, inertia 1922466.5769105288
Iteration 41, inertia 1922459.5669827263
Iteration 42, inertia 1922457.7082946454
Iteration 43, inertia 1922455.1753822295
Iteration 44, inertia 1922448.2993376472
Iteration 45, inertia 1922426.0612597037
Iteration 46, inertia 1922405.685767345
Iteration 47, inertia 1922381.7087023868
Iteration 48, inertia 1922366.8142289945
Iteration 49, inertia 1922364.1062504877
Iteration 50, inertia 1922363.0963002155
Iteration 51, inertia 1922362.304135132
Converged at iteration 51: strict convergence.
Initialization complete
Iteration 0, inertia 3051066.028037913
Iteration 1, inertia 2056614.22399966
Iteration 2, inertia 1988101.3634339848
Iteration 3, inertia 1960510.581160086
Iteration 4, inertia 1945556.1573276608
Iteration 5, inertia 1939019.4469666723
Iteration 6, inertia 1934539.5705606109
Iteration 7, inertia 1931822.4334539236
Iteration 8, inertia 1929699.9603838988
Iteration 9, inertia 1927916.5176914004
Iteration 10, inertia 1926772.980660847
Iteration 11, inertia 1925770.3636879458
Iteration 12, inertia 1924872.505263834
Iteration 13, inertia 1924172.7232890355
Iteration 14, inertia 1923771.7703495577
Iteration 15, inertia 1923607.8614231243
Iteration 16, inertia 1923460.2156625148
Iteration 17, inertia 1923346.4475367996
Iteration 18, inertia 1923216.8580133491
Iteration 19, inertia 1923056.1688644004
Iteration 20, inertia 1922924.4321209795
Iteration 21, inertia 1922841.0725602955
Iteration 22, inertia 1922783.024290738
Iteration 23, inertia 1922734.9438629036
Iteration 24, inertia 1922684.4773486617
Iteration 25, inertia 1922617.0282095834
Iteration 26, inertia 1922478.8001914965
Iteration 27, inertia 1922416.1370023417
Iteration 28, inertia 1922341.720786312
Iteration 29, inertia 1922260.3653319825
Iteration 30, inertia 1922194.5137984024
Iteration 31, inertia 1922143.84853376
Iteration 32, inertia 1922100.469669167
Iteration 33, inertia 1922088.2779097576
Iteration 34, inertia 1922076.0983896374
Iteration 35, inertia 1922031.9004327871
Iteration 36, inertia 1922003.61943013
Iteration 37, inertia 1921989.4457795403
Iteration 38, inertia 1921987.8808603303
Iteration 39, inertia 1921984.1520721125
Iteration 40, inertia 1921980.8633471054
Iteration 41, inertia 1921978.3115304583
Iteration 42, inertia 1921975.6409668566
Iteration 43, inertia 1921974.9094660704
Converged at iteration 43: strict convergence.
Filename: code/create_kmeans_clustering.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    10    550.8 MiB    550.8 MiB           1   @profile
    11                                         def kmeans_cluster(P, V, K, output_path, prefix, ref=''):
    12                                             """
    13                                             Uses the point.npy P, vocab.npy V files of a layer (generated using https://github.com/hsajjad/ConceptX/ library) to produce a clustering of <K> clusters at <output_path> named clusters-kmeans-{K}.txt
    14                                             """
    15    550.8 MiB      0.0 MiB           1       kmeans = KMeans(n_clusters=K, verbose=3, random_state=212)
    16    694.0 MiB    143.1 MiB           1       output = kmeans.fit(P)
    17                                             
    18    694.0 MiB      0.0 MiB           1       out_file =  f"{output_path}/{prefix}-clusters-kmeans-{K}{ref}.txt"
    19                                         
    20    694.0 MiB      0.0 MiB        1003       clusters = {i:[] for i in range(K)}
    21                                             
    22    700.0 MiB      0.0 MiB       72899       for v, l in zip(V, output.labels_):
    23    700.0 MiB      6.0 MiB       72898          clusters[l].append(f'{v}|||{l}')
    24                                         
    25                                         
    26    700.0 MiB      0.0 MiB           1       out = ""
    27    709.0 MiB      0.0 MiB        1001       for k,v in clusters.items():
    28    709.0 MiB      9.0 MiB        1000           out += '\n'.join(v) + '\n'
    29                                         
    30                                             
    31    709.0 MiB      0.0 MiB           1       with open(out_file, 'w') as f2:
    32    710.2 MiB      1.3 MiB           1           f2.write(out)
    33                                         
    34    710.2 MiB      0.0 MiB           1       return out


Runtime: 1068.5126662254333
USAGE: create_kmeans_clustering.py -p <POINT_FILE> -v <VOCAB_FILE> -k <CLUSTERS> -o <OUTPUT_FOLDER>
Initialization complete
Iteration 0, inertia 260498417.6783476
Iteration 1, inertia 179636271.6407851
Iteration 2, inertia 175333620.4830471
Iteration 3, inertia 173717947.5417417
Iteration 4, inertia 172887779.31894013
Iteration 5, inertia 172311070.6322172
Iteration 6, inertia 171927847.9341236
Iteration 7, inertia 171669907.91125056
Iteration 8, inertia 171478855.50748938
Iteration 9, inertia 171326389.17616203
Iteration 10, inertia 171214196.7395578
Iteration 11, inertia 171122993.57979792
Iteration 12, inertia 171042879.08232704
Iteration 13, inertia 170967754.0243284
Iteration 14, inertia 170911469.24811047
Iteration 15, inertia 170859251.65141112
Iteration 16, inertia 170812711.0352081
Iteration 17, inertia 170775857.34149328
Iteration 18, inertia 170747759.00226954
Iteration 19, inertia 170728092.61084408
Iteration 20, inertia 170708696.23850024
Iteration 21, inertia 170693764.9024083
Iteration 22, inertia 170679022.5229293
Iteration 23, inertia 170662666.77684638
Iteration 24, inertia 170644370.13276073
Iteration 25, inertia 170627044.25015298
Iteration 26, inertia 170613678.04944983
Iteration 27, inertia 170605184.43081865
Iteration 28, inertia 170599702.29109934
Iteration 29, inertia 170596152.20558506
Iteration 30, inertia 170592844.28557092
Iteration 31, inertia 170590594.899209
Iteration 32, inertia 170588419.24016842
Iteration 33, inertia 170585762.05673838
Iteration 34, inertia 170583186.37754795
Iteration 35, inertia 170581440.35306022
Iteration 36, inertia 170579585.12937266
Iteration 37, inertia 170577951.31839353
Iteration 38, inertia 170577307.2734558
Iteration 39, inertia 170576366.84382468
Iteration 40, inertia 170575545.0466618
Iteration 41, inertia 170575105.2506423
Iteration 42, inertia 170574495.24089247
Iteration 43, inertia 170574182.3242154
Iteration 44, inertia 170573838.27178568
Iteration 45, inertia 170573352.06381726
Iteration 46, inertia 170573230.82102832
Iteration 47, inertia 170572961.07021743
Iteration 48, inertia 170572925.06952518
Converged at iteration 48: strict convergence.
Initialization complete
Iteration 0, inertia 259680750.873075
Iteration 1, inertia 179798655.21519476
Iteration 2, inertia 175247844.0109204
Iteration 3, inertia 173579166.89413968
Iteration 4, inertia 172694938.4502551
Iteration 5, inertia 172146415.8243092
Iteration 6, inertia 171781621.53095642
Iteration 7, inertia 171497321.30910173
Iteration 8, inertia 171293323.66196796
Iteration 9, inertia 171134358.21089333
Iteration 10, inertia 171015954.41570276
Iteration 11, inertia 170931020.36252633
Iteration 12, inertia 170859656.2122352
Iteration 13, inertia 170801019.80400443
Iteration 14, inertia 170755341.44360802
Iteration 15, inertia 170713594.16632605
Iteration 16, inertia 170676563.027999
Iteration 17, inertia 170649336.10500225
Iteration 18, inertia 170624264.67811847
Iteration 19, inertia 170605874.86324203
Iteration 20, inertia 170589880.07450807
Iteration 21, inertia 170574653.504234
Iteration 22, inertia 170561749.2084764
Iteration 23, inertia 170548685.07045516
Iteration 24, inertia 170539996.9802507
Iteration 25, inertia 170531359.07922208
Iteration 26, inertia 170521481.14521322
Iteration 27, inertia 170513087.86049873
Iteration 28, inertia 170505842.82482973
Iteration 29, inertia 170501382.94783127
Iteration 30, inertia 170496919.96492285
Iteration 31, inertia 170491522.09300122
Iteration 32, inertia 170486503.7256327
Iteration 33, inertia 170483241.4851671
Iteration 34, inertia 170480562.48854274
Iteration 35, inertia 170478711.61080256
Iteration 36, inertia 170477130.92761797
Iteration 37, inertia 170475635.80679414
Iteration 38, inertia 170474498.36808425
Iteration 39, inertia 170473624.22471678
Iteration 40, inertia 170472965.54273996
Iteration 41, inertia 170472611.6428977
Iteration 42, inertia 170472240.57831582
Iteration 43, inertia 170471980.06448254
Iteration 44, inertia 170471834.7390237
Iteration 45, inertia 170471615.6089022
Iteration 46, inertia 170471497.74773514
Iteration 47, inertia 170471424.73415908
Iteration 48, inertia 170471300.04569447
Iteration 49, inertia 170471211.53645316
Iteration 50, inertia 170471176.41437706
Iteration 51, inertia 170471137.86898574
Iteration 52, inertia 170471114.3402255
Iteration 53, inertia 170470947.10432532
Iteration 54, inertia 170470830.41543016
Iteration 55, inertia 170470722.97987145
Converged at iteration 55: strict convergence.
Initialization complete
Iteration 0, inertia 260189407.97216666
Iteration 1, inertia 180143762.13808525
Iteration 2, inertia 175703098.55297902
Iteration 3, inertia 173956170.20548955
Iteration 4, inertia 172926295.6447326
Iteration 5, inertia 172284231.13453943
Iteration 6, inertia 171881819.87355143
Iteration 7, inertia 171617370.45217305
Iteration 8, inertia 171416788.6825177
Iteration 9, inertia 171271284.49396178
Iteration 10, inertia 171170572.66971925
Iteration 11, inertia 171096725.96506712
Iteration 12, inertia 171036654.90934843
Iteration 13, inertia 170989041.2019643
Iteration 14, inertia 170952447.54267612
Iteration 15, inertia 170920407.66212735
Iteration 16, inertia 170892398.39766136
Iteration 17, inertia 170869577.9224177
Iteration 18, inertia 170848123.25114948
Iteration 19, inertia 170829756.81177723
Iteration 20, inertia 170812828.53423345
Iteration 21, inertia 170794273.232916
Iteration 22, inertia 170766334.29766524
Iteration 23, inertia 170752258.6509194
Iteration 24, inertia 170742687.64192465
Iteration 25, inertia 170734198.79909426
Iteration 26, inertia 170727134.41551968
Iteration 27, inertia 170718664.49776435
Iteration 28, inertia 170711380.17423218
Iteration 29, inertia 170706130.27275681
Iteration 30, inertia 170702291.8903801
Iteration 31, inertia 170698933.38884592
Iteration 32, inertia 170697901.98916543
Iteration 33, inertia 170697282.46257177
Iteration 34, inertia 170696995.59761485
Iteration 35, inertia 170696557.9064781
Iteration 36, inertia 170696147.4076676
Iteration 37, inertia 170695796.34960353
Iteration 38, inertia 170695563.11612144
Iteration 39, inertia 170695536.93465054
Iteration 40, inertia 170695500.7244228
Converged at iteration 40: strict convergence.
Initialization complete
Iteration 0, inertia 259845852.2754576
Iteration 1, inertia 179616923.64246038
Iteration 2, inertia 175125772.3297437
Iteration 3, inertia 173518242.3318614
Iteration 4, inertia 172673818.95192134
Iteration 5, inertia 172142381.67251584
Iteration 6, inertia 171786561.47713086
Iteration 7, inertia 171525138.65575308
Iteration 8, inertia 171349085.57965955
Iteration 9, inertia 171189249.16289183
Iteration 10, inertia 171061688.0490685
Iteration 11, inertia 170967135.43027687
Iteration 12, inertia 170899276.00027207
Iteration 13, inertia 170846465.08791906
Iteration 14, inertia 170799793.30247742
Iteration 15, inertia 170756095.92473912
Iteration 16, inertia 170719550.23431924
Iteration 17, inertia 170688419.18847352
Iteration 18, inertia 170663711.45198965
Iteration 19, inertia 170643517.275617
Iteration 20, inertia 170625886.37541515
Iteration 21, inertia 170612620.08243382
Iteration 22, inertia 170601281.52311373
Iteration 23, inertia 170591372.10866004
Iteration 24, inertia 170585551.40503928
Iteration 25, inertia 170580467.29994428
Iteration 26, inertia 170576339.8011406
Iteration 27, inertia 170571965.62801862
Iteration 28, inertia 170566975.53051382
Iteration 29, inertia 170562770.8822848
Iteration 30, inertia 170559907.09958905
Iteration 31, inertia 170557921.0413587
Iteration 32, inertia 170555996.25408632
Iteration 33, inertia 170553862.86618176
Iteration 34, inertia 170551822.128313
Iteration 35, inertia 170549948.367196
Iteration 36, inertia 170548984.4959398
Iteration 37, inertia 170547878.14745218
Iteration 38, inertia 170545197.89205945
Iteration 39, inertia 170542922.58842093
Iteration 40, inertia 170541122.32656822
Iteration 41, inertia 170539690.89377728
Iteration 42, inertia 170537888.44373918
Iteration 43, inertia 170536918.36147645
Iteration 44, inertia 170536236.74085784
Iteration 45, inertia 170535793.04547638
Iteration 46, inertia 170534804.5715283
Iteration 47, inertia 170533987.8820371
Iteration 48, inertia 170533755.09403294
Iteration 49, inertia 170533376.1832159
Iteration 50, inertia 170532908.83010736
Iteration 51, inertia 170532638.8164784
Iteration 52, inertia 170532293.31410906
Iteration 53, inertia 170532025.3031938
Converged at iteration 53: strict convergence.
Initialization complete
Iteration 0, inertia 260846023.92995512
Iteration 1, inertia 179931609.58202642
Iteration 2, inertia 175518097.24504563
Iteration 3, inertia 173933324.35512853
Iteration 4, inertia 173017085.7735662
Iteration 5, inertia 172433521.94986734
Iteration 6, inertia 172044948.23198313
Iteration 7, inertia 171768462.4635859
Iteration 8, inertia 171575654.85530895
Iteration 9, inertia 171422538.88392955
Iteration 10, inertia 171306531.3212381
Iteration 11, inertia 171206822.95510963
Iteration 12, inertia 171138898.9363714
Iteration 13, inertia 171079853.94516283
Iteration 14, inertia 171022101.37346658
Iteration 15, inertia 170971250.72030154
Iteration 16, inertia 170934687.84670946
Iteration 17, inertia 170901991.91897178
Iteration 18, inertia 170866471.37171373
Iteration 19, inertia 170838989.8164149
Iteration 20, inertia 170816339.9695259
Iteration 21, inertia 170799092.72565815
Iteration 22, inertia 170785130.6019707
Iteration 23, inertia 170773232.3507742
Iteration 24, inertia 170762261.9431198
Iteration 25, inertia 170753318.1408399
Iteration 26, inertia 170748086.37196296
Iteration 27, inertia 170743291.97011766
Iteration 28, inertia 170738095.29400775
Iteration 29, inertia 170732769.82733113
Iteration 30, inertia 170729110.79395017
Iteration 31, inertia 170725311.21506536
Iteration 32, inertia 170721779.570414
Iteration 33, inertia 170719203.9594881
Iteration 34, inertia 170717037.2865656
Iteration 35, inertia 170715311.08918574
Iteration 36, inertia 170714269.03511992
Iteration 37, inertia 170713643.8189303
Iteration 38, inertia 170713403.76620138
Iteration 39, inertia 170713376.92261872
Converged at iteration 39: strict convergence.
Initialization complete
Iteration 0, inertia 259356389.150557
Iteration 1, inertia 179676306.25507706
Iteration 2, inertia 175294504.97055054
Iteration 3, inertia 173690429.398895
Iteration 4, inertia 172825964.91451812
Iteration 5, inertia 172295622.53757042
Iteration 6, inertia 171938843.6382293
Iteration 7, inertia 171659569.34344676
Iteration 8, inertia 171448488.6289381
Iteration 9, inertia 171297391.83750767
Iteration 10, inertia 171171347.00005767
Iteration 11, inertia 171080014.1326566
Iteration 12, inertia 171016235.81695092
Iteration 13, inertia 170962110.739821
Iteration 14, inertia 170917816.62021548
Iteration 15, inertia 170879457.14696386
Iteration 16, inertia 170848493.70584548
Iteration 17, inertia 170820545.51658303
Iteration 18, inertia 170797388.23793477
Iteration 19, inertia 170778468.25255656
Iteration 20, inertia 170761811.84092358
Iteration 21, inertia 170747386.85404515
Iteration 22, inertia 170737347.4094799
Iteration 23, inertia 170726314.97325918
Iteration 24, inertia 170712964.00403818
Iteration 25, inertia 170699606.28532648
Iteration 26, inertia 170684577.6966428
Iteration 27, inertia 170675262.1350567
Iteration 28, inertia 170666299.08345833
Iteration 29, inertia 170659206.77003402
Iteration 30, inertia 170653719.82215422
Iteration 31, inertia 170649545.47123343
Iteration 32, inertia 170645316.88222614
Iteration 33, inertia 170641007.25334457
Iteration 34, inertia 170637793.88877293
Iteration 35, inertia 170635034.8818601
Iteration 36, inertia 170631705.2407666
Iteration 37, inertia 170628510.62051407
Iteration 38, inertia 170624541.6954738
Iteration 39, inertia 170623786.67715856
Iteration 40, inertia 170623691.87320784
Converged at iteration 40: strict convergence.
Initialization complete
Iteration 0, inertia 260517729.87990347
Iteration 1, inertia 179740800.0913259
Iteration 2, inertia 175197326.55718097
Iteration 3, inertia 173550499.02878636
Iteration 4, inertia 172705436.32238147
Iteration 5, inertia 172180741.9500072
Iteration 6, inertia 171797539.80184206
Iteration 7, inertia 171500806.86448693
Iteration 8, inertia 171288167.6023767
Iteration 9, inertia 171133448.11600554
Iteration 10, inertia 171018072.53769585
Iteration 11, inertia 170937628.72725114
Iteration 12, inertia 170875295.20854875
Iteration 13, inertia 170821701.17035338
Iteration 14, inertia 170769735.85548314
Iteration 15, inertia 170722021.08447924
Iteration 16, inertia 170687220.27969047
Iteration 17, inertia 170649718.04283696
Iteration 18, inertia 170622866.64295754
Iteration 19, inertia 170601876.77252534
Iteration 20, inertia 170583777.2244417
Iteration 21, inertia 170565501.2892967
Iteration 22, inertia 170554060.64200804
Iteration 23, inertia 170539717.88480896
Iteration 24, inertia 170525801.30749086
Iteration 25, inertia 170514878.30204833
Iteration 26, inertia 170503046.70063546
Iteration 27, inertia 170491707.96744105
Iteration 28, inertia 170484550.8633203
Iteration 29, inertia 170478690.1064325
Iteration 30, inertia 170474102.28946462
Iteration 31, inertia 170470847.60375354
Iteration 32, inertia 170468945.7587614
Iteration 33, inertia 170467366.42329004
Iteration 34, inertia 170464727.82123327
Iteration 35, inertia 170461423.62063712
Iteration 36, inertia 170459748.6946301
Iteration 37, inertia 170455930.1139302
Iteration 38, inertia 170449689.45844927
Iteration 39, inertia 170442826.1968738
Iteration 40, inertia 170432604.29450816
Iteration 41, inertia 170426783.5175883
Iteration 42, inertia 170424485.36710772
Iteration 43, inertia 170422914.02432874
Iteration 44, inertia 170422276.74186057
Iteration 45, inertia 170421855.82641676
Iteration 46, inertia 170421215.22232437
Iteration 47, inertia 170420721.36990455
Iteration 48, inertia 170420473.61257914
Iteration 49, inertia 170420070.7010724
Iteration 50, inertia 170420009.54936045
Iteration 51, inertia 170419961.49288794
Converged at iteration 51: strict convergence.
Initialization complete
Iteration 0, inertia 260973282.08573815
Iteration 1, inertia 180215080.88438284
Iteration 2, inertia 175612817.80590707
Iteration 3, inertia 173879101.1788195
Iteration 4, inertia 172984526.78735694
Iteration 5, inertia 172457431.13429546
Iteration 6, inertia 172101378.81984174
Iteration 7, inertia 171865852.65738598
Iteration 8, inertia 171710834.3656199
Iteration 9, inertia 171609526.65171227
Iteration 10, inertia 171525722.66962788
Iteration 11, inertia 171454949.6942833
Iteration 12, inertia 171393629.2726333
Iteration 13, inertia 171336079.69781005
Iteration 14, inertia 171289785.70851973
Iteration 15, inertia 171247713.10747498
Iteration 16, inertia 171209347.38657427
Iteration 17, inertia 171174376.15181366
Iteration 18, inertia 171147377.9001662
Iteration 19, inertia 171122282.74250245
Iteration 20, inertia 171100042.6468174
Iteration 21, inertia 171084152.44254214
Iteration 22, inertia 171069295.40193945
Iteration 23, inertia 171056682.4202892
Iteration 24, inertia 171048220.33782923
Iteration 25, inertia 171042469.60464168
Iteration 26, inertia 171038252.55873775
Iteration 27, inertia 171035737.78102824
Iteration 28, inertia 171033942.56406903
Iteration 29, inertia 171031398.17005134
Iteration 30, inertia 171029729.01714396
Iteration 31, inertia 171027983.25491023
Iteration 32, inertia 171026288.12909105
Iteration 33, inertia 171025570.6809006
Iteration 34, inertia 171024877.84315395
Iteration 35, inertia 171024366.2248202
Iteration 36, inertia 171023559.64553514
Iteration 37, inertia 171022086.42958584
Iteration 38, inertia 171020433.74906102
Iteration 39, inertia 171019320.8227657
Iteration 40, inertia 171018370.78244403
Iteration 41, inertia 171017065.49798423
Iteration 42, inertia 171015338.28806934
Iteration 43, inertia 171014194.76756933
Iteration 44, inertia 171013257.84442645
Iteration 45, inertia 171012253.0044978
Iteration 46, inertia 171011549.54210898
Iteration 47, inertia 171010585.56569695
Iteration 48, inertia 171009401.33731076
Iteration 49, inertia 171008386.69450957
Iteration 50, inertia 171007483.31099954
Iteration 51, inertia 171006677.09496045
Iteration 52, inertia 171005385.54209676
Iteration 53, inertia 171003948.72828537
Iteration 54, inertia 171002701.0192009
Iteration 55, inertia 171001488.06171778
Iteration 56, inertia 171000565.69064105
Iteration 57, inertia 170998744.58540985
Iteration 58, inertia 170997456.88484195
Iteration 59, inertia 170996315.61287305
Iteration 60, inertia 170995540.4167343
Iteration 61, inertia 170994439.47603908
Iteration 62, inertia 170993020.30712396
Iteration 63, inertia 170992175.55487448
Iteration 64, inertia 170991463.57986605
Iteration 65, inertia 170990934.59266877
Iteration 66, inertia 170990584.4938927
Iteration 67, inertia 170990492.16428593
Iteration 68, inertia 170990269.05298334
Iteration 69, inertia 170989613.40581968
Iteration 70, inertia 170989135.23196366
Iteration 71, inertia 170988928.33894527
Iteration 72, inertia 170988800.23848668
Converged at iteration 72: strict convergence.
Initialization complete
Iteration 0, inertia 261115521.41634634
Iteration 1, inertia 180288773.8146891
Iteration 2, inertia 175561032.42587867
Iteration 3, inertia 173575572.51429674
Iteration 4, inertia 172594602.48991367
Iteration 5, inertia 172023181.3912105
Iteration 6, inertia 171628287.0114227
Iteration 7, inertia 171332492.8935076
Iteration 8, inertia 171144084.93348148
Iteration 9, inertia 171002536.35923555
Iteration 10, inertia 170893640.30863062
Iteration 11, inertia 170813731.09269774
Iteration 12, inertia 170740340.2890175
Iteration 13, inertia 170680514.74662912
Iteration 14, inertia 170631142.27682722
Iteration 15, inertia 170596895.80861184
Iteration 16, inertia 170570744.9222625
Iteration 17, inertia 170547697.0452328
Iteration 18, inertia 170523576.17739105
Iteration 19, inertia 170500345.05672115
Iteration 20, inertia 170479998.6516973
Iteration 21, inertia 170469482.215314
Iteration 22, inertia 170462577.7483505
Iteration 23, inertia 170456450.88406867
Iteration 24, inertia 170450742.60961485
Iteration 25, inertia 170447164.11645547
Iteration 26, inertia 170444981.04804856
Iteration 27, inertia 170443481.57794088
Iteration 28, inertia 170442126.61818665
Iteration 29, inertia 170440914.11746523
Iteration 30, inertia 170440416.33147526
Iteration 31, inertia 170440021.675485
Iteration 32, inertia 170439278.24820212
Iteration 33, inertia 170438636.16133535
Iteration 34, inertia 170435176.76043388
Iteration 35, inertia 170434016.5626801
Iteration 36, inertia 170432923.50368872
Iteration 37, inertia 170431609.2580279
Iteration 38, inertia 170430837.18119526
Iteration 39, inertia 170430167.31262752
Iteration 40, inertia 170429411.2740103
Iteration 41, inertia 170428814.92485595
Iteration 42, inertia 170428221.2845707
Iteration 43, inertia 170427506.05858716
Iteration 44, inertia 170427441.40304834
Converged at iteration 44: strict convergence.
Initialization complete
Iteration 0, inertia 260812193.7995158
Iteration 1, inertia 180233414.1478598
Iteration 2, inertia 175614584.19182318
Iteration 3, inertia 173914090.8579866
Iteration 4, inertia 173035903.9158973
Iteration 5, inertia 172503976.87923563
Iteration 6, inertia 172138897.12084186
Iteration 7, inertia 171867773.6449022
Iteration 8, inertia 171656122.73306143
Iteration 9, inertia 171484148.73695555
Iteration 10, inertia 171350146.01230642
Iteration 11, inertia 171237509.64023656
Iteration 12, inertia 171133359.91764843
Iteration 13, inertia 171049016.9601668
Iteration 14, inertia 170973765.7371172
Iteration 15, inertia 170916067.28910917
Iteration 16, inertia 170867210.50517982
Iteration 17, inertia 170813633.74291882
Iteration 18, inertia 170778276.30775198
Iteration 19, inertia 170746555.19967642
Iteration 20, inertia 170721519.2027929
Iteration 21, inertia 170701862.03120533
Iteration 22, inertia 170690114.93554527
Iteration 23, inertia 170681630.47047868
Iteration 24, inertia 170674939.28080124
Iteration 25, inertia 170667211.51471806
Iteration 26, inertia 170659490.1782945
Iteration 27, inertia 170649845.11688596
Iteration 28, inertia 170640274.0165271
Iteration 29, inertia 170633368.56282192
Iteration 30, inertia 170628152.54145724
Iteration 31, inertia 170623722.26522776
Iteration 32, inertia 170620715.35920194
Iteration 33, inertia 170618483.00851828
Iteration 34, inertia 170617011.99676272
Iteration 35, inertia 170615159.53195068
Iteration 36, inertia 170613390.14611617
Iteration 37, inertia 170611865.502204
Iteration 38, inertia 170610320.02028766
Iteration 39, inertia 170609470.13940945
Iteration 40, inertia 170608921.01143947
Iteration 41, inertia 170608198.60305488
Iteration 42, inertia 170607639.86279917
Iteration 43, inertia 170607402.53900707
Iteration 44, inertia 170607026.08561856
Iteration 45, inertia 170606612.42795134
Iteration 46, inertia 170606176.61910656
Iteration 47, inertia 170605743.59848973
Iteration 48, inertia 170604721.1662001
Iteration 49, inertia 170603257.82024384
Iteration 50, inertia 170601731.231981
Iteration 51, inertia 170600994.0768138
Iteration 52, inertia 170600158.15890056
Iteration 53, inertia 170599338.0077966
Iteration 54, inertia 170598903.8296125
Iteration 55, inertia 170598054.48778793
Iteration 56, inertia 170597401.58807316
Iteration 57, inertia 170596733.39280057
Iteration 58, inertia 170596240.24678686
Iteration 59, inertia 170595105.91618776
Iteration 60, inertia 170593963.96302772
Iteration 61, inertia 170592660.73875952
Iteration 62, inertia 170590727.2451563
Iteration 63, inertia 170589152.56534448
Iteration 64, inertia 170586538.08844697
Iteration 65, inertia 170582495.46349338
Iteration 66, inertia 170580427.02385715
Iteration 67, inertia 170580130.3054945
Iteration 68, inertia 170579841.12417945
Iteration 69, inertia 170579626.0977299
Iteration 70, inertia 170579591.06253663
Iteration 71, inertia 170579507.370734
Converged at iteration 71: strict convergence.
Filename: code/create_kmeans_clustering.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    10    496.4 MiB    496.4 MiB           1   @profile
    11                                         def kmeans_cluster(P, V, K, output_path, prefix, ref=''):
    12                                             """
    13                                             Uses the point.npy P, vocab.npy V files of a layer (generated using https://github.com/hsajjad/ConceptX/ library) to produce a clustering of <K> clusters at <output_path> named clusters-kmeans-{K}.txt
    14                                             """
    15    496.4 MiB      0.0 MiB           1       kmeans = KMeans(n_clusters=K, verbose=3, random_state=212)
    16    628.7 MiB    132.4 MiB           1       output = kmeans.fit(P)
    17                                             
    18    628.7 MiB      0.0 MiB           1       out_file =  f"{output_path}/{prefix}-clusters-kmeans-{K}{ref}.txt"
    19                                         
    20    628.7 MiB      0.0 MiB        1003       clusters = {i:[] for i in range(K)}
    21                                             
    22    632.7 MiB      0.0 MiB       64043       for v, l in zip(V, output.labels_):
    23    632.7 MiB      4.0 MiB       64042          clusters[l].append(f'{v}|||{l}')
    24                                         
    25                                         
    26    632.7 MiB      0.0 MiB           1       out = ""
    27    633.7 MiB      0.0 MiB        1001       for k,v in clusters.items():
    28    633.7 MiB      1.0 MiB        1000           out += '\n'.join(v) + '\n'
    29                                         
    30                                             
    31    633.7 MiB      0.0 MiB           1       with open(out_file, 'w') as f2:
    32    633.7 MiB      0.0 MiB           1           f2.write(out)
    33                                         
    34    633.7 MiB      0.0 MiB           1       return out


Runtime: 958.4165151119232
Combined output written to: visualize_1000/layer12/clusters-1000.txt

Completed iteration 12.

